

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Guide d’utilisation des segmenteurs de formats &mdash; EMAIL_SENDER_1 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            EMAIL_SENDER_1
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contenu:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Documentation des API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EMAIL_SENDER_1</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Guide d’utilisation des segmenteurs de formats</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user-guides/FormatSegmenters.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="guide-d-utilisation-des-segmenteurs-de-formats">
<h1>Guide d’utilisation des segmenteurs de formats<a class="headerlink" href="#guide-d-utilisation-des-segmenteurs-de-formats" title="Link to this heading"></a></h1>
<p>Ce guide explique comment utiliser les modules de segmentation pour les formats JSON, XML et texte.</p>
<section id="table-des-matieres">
<h2>Table des matières<a class="headerlink" href="#table-des-matieres" title="Link to this heading"></a></h2>
<ol class="simple">
<li><p><a class="reference external" href="#introduction">Introduction</a></p></li>
<li><p><a class="reference external" href="#installation-et-pr%C3%A9requis">Installation et prérequis</a></p></li>
<li><p><a class="reference external" href="#interface-unifi%C3%A9e-unifiedsegmenterps1">Interface unifiée (UnifiedSegmenter.ps1)</a></p></li>
<li><p><a class="reference external" href="#segmenteur-json-jsonsegmenterpy">Segmenteur JSON (JsonSegmenter.py)</a></p></li>
<li><p><a class="reference external" href="#segmenteur-xml-xmlsegmenterpy">Segmenteur XML (XmlSegmenter.py)</a></p></li>
<li><p><a class="reference external" href="#segmenteur-de-texte-textsegmenterpy">Segmenteur de texte (TextSegmenter.py)</a></p></li>
<li><p><a class="reference external" href="#int%C3%A9gration-avec-inputsegmentationpsm1">Intégration avec InputSegmentation.psm1</a></p></li>
<li><p><a class="reference external" href="#exemples-dutilisation">Exemples d’utilisation</a></p></li>
<li><p><a class="reference external" href="#d%C3%A9pannage">Dépannage</a></p></li>
</ol>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>Les modules de segmentation permettent de traiter des fichiers volumineux dans différents formats (JSON, XML, texte) en les divisant en segments plus petits. Cela est particulièrement utile pour les systèmes qui ont des limites de taille d’entrée, comme les API ou les outils de traitement de données.</p>
<p>Les principales fonctionnalités sont :</p>
<ul class="simple">
<li><p>Segmentation de fichiers JSON, XML et texte</p></li>
<li><p>Analyse de la structure et des statistiques des fichiers</p></li>
<li><p>Validation des fichiers selon des schémas</p></li>
<li><p>Conversion entre différents formats</p></li>
<li><p>Interface unifiée pour tous les formats</p></li>
</ul>
</section>
<section id="installation-et-prerequis">
<h2>Installation et prérequis<a class="headerlink" href="#installation-et-prerequis" title="Link to this heading"></a></h2>
<section id="prerequis">
<h3>Prérequis<a class="headerlink" href="#prerequis" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>PowerShell 5.1 ou supérieur</p></li>
<li><p>Python 3.6 ou supérieur</p></li>
<li><p>Modules Python requis : <code class="docutils literal notranslate"><span class="pre">lxml</span></code></p></li>
</ul>
</section>
<section id="installation-des-modules-python-requis">
<h3>Installation des modules Python requis<a class="headerlink" href="#installation-des-modules-python-requis" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">-m</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">lxml</span>
</pre></div>
</div>
</section>
<section id="verification-de-l-installation">
<h3>Vérification de l’installation<a class="headerlink" href="#verification-de-l-installation" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Importer le module UnifiedSegmenter</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">UnifiedSegmenter</span><span class="p">.</span><span class="n">ps1</span>

<span class="c"># Initialiser le segmenteur unifié</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="nb">Initialize-UnifiedSegmenter</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Installation réussie !&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Problème d&#39;installation. Vérifiez les prérequis.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="interface-unifiee-unifiedsegmenter-ps1">
<h2>Interface unifiée (UnifiedSegmenter.ps1)<a class="headerlink" href="#interface-unifiee-unifiedsegmenter-ps1" title="Link to this heading"></a></h2>
<p>Le module <code class="docutils literal notranslate"><span class="pre">UnifiedSegmenter.ps1</span></code> fournit une interface PowerShell unifiée pour tous les segmenteurs.</p>
<section id="initialisation">
<h3>Initialisation<a class="headerlink" href="#initialisation" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Importer le module</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">UnifiedSegmenter</span><span class="p">.</span><span class="n">ps1</span>

<span class="c"># Initialiser avec les paramètres par défaut</span>
<span class="nb">Initialize-UnifiedSegmenter</span>

<span class="c"># Initialiser avec des paramètres personnalisés</span>
<span class="nb">Initialize-UnifiedSegmenter</span> <span class="n">-PythonPath</span> <span class="s2">&quot;C:\Python39\python.exe&quot;</span> <span class="n">-MaxInputSizeKB</span> <span class="n">20</span> <span class="n">-DefaultChunkSizeKB</span> <span class="n">10</span>
</pre></div>
</div>
</section>
<section id="detection-de-format">
<h3>Détection de format<a class="headerlink" href="#detection-de-format" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Détecter automatiquement le format d&#39;un fichier</span>
<span class="nv">$format</span> <span class="p">=</span> <span class="nb">Get-FileFormat</span> <span class="n">-FilePath</span> <span class="s2">&quot;data.json&quot;</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Format détecté : $format&quot;</span>
</pre></div>
</div>
</section>
<section id="segmentation-de-fichier">
<h3>Segmentation de fichier<a class="headerlink" href="#segmentation-de-fichier" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Segmenter un fichier avec détection automatique du format</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-File</span> <span class="n">-FilePath</span> <span class="s2">&quot;data.json&quot;</span> <span class="n">-OutputDir</span> <span class="s2">&quot;.\output&quot;</span>

<span class="c"># Segmenter un fichier JSON avec des paramètres personnalisés</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-File</span> <span class="n">-FilePath</span> <span class="s2">&quot;data.json&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;JSON&quot;</span> <span class="n">-OutputDir</span> <span class="s2">&quot;.\output\json&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span> <span class="n">-PreserveStructure</span>

<span class="c"># Segmenter un fichier XML avec une expression XPath</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-File</span> <span class="n">-FilePath</span> <span class="s2">&quot;data.xml&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;XML&quot;</span> <span class="n">-OutputDir</span> <span class="s2">&quot;.\output\xml&quot;</span> <span class="n">-XPathExpression</span> <span class="s2">&quot;//items/item&quot;</span>

<span class="c"># Segmenter un fichier texte par paragraphes</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-File</span> <span class="n">-FilePath</span> <span class="s2">&quot;data.txt&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;TEXT&quot;</span> <span class="n">-OutputDir</span> <span class="s2">&quot;.\output\text&quot;</span> <span class="n">-TextMethod</span> <span class="s2">&quot;paragraph&quot;</span>
</pre></div>
</div>
</section>
<section id="analyse-de-fichier">
<h3>Analyse de fichier<a class="headerlink" href="#analyse-de-fichier" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Analyser un fichier avec détection automatique du format</span>
<span class="nv">$analysis</span> <span class="p">=</span> <span class="nb">Get-FileAnalysis</span> <span class="n">-FilePath</span> <span class="s2">&quot;data.json&quot;</span>

<span class="c"># Analyser un fichier et enregistrer les résultats</span>
<span class="nv">$outputFile</span> <span class="p">=</span> <span class="nb">Get-FileAnalysis</span> <span class="n">-FilePath</span> <span class="s2">&quot;data.xml&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;XML&quot;</span> <span class="n">-OutputFile</span> <span class="s2">&quot;analysis.json&quot;</span>
</pre></div>
</div>
</section>
<section id="validation-de-fichier">
<h3>Validation de fichier<a class="headerlink" href="#validation-de-fichier" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Valider un fichier JSON</span>
<span class="nv">$isValid</span> <span class="p">=</span> <span class="nb">Test-FileValidity</span> <span class="n">-FilePath</span> <span class="s2">&quot;data.json&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;JSON&quot;</span>

<span class="c"># Valider un fichier XML avec un schéma XSD</span>
<span class="nv">$isValid</span> <span class="p">=</span> <span class="nb">Test-FileValidity</span> <span class="n">-FilePath</span> <span class="s2">&quot;data.xml&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;XML&quot;</span> <span class="n">-SchemaFile</span> <span class="s2">&quot;schema.xsd&quot;</span>
</pre></div>
</div>
</section>
<section id="requetes-xpath-xml-uniquement">
<h3>Requêtes XPath (XML uniquement)<a class="headerlink" href="#requetes-xpath-xml-uniquement" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Exécuter une requête XPath sur un fichier XML</span>
<span class="nv">$results</span> <span class="p">=</span> <span class="nb">Invoke-XPathQuery</span> <span class="n">-FilePath</span> <span class="s2">&quot;data.xml&quot;</span> <span class="n">-XPathExpression</span> <span class="s2">&quot;//items/item[@id=&#39;2&#39;]&quot;</span>

<span class="c"># Enregistrer les résultats dans un fichier</span>
<span class="nv">$outputFile</span> <span class="p">=</span> <span class="nb">Invoke-XPathQuery</span> <span class="n">-FilePath</span> <span class="s2">&quot;data.xml&quot;</span> <span class="n">-XPathExpression</span> <span class="s2">&quot;//items/item&quot;</span> <span class="n">-OutputFile</span> <span class="s2">&quot;results.xml&quot;</span>
</pre></div>
</div>
</section>
<section id="conversion-entre-formats">
<h3>Conversion entre formats<a class="headerlink" href="#conversion-entre-formats" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Convertir un fichier JSON en XML</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="nb">Convert-FileFormat</span> <span class="n">-InputFile</span> <span class="s2">&quot;data.json&quot;</span> <span class="n">-OutputFile</span> <span class="s2">&quot;data.xml&quot;</span> <span class="n">-InputFormat</span> <span class="s2">&quot;JSON&quot;</span> <span class="n">-OutputFormat</span> <span class="s2">&quot;XML&quot;</span>

<span class="c"># Convertir un fichier XML en JSON</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="nb">Convert-FileFormat</span> <span class="n">-InputFile</span> <span class="s2">&quot;data.xml&quot;</span> <span class="n">-OutputFile</span> <span class="s2">&quot;data.json&quot;</span> <span class="n">-InputFormat</span> <span class="s2">&quot;XML&quot;</span> <span class="n">-OutputFormat</span> <span class="s2">&quot;JSON&quot;</span>

<span class="c"># Convertir un fichier JSON en texte</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="nb">Convert-FileFormat</span> <span class="n">-InputFile</span> <span class="s2">&quot;data.json&quot;</span> <span class="n">-OutputFile</span> <span class="s2">&quot;data.txt&quot;</span> <span class="n">-InputFormat</span> <span class="s2">&quot;JSON&quot;</span> <span class="n">-OutputFormat</span> <span class="s2">&quot;TEXT&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="segmenteur-json-jsonsegmenter-py">
<h2>Segmenteur JSON (JsonSegmenter.py)<a class="headerlink" href="#segmenteur-json-jsonsegmenter-py" title="Link to this heading"></a></h2>
<p>Le module <code class="docutils literal notranslate"><span class="pre">JsonSegmenter.py</span></code> peut être utilisé directement en Python pour des fonctionnalités plus avancées.</p>
<section id="utilisation-en-ligne-de-commande">
<h3>Utilisation en ligne de commande<a class="headerlink" href="#utilisation-en-ligne-de-commande" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Segmenter un fichier JSON</span>
<span class="n">python</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">JsonSegmenter</span><span class="p">.</span><span class="n">py</span> <span class="n">segment</span> <span class="n">data</span><span class="p">.</span><span class="n">json</span> <span class="p">-</span><span class="n">-output-dir</span> <span class="p">.\</span><span class="n">output</span><span class="p">\</span><span class="n">json</span> <span class="p">-</span><span class="n">-max-chunk-size</span> <span class="n">5</span>

<span class="c"># Analyser un fichier JSON</span>
<span class="n">python</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">JsonSegmenter</span><span class="p">.</span><span class="n">py</span> <span class="n">analyze</span> <span class="n">data</span><span class="p">.</span><span class="n">json</span> <span class="p">-</span><span class="n">-output</span> <span class="n">analysis</span><span class="p">.</span><span class="n">json</span>

<span class="c"># Valider un fichier JSON avec un schéma</span>
<span class="n">python</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">JsonSegmenter</span><span class="p">.</span><span class="n">py</span> <span class="n">validate</span> <span class="n">data</span><span class="p">.</span><span class="n">json</span> <span class="p">-</span><span class="n">-schema</span> <span class="n">schema</span><span class="p">.</span><span class="n">json</span>
</pre></div>
</div>
</section>
<section id="utilisation-dans-un-script-python">
<h3>Utilisation dans un script Python<a class="headerlink" href="#utilisation-dans-un-script-python" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">modules.JsonSegmenter</span><span class="w"> </span><span class="kn">import</span> <span class="n">JsonSegmenter</span>

<span class="c1"># Créer une instance du segmenteur</span>
<span class="n">segmenter</span> <span class="o">=</span> <span class="n">JsonSegmenter</span><span class="p">(</span><span class="n">max_chunk_size_kb</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">preserve_structure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Charger un fichier JSON</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">segmenter</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;data.json&quot;</span><span class="p">)</span>

<span class="c1"># Segmenter les données</span>
<span class="n">segments</span> <span class="o">=</span> <span class="n">segmenter</span><span class="o">.</span><span class="n">segment</span><span class="p">()</span>

<span class="c1"># Enregistrer les segments dans des fichiers</span>
<span class="n">file_paths</span> <span class="o">=</span> <span class="n">segmenter</span><span class="o">.</span><span class="n">segment_to_files</span><span class="p">(</span><span class="s2">&quot;output/json&quot;</span><span class="p">)</span>

<span class="c1"># Analyser les données</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">segmenter</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>

<span class="c1"># Valider les données</span>
<span class="n">is_valid</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">segmenter</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="segmenteur-xml-xmlsegmenter-py">
<h2>Segmenteur XML (XmlSegmenter.py)<a class="headerlink" href="#segmenteur-xml-xmlsegmenter-py" title="Link to this heading"></a></h2>
<p>Le module <code class="docutils literal notranslate"><span class="pre">XmlSegmenter.py</span></code> peut être utilisé directement en Python pour des fonctionnalités plus avancées.</p>
<section id="id1">
<h3>Utilisation en ligne de commande<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Segmenter un fichier XML</span>
<span class="n">python</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">XmlSegmenter</span><span class="p">.</span><span class="n">py</span> <span class="n">segment</span> <span class="n">data</span><span class="p">.</span><span class="n">xml</span> <span class="p">-</span><span class="n">-output-dir</span> <span class="p">.\</span><span class="n">output</span><span class="p">\</span><span class="n">xml</span> <span class="p">-</span><span class="n">-max-chunk-size</span> <span class="n">5</span>

<span class="c"># Segmenter un fichier XML avec une expression XPath</span>
<span class="n">python</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">XmlSegmenter</span><span class="p">.</span><span class="n">py</span> <span class="n">segment</span> <span class="n">data</span><span class="p">.</span><span class="n">xml</span> <span class="p">-</span><span class="n">-output-dir</span> <span class="p">.\</span><span class="n">output</span><span class="p">\</span><span class="n">xml</span> <span class="p">-</span><span class="n">-xpath</span> <span class="s2">&quot;//items/item&quot;</span>

<span class="c"># Analyser un fichier XML</span>
<span class="n">python</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">XmlSegmenter</span><span class="p">.</span><span class="n">py</span> <span class="n">analyze</span> <span class="n">data</span><span class="p">.</span><span class="n">xml</span> <span class="p">-</span><span class="n">-output</span> <span class="n">analysis</span><span class="p">.</span><span class="n">json</span>

<span class="c"># Valider un fichier XML avec un schéma XSD</span>
<span class="n">python</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">XmlSegmenter</span><span class="p">.</span><span class="n">py</span> <span class="n">validate</span> <span class="n">data</span><span class="p">.</span><span class="n">xml</span> <span class="p">-</span><span class="n">-schema</span> <span class="n">schema</span><span class="p">.</span><span class="n">xsd</span>

<span class="c"># Exécuter une requête XPath</span>
<span class="n">python</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">XmlSegmenter</span><span class="p">.</span><span class="n">py</span> <span class="n">xpath</span> <span class="n">data</span><span class="p">.</span><span class="n">xml</span> <span class="s2">&quot;//items/item[@id=&#39;2&#39;]&quot;</span> <span class="p">-</span><span class="n">-output</span> <span class="n">results</span><span class="p">.</span><span class="n">xml</span>
</pre></div>
</div>
</section>
<section id="id2">
<h3>Utilisation dans un script Python<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">modules.XmlSegmenter</span><span class="w"> </span><span class="kn">import</span> <span class="n">XmlSegmenter</span>

<span class="c1"># Créer une instance du segmenteur</span>
<span class="n">segmenter</span> <span class="o">=</span> <span class="n">XmlSegmenter</span><span class="p">(</span><span class="n">max_chunk_size_kb</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">preserve_structure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Charger un fichier XML</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">segmenter</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;data.xml&quot;</span><span class="p">)</span>

<span class="c1"># Segmenter les données</span>
<span class="n">segments</span> <span class="o">=</span> <span class="n">segmenter</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span><span class="n">xpath_expression</span><span class="o">=</span><span class="s2">&quot;//items/item&quot;</span><span class="p">)</span>

<span class="c1"># Enregistrer les segments dans des fichiers</span>
<span class="n">file_paths</span> <span class="o">=</span> <span class="n">segmenter</span><span class="o">.</span><span class="n">segment_to_files</span><span class="p">(</span><span class="s2">&quot;output/xml&quot;</span><span class="p">,</span> <span class="n">xpath_expression</span><span class="o">=</span><span class="s2">&quot;//items/item&quot;</span><span class="p">)</span>

<span class="c1"># Analyser les données</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">segmenter</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>

<span class="c1"># Valider les données</span>
<span class="n">is_valid</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">segmenter</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">schema_path</span><span class="o">=</span><span class="s2">&quot;schema.xsd&quot;</span><span class="p">)</span>

<span class="c1"># Exécuter une requête XPath</span>
<span class="n">elements</span> <span class="o">=</span> <span class="n">segmenter</span><span class="o">.</span><span class="n">xpath_query</span><span class="p">(</span><span class="s2">&quot;//items/item[@id=&#39;2&#39;]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="segmenteur-de-texte-textsegmenter-py">
<h2>Segmenteur de texte (TextSegmenter.py)<a class="headerlink" href="#segmenteur-de-texte-textsegmenter-py" title="Link to this heading"></a></h2>
<p>Le module <code class="docutils literal notranslate"><span class="pre">TextSegmenter.py</span></code> peut être utilisé directement en Python pour des fonctionnalités plus avancées.</p>
<section id="id3">
<h3>Utilisation en ligne de commande<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Segmenter un fichier texte</span>
<span class="n">python</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">TextSegmenter</span><span class="p">.</span><span class="n">py</span> <span class="n">segment</span> <span class="n">data</span><span class="p">.</span><span class="n">txt</span> <span class="p">-</span><span class="n">-output-dir</span> <span class="p">.\</span><span class="n">output</span><span class="p">\</span><span class="n">text</span> <span class="p">-</span><span class="n">-max-chunk-size</span> <span class="n">5</span>

<span class="c"># Segmenter un fichier texte par paragraphes</span>
<span class="n">python</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">TextSegmenter</span><span class="p">.</span><span class="n">py</span> <span class="n">segment</span> <span class="n">data</span><span class="p">.</span><span class="n">txt</span> <span class="p">-</span><span class="n">-output-dir</span> <span class="p">.\</span><span class="n">output</span><span class="p">\</span><span class="n">text</span> <span class="p">-</span><span class="n">-method</span> <span class="n">paragraph</span>

<span class="c"># Analyser un fichier texte</span>
<span class="n">python</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">TextSegmenter</span><span class="p">.</span><span class="n">py</span> <span class="n">analyze</span> <span class="n">data</span><span class="p">.</span><span class="n">txt</span> <span class="p">-</span><span class="n">-output</span> <span class="n">analysis</span><span class="p">.</span><span class="n">json</span>
</pre></div>
</div>
</section>
<section id="id4">
<h3>Utilisation dans un script Python<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">modules.TextSegmenter</span><span class="w"> </span><span class="kn">import</span> <span class="n">TextSegmenter</span>

<span class="c1"># Créer une instance du segmenteur</span>
<span class="n">segmenter</span> <span class="o">=</span> <span class="n">TextSegmenter</span><span class="p">(</span><span class="n">max_chunk_size_kb</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">preserve_paragraphs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">preserve_sentences</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">smart_segmentation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Charger un fichier texte</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">segmenter</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;data.txt&quot;</span><span class="p">)</span>

<span class="c1"># Segmenter le texte</span>
<span class="n">segments</span> <span class="o">=</span> <span class="n">segmenter</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;paragraph&quot;</span><span class="p">)</span>

<span class="c1"># Enregistrer les segments dans des fichiers</span>
<span class="n">file_paths</span> <span class="o">=</span> <span class="n">segmenter</span><span class="o">.</span><span class="n">segment_to_files</span><span class="p">(</span><span class="s2">&quot;output/text&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;paragraph&quot;</span><span class="p">)</span>

<span class="c1"># Analyser le texte</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">segmenter</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="integration-avec-inputsegmentation-psm1">
<h2>Intégration avec InputSegmentation.psm1<a class="headerlink" href="#integration-avec-inputsegmentation-psm1" title="Link to this heading"></a></h2>
<p>Les segmenteurs de formats peuvent être intégrés avec le module <code class="docutils literal notranslate"><span class="pre">InputSegmentation.psm1</span></code> existant pour une segmentation plus avancée.</p>
<section id="exemple-d-integration">
<h3>Exemple d’intégration<a class="headerlink" href="#exemple-d-integration" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Importer les modules</span>
<span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">InputSegmentation</span><span class="p">.</span><span class="n">psm1</span> <span class="n">-Force</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">UnifiedSegmenter</span><span class="p">.</span><span class="n">ps1</span>

<span class="c"># Initialiser les modules</span>
<span class="nb">Initialize-InputSegmentation</span> <span class="n">-MaxInputSizeKB</span> <span class="n">10</span> <span class="n">-DefaultChunkSizeKB</span> <span class="n">5</span>
<span class="nb">Initialize-UnifiedSegmenter</span> <span class="n">-MaxInputSizeKB</span> <span class="n">10</span> <span class="n">-DefaultChunkSizeKB</span> <span class="n">5</span>

<span class="c"># Fonction pour segmenter une entrée avec détection de format</span>
<span class="k">function</span> <span class="nb">Split-FormatAwareInput</span> <span class="p">{</span>
    <span class="p">[</span><span class="k">CmdletBinding</span><span class="p">()]</span>
    <span class="k">param</span> <span class="p">(</span>
        <span class="p">[</span><span class="k">Parameter</span><span class="p">(</span><span class="k">Mandatory</span> <span class="p">=</span> <span class="nv">$true</span><span class="p">)]</span>
        <span class="no">[object]</span><span class="nv">$Input</span><span class="p">,</span>
        
        <span class="p">[</span><span class="k">Parameter</span><span class="p">(</span><span class="k">Mandatory</span> <span class="p">=</span> <span class="nv">$false</span><span class="p">)]</span>
        <span class="no">[int]</span><span class="nv">$ChunkSizeKB</span> <span class="p">=</span> <span class="n">0</span>
    <span class="p">)</span>
    
    <span class="c"># Si l&#39;entrée est un fichier, utiliser Split-File</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$Input</span> <span class="o">-is</span> <span class="no">[string]</span> <span class="o">-and</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">-Path</span> <span class="nv">$Input</span> <span class="n">-PathType</span> <span class="n">Leaf</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Split-File</span> <span class="n">-FilePath</span> <span class="nv">$Input</span> <span class="n">-ChunkSizeKB</span> <span class="nv">$ChunkSizeKB</span>
    <span class="p">}</span>
    
    <span class="c"># Si l&#39;entrée est un objet JSON, utiliser Split-JsonInput</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$Input</span> <span class="o">-is</span> <span class="no">[PSCustomObject]</span> <span class="o">-or</span> <span class="nv">$Input</span> <span class="o">-is</span> <span class="no">[hashtable]</span> <span class="o">-or</span> <span class="nv">$Input</span> <span class="o">-is</span> <span class="no">[array]</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Split-JsonInput</span> <span class="n">-JsonObject</span> <span class="nv">$Input</span> <span class="n">-ChunkSizeKB</span> <span class="nv">$ChunkSizeKB</span>
    <span class="p">}</span>
    
    <span class="c"># Si l&#39;entrée est une chaîne, essayer de détecter le format</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$Input</span> <span class="o">-is</span> <span class="no">[string]</span><span class="p">)</span> <span class="p">{</span>
        <span class="c"># Essayer de parser comme JSON</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="nv">$json</span> <span class="p">=</span> <span class="nv">$Input</span> <span class="p">|</span> <span class="nb">ConvertFrom-Json</span>
            <span class="k">return</span> <span class="nb">Split-JsonInput</span> <span class="n">-JsonObject</span> <span class="nv">$json</span> <span class="n">-ChunkSizeKB</span> <span class="nv">$ChunkSizeKB</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{}</span>
        
        <span class="c"># Essayer de parser comme XML</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="nv">$xml</span> <span class="p">=</span> <span class="no">[xml]</span><span class="nv">$Input</span>
            <span class="nv">$tempFile</span> <span class="p">=</span> <span class="no">[System.IO.Path]</span><span class="p">::</span><span class="n">GetTempFileName</span><span class="p">()</span>
            <span class="nv">$xml</span><span class="p">.</span><span class="n">Save</span><span class="p">(</span><span class="nv">$tempFile</span><span class="p">)</span>
            <span class="nv">$result</span> <span class="p">=</span> <span class="nb">Split-File</span> <span class="n">-FilePath</span> <span class="nv">$tempFile</span> <span class="n">-Format</span> <span class="s2">&quot;XML&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="nv">$ChunkSizeKB</span>
            <span class="nb">Remove-Item</span> <span class="n">-Path</span> <span class="nv">$tempFile</span> <span class="n">-Force</span>
            <span class="k">return</span> <span class="nv">$result</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">{}</span>
        
        <span class="c"># Traiter comme du texte</span>
        <span class="k">return</span> <span class="nb">Split-TextInput</span> <span class="n">-Text</span> <span class="nv">$Input</span> <span class="n">-ChunkSizeKB</span> <span class="nv">$ChunkSizeKB</span>
    <span class="p">}</span>
    
    <span class="c"># Par défaut, utiliser Split-Input</span>
    <span class="k">return</span> <span class="nb">Split-Input</span> <span class="n">-Input</span> <span class="nv">$Input</span> <span class="n">-ChunkSizeKB</span> <span class="nv">$ChunkSizeKB</span>
<span class="p">}</span>

<span class="c"># Exemple d&#39;utilisation</span>
<span class="nv">$input</span> <span class="p">=</span> <span class="nb">Get-Content</span> <span class="n">-Path</span> <span class="s2">&quot;data.json&quot;</span> <span class="n">-Raw</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-FormatAwareInput</span> <span class="n">-Input</span> <span class="nv">$input</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>
</pre></div>
</div>
</section>
</section>
<section id="exemples-d-utilisation">
<h2>Exemples d’utilisation<a class="headerlink" href="#exemples-d-utilisation" title="Link to this heading"></a></h2>
<section id="exemple-1-segmentation-d-un-fichier-json-volumineux">
<h3>Exemple 1 : Segmentation d’un fichier JSON volumineux<a class="headerlink" href="#exemple-1-segmentation-d-un-fichier-json-volumineux" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Importer le module UnifiedSegmenter</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">UnifiedSegmenter</span><span class="p">.</span><span class="n">ps1</span>

<span class="c"># Initialiser le segmenteur unifié</span>
<span class="nb">Initialize-UnifiedSegmenter</span> <span class="n">-MaxInputSizeKB</span> <span class="n">10</span> <span class="n">-DefaultChunkSizeKB</span> <span class="n">5</span>

<span class="c"># Segmenter un fichier JSON volumineux</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-File</span> <span class="n">-FilePath</span> <span class="s2">&quot;large_data.json&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;JSON&quot;</span> <span class="n">-OutputDir</span> <span class="s2">&quot;.\output\json&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>

<span class="c"># Afficher les segments créés</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Segments créés :&quot;</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$segment</span> <span class="k">in</span> <span class="nv">$segments</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;- $segment&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="exemple-2-extraction-d-elements-specifiques-d-un-fichier-xml">
<h3>Exemple 2 : Extraction d’éléments spécifiques d’un fichier XML<a class="headerlink" href="#exemple-2-extraction-d-elements-specifiques-d-un-fichier-xml" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Importer le module UnifiedSegmenter</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">UnifiedSegmenter</span><span class="p">.</span><span class="n">ps1</span>

<span class="c"># Initialiser le segmenteur unifié</span>
<span class="nb">Initialize-UnifiedSegmenter</span>

<span class="c"># Extraire tous les éléments &quot;item&quot; avec un attribut &quot;id&quot; égal à 2</span>
<span class="nv">$results</span> <span class="p">=</span> <span class="nb">Invoke-XPathQuery</span> <span class="n">-FilePath</span> <span class="s2">&quot;data.xml&quot;</span> <span class="n">-XPathExpression</span> <span class="s2">&quot;//items/item[@id=&#39;2&#39;]&quot;</span>

<span class="c"># Afficher les résultats</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Éléments extraits :&quot;</span>
<span class="nv">$results</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">{</span> <span class="nb">Write-Host</span> <span class="nv">$_</span> <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="exemple-3-analyse-de-la-lisibilite-d-un-texte">
<h3>Exemple 3 : Analyse de la lisibilité d’un texte<a class="headerlink" href="#exemple-3-analyse-de-la-lisibilite-d-un-texte" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Importer le module UnifiedSegmenter</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">UnifiedSegmenter</span><span class="p">.</span><span class="n">ps1</span>

<span class="c"># Initialiser le segmenteur unifié</span>
<span class="nb">Initialize-UnifiedSegmenter</span>

<span class="c"># Analyser un fichier texte</span>
<span class="nv">$analysis</span> <span class="p">=</span> <span class="nb">Get-FileAnalysis</span> <span class="n">-FilePath</span> <span class="s2">&quot;document.txt&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;TEXT&quot;</span>

<span class="c"># Afficher les scores de lisibilité</span>
<span class="nv">$readability</span> <span class="p">=</span> <span class="nv">$analysis</span><span class="p">.</span><span class="n">readability</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Scores de lisibilité :&quot;</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;- Flesch Reading Ease : </span><span class="p">$(</span><span class="nv">$readability</span><span class="p">.</span><span class="n">flesch_reading_ease</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;- Flesch-Kincaid Grade : </span><span class="p">$(</span><span class="nv">$readability</span><span class="p">.</span><span class="n">flesch_kincaid_grade</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;- Gunning Fog : </span><span class="p">$(</span><span class="nv">$readability</span><span class="p">.</span><span class="n">gunning_fog</span><span class="p">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
<section id="exemple-4-conversion-entre-formats">
<h3>Exemple 4 : Conversion entre formats<a class="headerlink" href="#exemple-4-conversion-entre-formats" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Importer le module UnifiedSegmenter</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">UnifiedSegmenter</span><span class="p">.</span><span class="n">ps1</span>

<span class="c"># Initialiser le segmenteur unifié</span>
<span class="nb">Initialize-UnifiedSegmenter</span>

<span class="c"># Convertir un fichier JSON en XML</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="nb">Convert-FileFormat</span> <span class="n">-InputFile</span> <span class="s2">&quot;data.json&quot;</span> <span class="n">-OutputFile</span> <span class="s2">&quot;data.xml&quot;</span> <span class="n">-InputFormat</span> <span class="s2">&quot;JSON&quot;</span> <span class="n">-OutputFormat</span> <span class="s2">&quot;XML&quot;</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Conversion réussie !&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    
    <span class="c"># Valider le fichier XML généré</span>
    <span class="nv">$isValid</span> <span class="p">=</span> <span class="nb">Test-FileValidity</span> <span class="n">-FilePath</span> <span class="s2">&quot;data.xml&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;XML&quot;</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nv">$isValid</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;Le fichier XML généré est valide.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;Le fichier XML généré n&#39;est pas valide.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Échec de la conversion.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="depannage">
<h2>Dépannage<a class="headerlink" href="#depannage" title="Link to this heading"></a></h2>
<section id="problemes-courants">
<h3>Problèmes courants<a class="headerlink" href="#problemes-courants" title="Link to this heading"></a></h3>
<section id="python-n-est-pas-disponible">
<h4>Python n’est pas disponible<a class="headerlink" href="#python-n-est-pas-disponible" title="Link to this heading"></a></h4>
<p>Si vous obtenez une erreur indiquant que Python n’est pas disponible, vérifiez que Python est installé et accessible dans le chemin système. Vous pouvez spécifier le chemin complet vers l’exécutable Python lors de l’initialisation :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Initialize-UnifiedSegmenter</span> <span class="n">-PythonPath</span> <span class="s2">&quot;C:\Python39\python.exe&quot;</span>
</pre></div>
</div>
</section>
<section id="modules-python-manquants">
<h4>Modules Python manquants<a class="headerlink" href="#modules-python-manquants" title="Link to this heading"></a></h4>
<p>Si vous obtenez une erreur concernant des modules Python manquants, installez-les avec pip :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">-m</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">lxml</span>
</pre></div>
</div>
</section>
<section id="erreurs-de-segmentation">
<h4>Erreurs de segmentation<a class="headerlink" href="#erreurs-de-segmentation" title="Link to this heading"></a></h4>
<p>Si la segmentation échoue, essayez de réduire la taille des segments :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Split-File</span> <span class="n">-FilePath</span> <span class="s2">&quot;data.json&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="n">2</span>
</pre></div>
</div>
</section>
<section id="erreurs-de-validation-xml">
<h4>Erreurs de validation XML<a class="headerlink" href="#erreurs-de-validation-xml" title="Link to this heading"></a></h4>
<p>Si la validation XML échoue, vérifiez que le schéma XSD est correct et que le fichier XML est bien formé :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Vérifier que le fichier XML est bien formé</span>
<span class="nv">$isValid</span> <span class="p">=</span> <span class="nb">Test-FileValidity</span> <span class="n">-FilePath</span> <span class="s2">&quot;data.xml&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;XML&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="journalisation-et-debogage">
<h3>Journalisation et débogage<a class="headerlink" href="#journalisation-et-debogage" title="Link to this heading"></a></h3>
<p>Pour activer la journalisation détaillée, utilisez le paramètre <code class="docutils literal notranslate"><span class="pre">-Verbose</span></code> :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Initialize-UnifiedSegmenter</span> <span class="n">-Verbose</span>
<span class="nb">Split-File</span> <span class="n">-FilePath</span> <span class="s2">&quot;data.json&quot;</span> <span class="n">-OutputDir</span> <span class="s2">&quot;.\output&quot;</span> <span class="n">-Verbose</span>
</pre></div>
</div>
</section>
<section id="obtenir-de-l-aide">
<h3>Obtenir de l’aide<a class="headerlink" href="#obtenir-de-l-aide" title="Link to this heading"></a></h3>
<p>Pour obtenir de l’aide sur une fonction spécifique, utilisez <code class="docutils literal notranslate"><span class="pre">Get-Help</span></code> :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Get-Help</span> <span class="nb">Split-File</span> <span class="n">-Detailed</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, EMAIL_SENDER_1 Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>