

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Module MCPManager &mdash; EMAIL_SENDER_1 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Module InputSegmenter" href="InputSegmenter.html" />
    <link rel="prev" title="Module DependencyManager" href="DependencyManager.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            EMAIL_SENDER_1
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contenu:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Documentation des API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="CycleDetector.html">Module CycleDetector</a></li>
<li class="toctree-l2"><a class="reference internal" href="DependencyManager.html">Module DependencyManager</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Module MCPManager</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fonctions-principales">Fonctions principales</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#initialize-mcpmanager">Initialize-MCPManager</a></li>
<li class="toctree-l4"><a class="reference internal" href="#find-mcpservers">Find-MCPServers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#new-mcpconfiguration">New-MCPConfiguration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#start-mcpserver">Start-MCPServer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stop-mcpserver">Stop-MCPServer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#invoke-mcpcommand">Invoke-MCPCommand</a></li>
<li class="toctree-l4"><a class="reference internal" href="#install-mcpdependencies">Install-MCPDependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test-mcpserver">Test-MCPServer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#write-mcplog">Write-MCPLog</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="InputSegmenter.html">Module InputSegmenter</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/CycleDetector_Examples.html">Exemples d’utilisation du module CycleDetector</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/DependencyManager_Examples.html">Exemples d’utilisation du module DependencyManager</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/MCPManager_Examples.html">Exemples d’utilisation du module MCPManager</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/InputSegmenter_Examples.html">Exemples d’utilisation du module InputSegmenter</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EMAIL_SENDER_1</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Documentation des API</a></li>
      <li class="breadcrumb-item active">Module MCPManager</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/MCPManager.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-mcpmanager">
<h1>Module MCPManager<a class="headerlink" href="#module-mcpmanager" title="Link to this heading"></a></h1>
<p>Le module <code class="docutils literal notranslate"><span class="pre">MCPManager</span></code> fournit des fonctionnalités pour gérer les serveurs MCP (Model Context Protocol), détecter les serveurs disponibles, et interagir avec eux. Il permet de démarrer, arrêter et configurer des serveurs MCP locaux ou distants.</p>
<section id="fonctions-principales">
<h2>Fonctions principales<a class="headerlink" href="#fonctions-principales" title="Link to this heading"></a></h2>
<section id="initialize-mcpmanager">
<h3>Initialize-MCPManager<a class="headerlink" href="#initialize-mcpmanager" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Initialize-MCPManager</span> <span class="p">[</span><span class="n">-Enabled</span> <span class="p">&lt;</span><span class="n">Boolean</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-ConfigPath</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-LogPath</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-LogLevel</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span>
</pre></div>
</div>
<p>Initialise le gestionnaire MCP avec les paramètres spécifiés.</p>
<dl class="simple">
<dt>Paramètres:</dt><dd><ul class="simple">
<li><p><strong>Enabled</strong> (<em>Boolean</em>) - Active ou désactive le gestionnaire MCP. Valeur par défaut : $true</p></li>
<li><p><strong>ConfigPath</strong> (<em>String</em>) - Chemin du fichier de configuration. Valeur par défaut : “.configmcp_manager.json”</p></li>
<li><p><strong>LogPath</strong> (<em>String</em>) - Chemin du fichier de log. Valeur par défaut : “.logsmcp_manager.log”</p></li>
<li><p><strong>LogLevel</strong> (<em>String</em>) - Niveau de log (DEBUG, INFO, WARNING, ERROR). Valeur par défaut : “INFO”</p></li>
</ul>
</dd>
<dt>Valeur de retour:</dt><dd><p>Booléen indiquant si l’initialisation a réussi.</p>
</dd>
</dl>
<p>Exemple:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Initialiser le gestionnaire MCP avec un fichier de configuration personnalisé</span>
<span class="nb">Initialize-MCPManager</span> <span class="n">-Enabled</span> <span class="nv">$true</span> <span class="n">-ConfigPath</span> <span class="s2">&quot;.\config\custom_mcp_config.json&quot;</span> <span class="n">-LogPath</span> <span class="s2">&quot;.\logs\mcp.log&quot;</span> <span class="n">-LogLevel</span> <span class="s2">&quot;DEBUG&quot;</span>
</pre></div>
</div>
</section>
<section id="find-mcpservers">
<h3>Find-MCPServers<a class="headerlink" href="#find-mcpservers" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Find-MCPServers</span> <span class="p">[</span><span class="n">-ScanLocalPorts</span><span class="p">]</span> <span class="p">[</span><span class="n">-ScanRemoteHosts</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">[]&gt;]</span> <span class="p">[</span><span class="n">-PortRange</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">[]&gt;]</span> <span class="p">[</span><span class="n">-Timeout</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span>
</pre></div>
</div>
<p>Recherche les serveurs MCP disponibles sur le réseau local ou sur des hôtes distants.</p>
<dl class="simple">
<dt>Paramètres:</dt><dd><ul class="simple">
<li><p><strong>ScanLocalPorts</strong> (<em>Switch</em>) - Analyse les ports locaux pour détecter les serveurs MCP.</p></li>
<li><p><strong>ScanRemoteHosts</strong> (<em>String[]</em>) - Tableau d’hôtes distants à analyser.</p></li>
<li><p><strong>PortRange</strong> (<em>Int32[]</em>) - Plage de ports à analyser. Par défaut : 8000-8100.</p></li>
<li><p><strong>Timeout</strong> (<em>Int32</em>) - Délai d’attente en millisecondes. Par défaut : 1000.</p></li>
</ul>
</dd>
<dt>Valeur de retour:</dt><dd><p>Un tableau d’objets représentant les serveurs MCP détectés, avec les propriétés suivantes:</p>
<ul class="simple">
<li><p><strong>Host</strong> (<em>String</em>) - Nom ou adresse IP de l’hôte.</p></li>
<li><p><strong>Port</strong> (<em>Int32</em>) - Numéro de port du serveur MCP.</p></li>
<li><p><strong>Type</strong> (<em>String</em>) - Type de serveur MCP (local, n8n, notion, etc.).</p></li>
<li><p><strong>Status</strong> (<em>String</em>) - État du serveur (running, stopped, etc.).</p></li>
<li><p><strong>Version</strong> (<em>String</em>) - Version du serveur MCP.</p></li>
<li><p><strong>Url</strong> (<em>String</em>) - URL complète du serveur MCP.</p></li>
</ul>
</dd>
</dl>
<p>Exemple:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Rechercher les serveurs MCP locaux</span>
<span class="nv">$localServers</span> <span class="p">=</span> <span class="nb">Find-MCPServers</span> <span class="n">-ScanLocalPorts</span>

<span class="c"># Afficher les serveurs détectés</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$server</span> <span class="k">in</span> <span class="nv">$localServers</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Serveur MCP détecté: </span><span class="p">$(</span><span class="nv">$server</span><span class="p">.</span><span class="n">Type</span><span class="p">)</span><span class="s2"> sur </span><span class="p">$(</span><span class="nv">$server</span><span class="p">.</span><span class="n">Host</span><span class="p">)</span><span class="s2">:</span><span class="p">$(</span><span class="nv">$server</span><span class="p">.</span><span class="n">Port</span><span class="p">)</span><span class="s2"> - </span><span class="p">$(</span><span class="nv">$server</span><span class="p">.</span><span class="n">Status</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="p">}</span>

<span class="c"># Rechercher les serveurs MCP sur des hôtes distants</span>
<span class="nv">$remoteServers</span> <span class="p">=</span> <span class="nb">Find-MCPServers</span> <span class="n">-ScanRemoteHosts</span> <span class="p">@(</span><span class="s2">&quot;server1.example.com&quot;</span><span class="p">,</span> <span class="s2">&quot;server2.example.com&quot;</span><span class="p">)</span> <span class="n">-PortRange</span> <span class="p">@(</span><span class="n">8000</span><span class="p">,</span> <span class="n">8001</span><span class="p">,</span> <span class="n">8002</span><span class="p">)</span>

<span class="c"># Afficher les serveurs distants détectés</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$server</span> <span class="k">in</span> <span class="nv">$remoteServers</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Serveur MCP distant détecté: </span><span class="p">$(</span><span class="nv">$server</span><span class="p">.</span><span class="n">Type</span><span class="p">)</span><span class="s2"> sur </span><span class="p">$(</span><span class="nv">$server</span><span class="p">.</span><span class="n">Host</span><span class="p">)</span><span class="s2">:</span><span class="p">$(</span><span class="nv">$server</span><span class="p">.</span><span class="n">Port</span><span class="p">)</span><span class="s2"> - </span><span class="p">$(</span><span class="nv">$server</span><span class="p">.</span><span class="n">Status</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="new-mcpconfiguration">
<h3>New-MCPConfiguration<a class="headerlink" href="#new-mcpconfiguration" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">New-MCPConfiguration</span> <span class="p">[</span><span class="n">-OutputPath</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-ServerType</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Port</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Host</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Force</span><span class="p">]</span>
</pre></div>
</div>
<p>Crée un fichier de configuration pour un serveur MCP.</p>
<dl class="simple">
<dt>Paramètres:</dt><dd><ul class="simple">
<li><p><strong>OutputPath</strong> (<em>String</em>) - Chemin du fichier de configuration à créer. Par défaut : “.configmcp_config.json”</p></li>
<li><p><strong>ServerType</strong> (<em>String</em>) - Type de serveur MCP (local, n8n, notion, gateway, git-ingest). Par défaut : “local”</p></li>
<li><p><strong>Port</strong> (<em>Int32</em>) - Numéro de port du serveur MCP. Par défaut : 8000</p></li>
<li><p><strong>Host</strong> (<em>String</em>) - Nom ou adresse IP de l’hôte. Par défaut : “localhost”</p></li>
<li><p><strong>Force</strong> (<em>Switch</em>) - Écrase le fichier de configuration s’il existe déjà.</p></li>
</ul>
</dd>
<dt>Valeur de retour:</dt><dd><p>Booléen indiquant si la création du fichier de configuration a réussi.</p>
</dd>
</dl>
<p>Exemple:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Créer une configuration pour un serveur MCP local</span>
<span class="nv">$configCreated</span> <span class="p">=</span> <span class="nb">New-MCPConfiguration</span> <span class="n">-OutputPath</span> <span class="s2">&quot;.\config\local_mcp_config.json&quot;</span> <span class="n">-ServerType</span> <span class="s2">&quot;local&quot;</span> <span class="n">-Port</span> <span class="n">8000</span> <span class="n">-Force</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$configCreated</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Configuration créée avec succès: .\config\local_mcp_config.json&quot;</span>
<span class="p">}</span>

<span class="c"># Créer une configuration pour un serveur MCP n8n</span>
<span class="nv">$n8nConfigCreated</span> <span class="p">=</span> <span class="nb">New-MCPConfiguration</span> <span class="n">-OutputPath</span> <span class="s2">&quot;.\config\n8n_mcp_config.json&quot;</span> <span class="n">-ServerType</span> <span class="s2">&quot;n8n&quot;</span> <span class="n">-Port</span> <span class="n">5678</span> <span class="n">-Host</span> <span class="s2">&quot;localhost&quot;</span> <span class="n">-Force</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$n8nConfigCreated</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Configuration n8n créée avec succès: .\config\n8n_mcp_config.json&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="start-mcpserver">
<h3>Start-MCPServer<a class="headerlink" href="#start-mcpserver" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Start-MCPServer</span> <span class="p">[</span><span class="n">-ServerType</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Port</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Host</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-ConfigPath</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Wait</span><span class="p">]</span> <span class="p">[</span><span class="n">-Timeout</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span>
</pre></div>
</div>
<p>Démarre un serveur MCP.</p>
<dl class="simple">
<dt>Paramètres:</dt><dd><ul class="simple">
<li><p><strong>ServerType</strong> (<em>String</em>) - Type de serveur MCP (local, n8n, notion, gateway, git-ingest). Par défaut : “local”</p></li>
<li><p><strong>Port</strong> (<em>Int32</em>) - Numéro de port du serveur MCP. Par défaut : 8000</p></li>
<li><p><strong>Host</strong> (<em>String</em>) - Nom ou adresse IP de l’hôte. Par défaut : “localhost”</p></li>
<li><p><strong>ConfigPath</strong> (<em>String</em>) - Chemin du fichier de configuration. Par défaut : “.configmcp_config.json”</p></li>
<li><p><strong>Wait</strong> (<em>Switch</em>) - Attend que le serveur soit prêt avant de retourner.</p></li>
<li><p><strong>Timeout</strong> (<em>Int32</em>) - Délai d’attente en secondes. Par défaut : 30</p></li>
</ul>
</dd>
<dt>Valeur de retour:</dt><dd><p>Un objet représentant le serveur MCP démarré, avec les propriétés suivantes:</p>
<ul class="simple">
<li><p><strong>ProcessId</strong> (<em>Int32</em>) - ID du processus du serveur MCP.</p></li>
<li><p><strong>ServerType</strong> (<em>String</em>) - Type de serveur MCP.</p></li>
<li><p><strong>Port</strong> (<em>Int32</em>) - Numéro de port du serveur MCP.</p></li>
<li><p><strong>Host</strong> (<em>String</em>) - Nom ou adresse IP de l’hôte.</p></li>
<li><p><strong>Url</strong> (<em>String</em>) - URL complète du serveur MCP.</p></li>
<li><p><strong>Status</strong> (<em>String</em>) - État du serveur (running, error).</p></li>
</ul>
</dd>
</dl>
<p>Exemple:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Démarrer un serveur MCP local</span>
<span class="nv">$server</span> <span class="p">=</span> <span class="nb">Start-MCPServer</span> <span class="n">-ServerType</span> <span class="s2">&quot;local&quot;</span> <span class="n">-Port</span> <span class="n">8000</span> <span class="n">-Wait</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$server</span><span class="p">.</span><span class="n">Status</span> <span class="o">-eq</span> <span class="s2">&quot;running&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Serveur MCP démarré avec succès: </span><span class="p">$(</span><span class="nv">$server</span><span class="p">.</span><span class="n">Url</span><span class="p">)</span><span class="s2">&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;ID du processus: </span><span class="p">$(</span><span class="nv">$server</span><span class="p">.</span><span class="n">ProcessId</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Erreur lors du démarrage du serveur MCP: </span><span class="p">$(</span><span class="nv">$server</span><span class="p">.</span><span class="n">Error</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="p">}</span>

<span class="c"># Démarrer un serveur MCP n8n</span>
<span class="nv">$n8nServer</span> <span class="p">=</span> <span class="nb">Start-MCPServer</span> <span class="n">-ServerType</span> <span class="s2">&quot;n8n&quot;</span> <span class="n">-Port</span> <span class="n">5678</span> <span class="n">-Wait</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$n8nServer</span><span class="p">.</span><span class="n">Status</span> <span class="o">-eq</span> <span class="s2">&quot;running&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Serveur MCP n8n démarré avec succès: </span><span class="p">$(</span><span class="nv">$n8nServer</span><span class="p">.</span><span class="n">Url</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="stop-mcpserver">
<h3>Stop-MCPServer<a class="headerlink" href="#stop-mcpserver" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Stop-MCPServer</span> <span class="p">[</span><span class="n">-ServerType</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Port</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Host</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-ProcessId</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Force</span><span class="p">]</span>
</pre></div>
</div>
<p>Arrête un serveur MCP.</p>
<dl class="simple">
<dt>Paramètres:</dt><dd><ul class="simple">
<li><p><strong>ServerType</strong> (<em>String</em>) - Type de serveur MCP (local, n8n, notion, gateway, git-ingest). Par défaut : “local”</p></li>
<li><p><strong>Port</strong> (<em>Int32</em>) - Numéro de port du serveur MCP. Par défaut : 8000</p></li>
<li><p><strong>Host</strong> (<em>String</em>) - Nom ou adresse IP de l’hôte. Par défaut : “localhost”</p></li>
<li><p><strong>ProcessId</strong> (<em>Int32</em>) - ID du processus du serveur MCP.</p></li>
<li><p><strong>Force</strong> (<em>Switch</em>) - Force l’arrêt du serveur.</p></li>
</ul>
</dd>
<dt>Valeur de retour:</dt><dd><p>Booléen indiquant si l’arrêt du serveur a réussi.</p>
</dd>
</dl>
<p>Exemple:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Arrêter un serveur MCP local</span>
<span class="nv">$stopped</span> <span class="p">=</span> <span class="nb">Stop-MCPServer</span> <span class="n">-ServerType</span> <span class="s2">&quot;local&quot;</span> <span class="n">-Port</span> <span class="n">8000</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$stopped</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Serveur MCP arrêté avec succès&quot;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Erreur lors de l&#39;arrêt du serveur MCP&quot;</span>
<span class="p">}</span>

<span class="c"># Arrêter un serveur MCP par son ID de processus</span>
<span class="nv">$stoppedById</span> <span class="p">=</span> <span class="nb">Stop-MCPServer</span> <span class="n">-ProcessId</span> <span class="n">1234</span> <span class="n">-Force</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$stoppedById</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Serveur MCP avec l&#39;ID de processus 1234 arrêté avec succès&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="invoke-mcpcommand">
<h3>Invoke-MCPCommand<a class="headerlink" href="#invoke-mcpcommand" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-MCPCommand</span> <span class="p">[</span><span class="n">-Command</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Parameters</span> <span class="p">&lt;</span><span class="n">Hashtable</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-ServerType</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Port</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Host</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Timeout</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span>
</pre></div>
</div>
<p>Exécute une commande sur un serveur MCP.</p>
<dl class="simple">
<dt>Paramètres:</dt><dd><ul class="simple">
<li><p><strong>Command</strong> (<em>String</em>) - Commande à exécuter.</p></li>
<li><p><strong>Parameters</strong> (<em>Hashtable</em>) - Paramètres de la commande.</p></li>
<li><p><strong>ServerType</strong> (<em>String</em>) - Type de serveur MCP (local, n8n, notion, gateway, git-ingest). Par défaut : “local”</p></li>
<li><p><strong>Port</strong> (<em>Int32</em>) - Numéro de port du serveur MCP. Par défaut : 8000</p></li>
<li><p><strong>Host</strong> (<em>String</em>) - Nom ou adresse IP de l’hôte. Par défaut : “localhost”</p></li>
<li><p><strong>Timeout</strong> (<em>Int32</em>) - Délai d’attente en secondes. Par défaut : 30</p></li>
</ul>
</dd>
<dt>Valeur de retour:</dt><dd><p>Le résultat de l’exécution de la commande.</p>
</dd>
</dl>
<p>Exemple:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Exécuter une commande sur un serveur MCP local</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="nb">Invoke-MCPCommand</span> <span class="n">-Command</span> <span class="s2">&quot;get_tools&quot;</span> <span class="n">-ServerType</span> <span class="s2">&quot;local&quot;</span> <span class="n">-Port</span> <span class="n">8000</span>

<span class="c"># Afficher les outils disponibles</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Outils disponibles sur le serveur MCP:&quot;</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$tool</span> <span class="k">in</span> <span class="nv">$result</span><span class="p">.</span><span class="n">tools</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;- </span><span class="p">$(</span><span class="nv">$tool</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="s2">: </span><span class="p">$(</span><span class="nv">$tool</span><span class="p">.</span><span class="n">description</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="p">}</span>

<span class="c"># Exécuter une commande avec des paramètres</span>
<span class="nv">$addResult</span> <span class="p">=</span> <span class="nb">Invoke-MCPCommand</span> <span class="n">-Command</span> <span class="s2">&quot;add&quot;</span> <span class="n">-Parameters</span> <span class="p">@{</span> <span class="n">a</span> <span class="p">=</span> <span class="n">2</span><span class="p">;</span> <span class="n">b</span> <span class="p">=</span> <span class="n">3</span> <span class="p">}</span> <span class="n">-ServerType</span> <span class="s2">&quot;local&quot;</span> <span class="n">-Port</span> <span class="n">8000</span>

<span class="nb">Write-Host</span> <span class="s2">&quot;Résultat de l&#39;addition: $addResult&quot;</span>
</pre></div>
</div>
</section>
<section id="install-mcpdependencies">
<h3>Install-MCPDependencies<a class="headerlink" href="#install-mcpdependencies" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Install-MCPDependencies</span> <span class="p">[</span><span class="n">-ServerType</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Force</span><span class="p">]</span>
</pre></div>
</div>
<p>Installe les dépendances nécessaires pour un serveur MCP.</p>
<dl class="simple">
<dt>Paramètres:</dt><dd><ul class="simple">
<li><p><strong>ServerType</strong> (<em>String</em>) - Type de serveur MCP (local, n8n, notion, gateway, git-ingest). Par défaut : “local”</p></li>
<li><p><strong>Force</strong> (<em>Switch</em>) - Force l’installation des dépendances même si elles sont déjà installées.</p></li>
</ul>
</dd>
<dt>Valeur de retour:</dt><dd><p>Booléen indiquant si l’installation des dépendances a réussi.</p>
</dd>
</dl>
<p>Exemple:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Installer les dépendances pour un serveur MCP local</span>
<span class="nv">$installed</span> <span class="p">=</span> <span class="nb">Install-MCPDependencies</span> <span class="n">-ServerType</span> <span class="s2">&quot;local&quot;</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$installed</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Dépendances installées avec succès&quot;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Erreur lors de l&#39;installation des dépendances&quot;</span>
<span class="p">}</span>

<span class="c"># Forcer l&#39;installation des dépendances pour un serveur MCP n8n</span>
<span class="nv">$n8nInstalled</span> <span class="p">=</span> <span class="nb">Install-MCPDependencies</span> <span class="n">-ServerType</span> <span class="s2">&quot;n8n&quot;</span> <span class="n">-Force</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$n8nInstalled</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Dépendances n8n installées avec succès&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="test-mcpserver">
<h3>Test-MCPServer<a class="headerlink" href="#test-mcpserver" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Test-MCPServer</span> <span class="p">[</span><span class="n">-ServerType</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Port</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Host</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Timeout</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span>
</pre></div>
</div>
<p>Teste la disponibilité d’un serveur MCP.</p>
<dl class="simple">
<dt>Paramètres:</dt><dd><ul class="simple">
<li><p><strong>ServerType</strong> (<em>String</em>) - Type de serveur MCP (local, n8n, notion, gateway, git-ingest). Par défaut : “local”</p></li>
<li><p><strong>Port</strong> (<em>Int32</em>) - Numéro de port du serveur MCP. Par défaut : 8000</p></li>
<li><p><strong>Host</strong> (<em>String</em>) - Nom ou adresse IP de l’hôte. Par défaut : “localhost”</p></li>
<li><p><strong>Timeout</strong> (<em>Int32</em>) - Délai d’attente en millisecondes. Par défaut : 1000</p></li>
</ul>
</dd>
<dt>Valeur de retour:</dt><dd><p>Un objet avec les propriétés suivantes:</p>
<ul class="simple">
<li><p><strong>Available</strong> (<em>Boolean</em>) - Indique si le serveur est disponible.</p></li>
<li><p><strong>ResponseTime</strong> (<em>Int32</em>) - Temps de réponse en millisecondes.</p></li>
<li><p><strong>Version</strong> (<em>String</em>) - Version du serveur MCP.</p></li>
<li><p><strong>ServerType</strong> (<em>String</em>) - Type de serveur MCP.</p></li>
<li><p><strong>Url</strong> (<em>String</em>) - URL complète du serveur MCP.</p></li>
</ul>
</dd>
</dl>
<p>Exemple:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Tester un serveur MCP local</span>
<span class="nv">$testResult</span> <span class="p">=</span> <span class="nb">Test-MCPServer</span> <span class="n">-ServerType</span> <span class="s2">&quot;local&quot;</span> <span class="n">-Port</span> <span class="n">8000</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$testResult</span><span class="p">.</span><span class="n">Available</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Serveur MCP disponible: </span><span class="p">$(</span><span class="nv">$testResult</span><span class="p">.</span><span class="n">Url</span><span class="p">)</span><span class="s2">&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Temps de réponse: </span><span class="p">$(</span><span class="nv">$testResult</span><span class="p">.</span><span class="n">ResponseTime</span><span class="p">)</span><span class="s2"> ms&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Version: </span><span class="p">$(</span><span class="nv">$testResult</span><span class="p">.</span><span class="n">Version</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Serveur MCP non disponible&quot;</span>
<span class="p">}</span>

<span class="c"># Tester un serveur MCP distant</span>
<span class="nv">$remoteTestResult</span> <span class="p">=</span> <span class="nb">Test-MCPServer</span> <span class="n">-ServerType</span> <span class="s2">&quot;n8n&quot;</span> <span class="n">-Port</span> <span class="n">5678</span> <span class="n">-Host</span> <span class="s2">&quot;server.example.com&quot;</span> <span class="n">-Timeout</span> <span class="n">2000</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$remoteTestResult</span><span class="p">.</span><span class="n">Available</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Serveur MCP distant disponible: </span><span class="p">$(</span><span class="nv">$remoteTestResult</span><span class="p">.</span><span class="n">Url</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="write-mcplog">
<h3>Write-MCPLog<a class="headerlink" href="#write-mcplog" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Write-MCPLog</span> <span class="p">[</span><span class="n">-Message</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-Level</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-LogPath</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span>
</pre></div>
</div>
<p>Écrit un message dans le fichier de log du gestionnaire MCP.</p>
<dl class="simple">
<dt>Paramètres:</dt><dd><ul class="simple">
<li><p><strong>Message</strong> (<em>String</em>) - Message à écrire dans le log.</p></li>
<li><p><strong>Level</strong> (<em>String</em>) - Niveau de log (DEBUG, INFO, WARNING, ERROR). Par défaut : “INFO”</p></li>
<li><p><strong>LogPath</strong> (<em>String</em>) - Chemin du fichier de log. Par défaut : valeur définie lors de l’initialisation</p></li>
</ul>
</dd>
<dt>Valeur de retour:</dt><dd><p>Aucune.</p>
</dd>
</dl>
<p>Exemple:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Écrire un message d&#39;information dans le log</span>
<span class="nb">Write-MCPLog</span> <span class="n">-Message</span> <span class="s2">&quot;Démarrage du serveur MCP&quot;</span> <span class="n">-Level</span> <span class="s2">&quot;INFO&quot;</span>

<span class="c"># Écrire un message d&#39;erreur dans le log</span>
<span class="nb">Write-MCPLog</span> <span class="n">-Message</span> <span class="s2">&quot;Erreur lors de la connexion au serveur MCP: Connexion refusée&quot;</span> <span class="n">-Level</span> <span class="s2">&quot;ERROR&quot;</span>

<span class="c"># Écrire un message de débogage dans un fichier de log spécifique</span>
<span class="nb">Write-MCPLog</span> <span class="n">-Message</span> <span class="s2">&quot;Détails de la requête: $requestDetails&quot;</span> <span class="n">-Level</span> <span class="s2">&quot;DEBUG&quot;</span> <span class="n">-LogPath</span> <span class="s2">&quot;.\logs\mcp_debug.log&quot;</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="DependencyManager.html" class="btn btn-neutral float-left" title="Module DependencyManager" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="InputSegmenter.html" class="btn btn-neutral float-right" title="Module InputSegmenter" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, EMAIL_SENDER_1 Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>