

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Module de segmentation d’entrées (InputSegmenter) &mdash; EMAIL_SENDER_1 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            EMAIL_SENDER_1
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contenu:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Documentation des API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EMAIL_SENDER_1</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Module de segmentation d’entrées (InputSegmenter)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/technical/InputSegmenter.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-de-segmentation-d-entrees-inputsegmenter">
<h1>Module de segmentation d’entrées (InputSegmenter)<a class="headerlink" href="#module-de-segmentation-d-entrees-inputsegmenter" title="Link to this heading"></a></h1>
<section id="vue-d-ensemble">
<h2>Vue d’ensemble<a class="headerlink" href="#vue-d-ensemble" title="Link to this heading"></a></h2>
<p>Le module <code class="docutils literal notranslate"><span class="pre">InputSegmentation</span></code> est un composant essentiel qui permet de segmenter automatiquement les entrées volumineuses en morceaux plus petits et gérables. Cette fonctionnalité est particulièrement utile pour traiter des données qui dépassent les limites de taille imposées par certains outils ou API, comme les modèles d’IA ou les services web.</p>
<p>Le module prend en charge différents types d’entrées (texte, JSON, fichiers) et offre plusieurs stratégies de segmentation pour préserver la structure et la cohérence des données. Il s’intègre également avec d’autres modules du système, comme Agent Auto et le cache prédictif, pour offrir une solution complète de traitement des données volumineuses.</p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h2>
<p>Le module est disponible dans le dossier <code class="docutils literal notranslate"><span class="pre">modules</span></code> du projet. Pour l’importer :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Import-Module</span> <span class="n">-Path</span> <span class="s2">&quot;.\modules\InputSegmentation.psm1&quot;</span> <span class="n">-Force</span>
</pre></div>
</div>
</section>
<section id="initialisation">
<h2>Initialisation<a class="headerlink" href="#initialisation" title="Link to this heading"></a></h2>
<p>Avant d’utiliser le module, il est recommandé de l’initialiser avec les paramètres souhaités :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Initialize-InputSegmentation</span> <span class="n">-MaxInputSizeKB</span> <span class="n">15</span> <span class="n">-DefaultChunkSizeKB</span> <span class="n">7</span> <span class="n">-StateFilePath</span> <span class="s2">&quot;.\cache\segmentation_state.json&quot;</span>
</pre></div>
</div>
</section>
<section id="architecture">
<h2>Architecture<a class="headerlink" href="#architecture" title="Link to this heading"></a></h2>
<p>Le module <code class="docutils literal notranslate"><span class="pre">InputSegmentation</span></code> est conçu selon les principes SOLID et offre une architecture modulaire et extensible :</p>
<ol class="simple">
<li><p><strong>Couche d’initialisation</strong> : Configure les paramètres globaux du module</p></li>
<li><p><strong>Couche de mesure</strong> : Évalue la taille des entrées</p></li>
<li><p><strong>Couche de segmentation</strong> : Divise les entrées en segments selon leur type</p></li>
<li><p><strong>Couche d’état</strong> : Gère la persistance de l’état de segmentation</p></li>
<li><p><strong>Couche d’exécution</strong> : Traite les segments avec un script fourni par l’utilisateur</p></li>
</ol>
<p>Cette architecture permet d’ajouter facilement de nouveaux types d’entrées ou de nouvelles stratégies de segmentation sans modifier le code existant.</p>
</section>
<section id="fonctions-principales">
<h2>Fonctions principales<a class="headerlink" href="#fonctions-principales" title="Link to this heading"></a></h2>
<section id="initialize-inputsegmentation">
<h3>Initialize-InputSegmentation<a class="headerlink" href="#initialize-inputsegmentation" title="Link to this heading"></a></h3>
<p>Initialise le module de segmentation avec les paramètres spécifiés.</p>
<section id="syntaxe">
<h4>Syntaxe<a class="headerlink" href="#syntaxe" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Initialize-InputSegmentation</span> <span class="p">[</span><span class="n">-MaxInputSizeKB</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-DefaultChunkSizeKB</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-StateFilePath</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="parametres">
<h4>Paramètres<a class="headerlink" href="#parametres" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>MaxInputSizeKB</strong> : Taille maximale d’entrée en kilooctets avant segmentation. Par défaut : 10.</p></li>
<li><p><strong>DefaultChunkSizeKB</strong> : Taille par défaut des segments en kilooctets. Par défaut : 5.</p></li>
<li><p><strong>StateFilePath</strong> : Chemin du fichier pour stocker l’état de segmentation. Par défaut : dossier temporaire.</p></li>
</ul>
</section>
<section id="exemple">
<h4>Exemple<a class="headerlink" href="#exemple" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Initialiser avec des valeurs personnalisées</span>
<span class="nb">Initialize-InputSegmentation</span> <span class="n">-MaxInputSizeKB</span> <span class="n">20</span> <span class="n">-DefaultChunkSizeKB</span> <span class="n">8</span> <span class="n">-StateFilePath</span> <span class="s2">&quot;.\cache\segmentation_state.json&quot;</span>

<span class="c"># Initialiser avec les valeurs par défaut</span>
<span class="nb">Initialize-InputSegmentation</span>
</pre></div>
</div>
</section>
</section>
<section id="measure-inputsize">
<h3>Measure-InputSize<a class="headerlink" href="#measure-inputsize" title="Link to this heading"></a></h3>
<p>Mesure la taille d’une entrée en kilooctets.</p>
<section id="id1">
<h4>Syntaxe<a class="headerlink" href="#id1" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Measure-InputSize</span> <span class="n">-Input</span> <span class="p">&lt;</span><span class="n">Object</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="id2">
<h4>Paramètres<a class="headerlink" href="#id2" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Input</strong> : L’entrée à mesurer (texte, JSON, fichier, etc.).</p></li>
</ul>
</section>
<section id="valeur-de-retour">
<h4>Valeur de retour<a class="headerlink" href="#valeur-de-retour" title="Link to this heading"></a></h4>
<p>La taille de l’entrée en kilooctets (KB).</p>
</section>
<section id="id3">
<h4>Exemple<a class="headerlink" href="#id3" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$text</span> <span class="p">=</span> <span class="s2">&quot;A&quot;</span> <span class="p">*</span> <span class="n">10KB</span>
<span class="nv">$size</span> <span class="p">=</span> <span class="nb">Measure-InputSize</span> <span class="n">-Input</span> <span class="nv">$text</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Taille de l&#39;entrée: $size KB&quot;</span>

<span class="nv">$json</span> <span class="p">=</span> <span class="p">@{</span> <span class="s2">&quot;data&quot;</span> <span class="p">=</span> <span class="p">@(</span><span class="n">1</span><span class="p">..</span><span class="n">1000</span><span class="p">)</span> <span class="p">}</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span>
<span class="nv">$jsonSize</span> <span class="p">=</span> <span class="nb">Measure-InputSize</span> <span class="n">-Input</span> <span class="nv">$json</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Taille du JSON: $jsonSize KB&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="split-textinput">
<h3>Split-TextInput<a class="headerlink" href="#split-textinput" title="Link to this heading"></a></h3>
<p>Segmente une chaîne de texte en morceaux plus petits.</p>
<section id="id4">
<h4>Syntaxe<a class="headerlink" href="#id4" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Split-TextInput</span> <span class="n">-Text</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;</span> <span class="p">[</span><span class="n">-ChunkSizeKB</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-PreserveLines</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id5">
<h4>Paramètres<a class="headerlink" href="#id5" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Text</strong> : Le texte à segmenter.</p></li>
<li><p><strong>ChunkSizeKB</strong> : Taille maximale de chaque segment en kilooctets. Si non spécifié, utilise la valeur par défaut.</p></li>
<li><p><strong>PreserveLines</strong> : Préserve les sauts de ligne lors de la segmentation.</p></li>
</ul>
</section>
<section id="id6">
<h4>Valeur de retour<a class="headerlink" href="#id6" title="Link to this heading"></a></h4>
<p>Un tableau de chaînes de texte représentant les segments.</p>
</section>
<section id="id7">
<h4>Exemple<a class="headerlink" href="#id7" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Segmenter un texte sans préserver les lignes</span>
<span class="nv">$text</span> <span class="p">=</span> <span class="s2">&quot;A&quot;</span> <span class="p">*</span> <span class="n">20KB</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-TextInput</span> <span class="n">-Text</span> <span class="nv">$text</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de segments: </span><span class="p">$(</span><span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>

<span class="c"># Segmenter un texte en préservant les lignes</span>
<span class="nv">$multilineText</span> <span class="p">=</span> <span class="s2">&quot;Ligne 1</span><span class="se">`n</span><span class="s2">Ligne 2</span><span class="se">`n</span><span class="s2">Ligne 3&quot;</span> <span class="p">*</span> <span class="n">1000</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-TextInput</span> <span class="n">-Text</span> <span class="nv">$multilineText</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span> <span class="n">-PreserveLines</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de segments: </span><span class="p">$(</span><span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="split-jsoninput">
<h3>Split-JsonInput<a class="headerlink" href="#split-jsoninput" title="Link to this heading"></a></h3>
<p>Segmente un objet JSON en morceaux plus petits.</p>
<section id="id8">
<h4>Syntaxe<a class="headerlink" href="#id8" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Split-JsonInput</span> <span class="n">-JsonObject</span> <span class="p">&lt;</span><span class="n">Object</span><span class="p">&gt;</span> <span class="p">[</span><span class="n">-ChunkSizeKB</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id9">
<h4>Paramètres<a class="headerlink" href="#id9" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>JsonObject</strong> : L’objet JSON à segmenter.</p></li>
<li><p><strong>ChunkSizeKB</strong> : Taille maximale de chaque segment en kilooctets. Si non spécifié, utilise la valeur par défaut.</p></li>
</ul>
</section>
<section id="id10">
<h4>Valeur de retour<a class="headerlink" href="#id10" title="Link to this heading"></a></h4>
<p>Un tableau d’objets représentant les segments du JSON d’origine.</p>
</section>
<section id="id11">
<h4>Exemple<a class="headerlink" href="#id11" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Segmenter un tableau JSON</span>
<span class="nv">$array</span> <span class="p">=</span> <span class="n">1</span><span class="p">..</span><span class="n">1000</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">{</span> <span class="p">@{</span> <span class="s2">&quot;id&quot;</span> <span class="p">=</span> <span class="nv">$_</span><span class="p">;</span> <span class="s2">&quot;data&quot;</span> <span class="p">=</span> <span class="s2">&quot;A&quot;</span> <span class="p">*</span> <span class="n">100</span> <span class="p">}</span> <span class="p">}</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-JsonInput</span> <span class="n">-JsonObject</span> <span class="nv">$array</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de segments: </span><span class="p">$(</span><span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>

<span class="c"># Segmenter un objet JSON</span>
<span class="nv">$object</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="s2">&quot;header&quot;</span> <span class="p">=</span> <span class="p">@{</span> <span class="s2">&quot;version&quot;</span> <span class="p">=</span> <span class="s2">&quot;1.0&quot;</span><span class="p">;</span> <span class="s2">&quot;type&quot;</span> <span class="p">=</span> <span class="s2">&quot;data&quot;</span> <span class="p">}</span>
    <span class="s2">&quot;items&quot;</span> <span class="p">=</span> <span class="n">1</span><span class="p">..</span><span class="n">500</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">{</span> <span class="p">@{</span> <span class="s2">&quot;id&quot;</span> <span class="p">=</span> <span class="nv">$_</span><span class="p">;</span> <span class="s2">&quot;value&quot;</span> <span class="p">=</span> <span class="s2">&quot;Item $_&quot;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">}</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-JsonInput</span> <span class="n">-JsonObject</span> <span class="nv">$object</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de segments: </span><span class="p">$(</span><span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="split-fileinput">
<h3>Split-FileInput<a class="headerlink" href="#split-fileinput" title="Link to this heading"></a></h3>
<p>Segmente un fichier en morceaux plus petits.</p>
<section id="id12">
<h4>Syntaxe<a class="headerlink" href="#id12" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Split-FileInput</span> <span class="n">-FilePath</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;</span> <span class="p">[</span><span class="n">-ChunkSizeKB</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-PreserveLines</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id13">
<h4>Paramètres<a class="headerlink" href="#id13" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>FilePath</strong> : Chemin du fichier à segmenter.</p></li>
<li><p><strong>ChunkSizeKB</strong> : Taille maximale de chaque segment en kilooctets. Si non spécifié, utilise la valeur par défaut.</p></li>
<li><p><strong>PreserveLines</strong> : Préserve les sauts de ligne lors de la segmentation.</p></li>
</ul>
</section>
<section id="id14">
<h4>Valeur de retour<a class="headerlink" href="#id14" title="Link to this heading"></a></h4>
<p>Un tableau de chaînes ou d’objets représentant les segments du fichier.</p>
</section>
<section id="id15">
<h4>Exemple<a class="headerlink" href="#id15" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Segmenter un fichier texte</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-FileInput</span> <span class="n">-FilePath</span> <span class="s2">&quot;.\data\large_text_file.txt&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span> <span class="n">-PreserveLines</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de segments: </span><span class="p">$(</span><span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>

<span class="c"># Segmenter un fichier JSON</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-FileInput</span> <span class="n">-FilePath</span> <span class="s2">&quot;.\data\large_data.json&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de segments: </span><span class="p">$(</span><span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>

<span class="c"># Segmenter un fichier CSV</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-FileInput</span> <span class="n">-FilePath</span> <span class="s2">&quot;.\data\large_data.csv&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span> <span class="n">-PreserveLines</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de segments: </span><span class="p">$(</span><span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="split-input">
<h3>Split-Input<a class="headerlink" href="#split-input" title="Link to this heading"></a></h3>
<p>Fonction générique pour segmenter différents types d’entrées.</p>
<section id="id16">
<h4>Syntaxe<a class="headerlink" href="#id16" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Split-Input</span> <span class="n">-Input</span> <span class="p">&lt;</span><span class="n">Object</span><span class="p">&gt;</span> <span class="p">[</span><span class="n">-ChunkSizeKB</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-PreserveLines</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id17">
<h4>Paramètres<a class="headerlink" href="#id17" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Input</strong> : L’entrée à segmenter (texte, JSON, fichier, etc.).</p></li>
<li><p><strong>ChunkSizeKB</strong> : Taille maximale de chaque segment en kilooctets. Si non spécifié, utilise la valeur par défaut.</p></li>
<li><p><strong>PreserveLines</strong> : Préserve les sauts de ligne lors de la segmentation de texte.</p></li>
</ul>
</section>
<section id="id18">
<h4>Valeur de retour<a class="headerlink" href="#id18" title="Link to this heading"></a></h4>
<p>Un tableau d’objets représentant les segments de l’entrée.</p>
</section>
<section id="id19">
<h4>Exemple<a class="headerlink" href="#id19" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Segmenter une chaîne de texte</span>
<span class="nv">$text</span> <span class="p">=</span> <span class="s2">&quot;A&quot;</span> <span class="p">*</span> <span class="n">20KB</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-Input</span> <span class="n">-Input</span> <span class="nv">$text</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de segments: </span><span class="p">$(</span><span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>

<span class="c"># Segmenter un objet JSON</span>
<span class="nv">$json</span> <span class="p">=</span> <span class="p">@{</span> <span class="s2">&quot;data&quot;</span> <span class="p">=</span> <span class="p">@(</span><span class="n">1</span><span class="p">..</span><span class="n">1000</span><span class="p">)</span> <span class="p">}</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-Input</span> <span class="n">-Input</span> <span class="nv">$json</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de segments: </span><span class="p">$(</span><span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>

<span class="c"># Segmenter un fichier</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-Input</span> <span class="n">-Input</span> <span class="s2">&quot;.\data\large_file.txt&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span> <span class="n">-PreserveLines</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de segments: </span><span class="p">$(</span><span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="save-segmentationstate">
<h3>Save-SegmentationState<a class="headerlink" href="#save-segmentationstate" title="Link to this heading"></a></h3>
<p>Sauvegarde l’état de segmentation pour une reprise ultérieure.</p>
<section id="id20">
<h4>Syntaxe<a class="headerlink" href="#id20" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Save-SegmentationState</span> <span class="n">-Id</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;</span> <span class="n">-Segments</span> <span class="p">&lt;</span><span class="n">Array</span><span class="p">&gt;</span> <span class="n">-CurrentIndex</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="id21">
<h4>Paramètres<a class="headerlink" href="#id21" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Id</strong> : Identifiant unique de l’état de segmentation.</p></li>
<li><p><strong>Segments</strong> : Tableau des segments.</p></li>
<li><p><strong>CurrentIndex</strong> : Index du segment en cours de traitement.</p></li>
</ul>
</section>
<section id="id22">
<h4>Valeur de retour<a class="headerlink" href="#id22" title="Link to this heading"></a></h4>
<p>$true si l’état a été sauvegardé avec succès, $false sinon.</p>
</section>
<section id="id23">
<h4>Exemple<a class="headerlink" href="#id23" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$id</span> <span class="p">=</span> <span class="s2">&quot;my-segmentation-task&quot;</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-Input</span> <span class="n">-Input</span> <span class="nv">$largeInput</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>
<span class="nb">Save-SegmentationState</span> <span class="n">-Id</span> <span class="nv">$id</span> <span class="n">-Segments</span> <span class="nv">$segments</span> <span class="n">-CurrentIndex</span> <span class="n">0</span>
</pre></div>
</div>
</section>
</section>
<section id="get-segmentationstate">
<h3>Get-SegmentationState<a class="headerlink" href="#get-segmentationstate" title="Link to this heading"></a></h3>
<p>Récupère un état de segmentation sauvegardé.</p>
<section id="id24">
<h4>Syntaxe<a class="headerlink" href="#id24" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Get-SegmentationState</span> <span class="n">-Id</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="id25">
<h4>Paramètres<a class="headerlink" href="#id25" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Id</strong> : Identifiant unique de l’état de segmentation.</p></li>
</ul>
</section>
<section id="id26">
<h4>Valeur de retour<a class="headerlink" href="#id26" title="Link to this heading"></a></h4>
<p>Un objet contenant l’état de segmentation, ou $null si l’état n’existe pas.</p>
</section>
<section id="id27">
<h4>Exemple<a class="headerlink" href="#id27" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$id</span> <span class="p">=</span> <span class="s2">&quot;my-segmentation-task&quot;</span>
<span class="nv">$state</span> <span class="p">=</span> <span class="nb">Get-SegmentationState</span> <span class="n">-Id</span> <span class="nv">$id</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$state</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;État récupéré. Segments: </span><span class="p">$(</span><span class="nv">$state</span><span class="p">.</span><span class="n">Segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">, Index: </span><span class="p">$(</span><span class="nv">$state</span><span class="p">.</span><span class="n">CurrentIndex</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="invoke-withsegmentation">
<h3>Invoke-WithSegmentation<a class="headerlink" href="#invoke-withsegmentation" title="Link to this heading"></a></h3>
<p>Traite une entrée avec segmentation automatique.</p>
<section id="id28">
<h4>Syntaxe<a class="headerlink" href="#id28" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-WithSegmentation</span> <span class="n">-Input</span> <span class="p">&lt;</span><span class="n">Object</span><span class="p">&gt;</span> <span class="n">-ScriptBlock</span> <span class="p">&lt;</span><span class="n">ScriptBlock</span><span class="p">&gt;</span> <span class="p">[</span><span class="n">-Id</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-ChunkSizeKB</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-PreserveLines</span><span class="p">]</span> <span class="p">[</span><span class="n">-ContinueFromLastState</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id29">
<h4>Paramètres<a class="headerlink" href="#id29" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Input</strong> : L’entrée à traiter.</p></li>
<li><p><strong>ScriptBlock</strong> : Le script à exécuter pour chaque segment.</p></li>
<li><p><strong>Id</strong> : Identifiant unique pour sauvegarder l’état de segmentation.</p></li>
<li><p><strong>ChunkSizeKB</strong> : Taille maximale de chaque segment en kilooctets.</p></li>
<li><p><strong>PreserveLines</strong> : Préserve les sauts de ligne lors de la segmentation de texte.</p></li>
<li><p><strong>ContinueFromLastState</strong> : Continue le traitement à partir du dernier état sauvegardé.</p></li>
</ul>
</section>
<section id="id30">
<h4>Valeur de retour<a class="headerlink" href="#id30" title="Link to this heading"></a></h4>
<p>Un tableau contenant les résultats du traitement de chaque segment.</p>
</section>
<section id="id31">
<h4>Exemple<a class="headerlink" href="#id31" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Traiter un texte volumineux</span>
<span class="nv">$text</span> <span class="p">=</span> <span class="s2">&quot;A&quot;</span> <span class="p">*</span> <span class="n">50KB</span>
<span class="nv">$results</span> <span class="p">=</span> <span class="nb">Invoke-WithSegmentation</span> <span class="n">-Input</span> <span class="nv">$text</span> <span class="n">-ScriptBlock</span> <span class="p">{</span>
    <span class="k">param</span><span class="p">(</span><span class="nv">$segment</span><span class="p">)</span>
    <span class="c"># Traiter le segment</span>
    <span class="k">return</span> <span class="s2">&quot;Segment traité: </span><span class="p">$(</span><span class="nv">$segment</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span><span class="s2"> caractères&quot;</span>
<span class="p">}</span> <span class="n">-Id</span> <span class="s2">&quot;text-processing&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>

<span class="c"># Traiter un fichier JSON volumineux et continuer en cas d&#39;interruption</span>
<span class="nv">$results</span> <span class="p">=</span> <span class="nb">Invoke-WithSegmentation</span> <span class="n">-Input</span> <span class="s2">&quot;.\data\large_data.json&quot;</span> <span class="n">-ScriptBlock</span> <span class="p">{</span>
    <span class="k">param</span><span class="p">(</span><span class="nv">$segment</span><span class="p">)</span>
    <span class="c"># Traiter le segment</span>
    <span class="k">return</span> <span class="nv">$segment</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="n">10</span>
<span class="p">}</span> <span class="n">-Id</span> <span class="s2">&quot;json-processing&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span> <span class="n">-ContinueFromLastState</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="integration-avec-d-autres-modules">
<h2>Intégration avec d’autres modules<a class="headerlink" href="#integration-avec-d-autres-modules" title="Link to this heading"></a></h2>
<section id="integration-avec-agent-auto">
<h3>Intégration avec Agent Auto<a class="headerlink" href="#integration-avec-agent-auto" title="Link to this heading"></a></h3>
<p>Le module <code class="docutils literal notranslate"><span class="pre">InputSegmentation</span></code> s’intègre avec Agent Auto via le script <code class="docutils literal notranslate"><span class="pre">Initialize-AgentAutoSegmentation.ps1</span></code> qui configure la segmentation automatique pour Agent Auto.</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Initialiser la segmentation pour Agent Auto</span>
<span class="p">.\</span><span class="n">scripts</span><span class="p">\</span><span class="n">agent-auto</span><span class="p">\</span><span class="nb">Initialize-AgentAutoSegmentation</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Enable</span> <span class="n">-MaxInputSizeKB</span> <span class="n">15</span> <span class="n">-ChunkSizeKB</span> <span class="n">7</span> <span class="n">-PreserveLines</span>

<span class="c"># Utiliser la segmentation avec Agent Auto</span>
<span class="nv">$largeInput</span> <span class="p">=</span> <span class="nb">Get-Content</span> <span class="n">-Path</span> <span class="s2">&quot;.\data\large_file.txt&quot;</span> <span class="n">-Raw</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="p">.\</span><span class="n">scripts</span><span class="p">\</span><span class="n">agent-auto</span><span class="p">\</span><span class="n">Example-AgentAutoSegmentation</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Input</span> <span class="nv">$largeInput</span> <span class="n">-InputType</span> <span class="s2">&quot;Text&quot;</span> <span class="n">-OutputPath</span> <span class="s2">&quot;.\output&quot;</span>
</pre></div>
</div>
</section>
<section id="integration-avec-le-traitement-parallele">
<h3>Intégration avec le traitement parallèle<a class="headerlink" href="#integration-avec-le-traitement-parallele" title="Link to this heading"></a></h3>
<p>Le module <code class="docutils literal notranslate"><span class="pre">InputSegmentation</span></code> peut être combiné avec le traitement parallèle pour une efficacité maximale :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">InputSegmentation</span><span class="p">.</span><span class="n">psm1</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">scripts</span><span class="p">\</span><span class="n">performance</span><span class="p">\</span><span class="nb">Optimize-ParallelExecution</span><span class="p">.</span><span class="n">ps1</span>

<span class="nv">$input</span> <span class="p">=</span> <span class="nb">Get-Content</span> <span class="n">-Path</span> <span class="s2">&quot;.\data\large_file.txt&quot;</span> <span class="n">-Raw</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-Input</span> <span class="n">-Input</span> <span class="nv">$input</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>

<span class="nv">$results</span> <span class="p">=</span> <span class="nb">Optimize-ParallelExecution</span> <span class="n">-Data</span> <span class="nv">$segments</span> <span class="n">-ScriptBlock</span> <span class="p">{</span>
    <span class="k">param</span><span class="p">(</span><span class="nv">$segment</span><span class="p">)</span>
    <span class="c"># Traiter le segment</span>
    <span class="k">return</span> <span class="s2">&quot;Processed: </span><span class="p">$(</span><span class="nv">$segment</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span><span class="s2"> bytes&quot;</span>
<span class="p">}</span> <span class="n">-MaxThreads</span> <span class="n">4</span>
</pre></div>
</div>
</section>
<section id="integration-avec-le-cache-predictif">
<h3>Intégration avec le cache prédictif<a class="headerlink" href="#integration-avec-le-cache-predictif" title="Link to this heading"></a></h3>
<p>Le module <code class="docutils literal notranslate"><span class="pre">InputSegmentation</span></code> peut être combiné avec le cache prédictif pour éviter de recalculer les segments :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">InputSegmentation</span><span class="p">.</span><span class="n">psm1</span>
<span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">PredictiveCache</span><span class="p">.</span><span class="n">psm1</span>

<span class="nb">Initialize-PredictiveCache</span> <span class="n">-Enabled</span> <span class="nv">$true</span> <span class="n">-CachePath</span> <span class="s2">&quot;.\cache&quot;</span> <span class="n">-ModelPath</span> <span class="s2">&quot;.\models&quot;</span> <span class="n">-MaxCacheSize</span> <span class="n">100MB</span> <span class="n">-DefaultTTL</span> <span class="n">3600</span>

<span class="nv">$input</span> <span class="p">=</span> <span class="nb">Get-Content</span> <span class="n">-Path</span> <span class="s2">&quot;.\data\large_file.txt&quot;</span> <span class="n">-Raw</span>
<span class="nv">$inputHash</span> <span class="p">=</span> <span class="no">[System.Security.Cryptography.SHA256]</span><span class="p">::</span><span class="n">Create</span><span class="p">().</span><span class="n">ComputeHash</span><span class="p">(</span><span class="no">[System.Text.Encoding]</span><span class="p">::</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="nv">$input</span><span class="p">))</span>
<span class="nv">$cacheKey</span> <span class="p">=</span> <span class="no">[System.BitConverter]</span><span class="p">::</span><span class="n">ToString</span><span class="p">(</span><span class="nv">$inputHash</span><span class="p">).</span><span class="n">Replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Get-PredictiveCache</span> <span class="n">-Key</span> <span class="nv">$cacheKey</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$segments</span> <span class="o">-eq</span> <span class="nv">$null</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-Input</span> <span class="n">-Input</span> <span class="nv">$input</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>
    <span class="nb">Set-PredictiveCache</span> <span class="n">-Key</span> <span class="nv">$cacheKey</span> <span class="n">-Value</span> <span class="nv">$segments</span>
<span class="p">}</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$segment</span> <span class="k">in</span> <span class="nv">$segments</span><span class="p">)</span> <span class="p">{</span>
    <span class="c"># Traiter le segment</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="integration-avec-les-segmenteurs-de-formats">
<h3>Intégration avec les segmenteurs de formats<a class="headerlink" href="#integration-avec-les-segmenteurs-de-formats" title="Link to this heading"></a></h3>
<p>Le module <code class="docutils literal notranslate"><span class="pre">InputSegmentation</span></code> peut être étendu avec des segmenteurs spécifiques à certains formats via le module <code class="docutils literal notranslate"><span class="pre">FormatSegmentation</span></code> :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">InputSegmentation</span><span class="p">.</span><span class="n">psm1</span>
<span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">FormatSegmentation</span><span class="p">.</span><span class="n">psm1</span>

<span class="c"># Segmenter un document XML avec préservation de la structure</span>
<span class="nv">$xmlFile</span> <span class="p">=</span> <span class="s2">&quot;.\data\large_document.xml&quot;</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-FormatAwareInput</span> <span class="n">-Input</span> <span class="nv">$xmlFile</span> <span class="n">-Format</span> <span class="s2">&quot;XML&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span> <span class="n">-PreserveStructure</span> <span class="n">-XPathExpression</span> <span class="s2">&quot;//items/item&quot;</span>

<span class="c"># Segmenter un document JSON avec préservation de la structure</span>
<span class="nv">$jsonFile</span> <span class="p">=</span> <span class="s2">&quot;.\data\large_data.json&quot;</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-FormatAwareInput</span> <span class="n">-Input</span> <span class="nv">$jsonFile</span> <span class="n">-Format</span> <span class="s2">&quot;JSON&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span> <span class="n">-PreserveStructure</span>

<span class="c"># Traiter un document avec segmentation automatique selon le format</span>
<span class="nv">$results</span> <span class="p">=</span> <span class="nb">Invoke-WithFormatSegmentation</span> <span class="n">-Input</span> <span class="nv">$largeDocument</span> <span class="n">-Format</span> <span class="s2">&quot;AUTO&quot;</span> <span class="n">-ScriptBlock</span> <span class="p">{</span>
    <span class="k">param</span><span class="p">(</span><span class="nv">$segment</span><span class="p">)</span>
    <span class="c"># Traiter le segment</span>
    <span class="k">return</span> <span class="s2">&quot;Segment traité&quot;</span>
<span class="p">}</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span> <span class="n">-PreserveStructure</span>
</pre></div>
</div>
</section>
</section>
<section id="bonnes-pratiques">
<h2>Bonnes pratiques<a class="headerlink" href="#bonnes-pratiques" title="Link to this heading"></a></h2>
<section id="pour-une-segmentation-efficace">
<h3>Pour une segmentation efficace<a class="headerlink" href="#pour-une-segmentation-efficace" title="Link to this heading"></a></h3>
<ol class="simple">
<li><p><strong>Choisissez la bonne taille de segment</strong> : Une taille trop petite augmente le nombre de segments et le temps de traitement, tandis qu’une taille trop grande peut dépasser les limites des outils utilisés.</p></li>
<li><p><strong>Préservez la structure des données</strong> : Utilisez l’option <code class="docutils literal notranslate"><span class="pre">-PreserveLines</span></code> pour les fichiers texte et CSV, et les segmenteurs de formats spécifiques pour les documents XML et JSON.</p></li>
<li><p><strong>Utilisez des identifiants uniques</strong> : Lorsque vous utilisez <code class="docutils literal notranslate"><span class="pre">Invoke-WithSegmentation</span></code>, fournissez un identifiant unique pour pouvoir reprendre le traitement en cas d’interruption.</p></li>
<li><p><strong>Combinez avec d’autres optimisations</strong> : Utilisez le traitement parallèle et le cache prédictif pour améliorer les performances.</p></li>
<li><p><strong>Gérez les erreurs</strong> : Utilisez des blocs try/catch pour gérer les erreurs lors du traitement des segments et sauvegarder l’état pour une reprise ultérieure.</p></li>
</ol>
</section>
</section>
<section id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Link to this heading"></a></h2>
<ol class="simple">
<li><p><strong>Segmentation de JSON complexes</strong> : La segmentation d’objets JSON très imbriqués peut ne pas préserver parfaitement la structure.</p></li>
<li><p><strong>Taille maximale des segments</strong> : La taille maximale des segments est limitée par la mémoire disponible.</p></li>
<li><p><strong>Performances avec de très grands fichiers</strong> : Le traitement de fichiers très volumineux (plusieurs Go) peut être lent et consommer beaucoup de mémoire.</p></li>
</ol>
</section>
<section id="exemples-d-utilisation">
<h2>Exemples d’utilisation<a class="headerlink" href="#exemples-d-utilisation" title="Link to this heading"></a></h2>
<section id="exemple-1-traiter-un-fichier-csv-volumineux">
<h3>Exemple 1 : Traiter un fichier CSV volumineux<a class="headerlink" href="#exemple-1-traiter-un-fichier-csv-volumineux" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">InputSegmentation</span><span class="p">.</span><span class="n">psm1</span>
<span class="nb">Initialize-InputSegmentation</span> <span class="n">-MaxInputSizeKB</span> <span class="n">100</span> <span class="n">-DefaultChunkSizeKB</span> <span class="n">50</span>

<span class="nv">$csvFile</span> <span class="p">=</span> <span class="s2">&quot;.\data\large_data.csv&quot;</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-FileInput</span> <span class="n">-FilePath</span> <span class="nv">$csvFile</span> <span class="n">-ChunkSizeKB</span> <span class="n">50</span> <span class="n">-PreserveLines</span>

<span class="nv">$results</span> <span class="p">=</span> <span class="p">@()</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$segment</span> <span class="k">in</span> <span class="nv">$segments</span><span class="p">)</span> <span class="p">{</span>
    <span class="c"># Convertir le segment en objet CSV</span>
    <span class="nv">$csvData</span> <span class="p">=</span> <span class="nv">$segment</span> <span class="p">|</span> <span class="nb">ConvertFrom-Csv</span>
    
    <span class="c"># Traiter les données CSV</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$row</span> <span class="k">in</span> <span class="nv">$csvData</span><span class="p">)</span> <span class="p">{</span>
        <span class="c"># Traitement...</span>
        <span class="nv">$results</span> <span class="p">+=</span> <span class="nv">$row</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre total de lignes traitées: </span><span class="p">$(</span><span class="nv">$results</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
<section id="exemple-2-appels-api-par-lots">
<h3>Exemple 2 : Appels API par lots<a class="headerlink" href="#exemple-2-appels-api-par-lots" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">InputSegmentation</span><span class="p">.</span><span class="n">psm1</span>
<span class="nb">Initialize-InputSegmentation</span> <span class="n">-MaxInputSizeKB</span> <span class="n">50</span> <span class="n">-DefaultChunkSizeKB</span> <span class="n">10</span>

<span class="nv">$data</span> <span class="p">=</span> <span class="nb">Get-Content</span> <span class="n">-Path</span> <span class="s2">&quot;.\data\api_requests.json&quot;</span> <span class="n">-Raw</span> <span class="p">|</span> <span class="nb">ConvertFrom-Json</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-JsonInput</span> <span class="n">-JsonObject</span> <span class="nv">$data</span> <span class="n">-ChunkSizeKB</span> <span class="n">10</span>

<span class="nv">$responses</span> <span class="p">=</span> <span class="p">@()</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$segment</span> <span class="k">in</span> <span class="nv">$segments</span><span class="p">)</span> <span class="p">{</span>
    <span class="c"># Convertir le segment en JSON</span>
    <span class="nv">$jsonData</span> <span class="p">=</span> <span class="nv">$segment</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="n">10</span>
    
    <span class="c"># Appeler l&#39;API</span>
    <span class="nv">$response</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="s2">&quot;https://api.example.com/data&quot;</span> <span class="n">-Method</span> <span class="n">Post</span> <span class="n">-Body</span> <span class="nv">$jsonData</span> <span class="n">-ContentType</span> <span class="s2">&quot;application/json&quot;</span>
    <span class="nv">$responses</span> <span class="p">+=</span> <span class="nv">$response</span>
<span class="p">}</span>

<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de requêtes API: </span><span class="p">$(</span><span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Réponses reçues: </span><span class="p">$(</span><span class="nv">$responses</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
<section id="exemple-3-traitement-parallele-de-fichiers-volumineux">
<h3>Exemple 3 : Traitement parallèle de fichiers volumineux<a class="headerlink" href="#exemple-3-traitement-parallele-de-fichiers-volumineux" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">modules</span><span class="p">\</span><span class="n">InputSegmentation</span><span class="p">.</span><span class="n">psm1</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">scripts</span><span class="p">\</span><span class="n">performance</span><span class="p">\</span><span class="nb">Optimize-ParallelExecution</span><span class="p">.</span><span class="n">ps1</span>

<span class="nv">$files</span> <span class="p">=</span> <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="s2">&quot;.\data&quot;</span> <span class="n">-Filter</span> <span class="s2">&quot;*.log&quot;</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Length</span> <span class="o">-gt</span> <span class="n">10MB</span> <span class="p">}</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$file</span> <span class="k">in</span> <span class="nv">$files</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Traitement du fichier: </span><span class="p">$(</span><span class="nv">$file</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="s2">&quot;</span>
    
    <span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-FileInput</span> <span class="n">-FilePath</span> <span class="nv">$file</span><span class="p">.</span><span class="n">FullName</span> <span class="n">-ChunkSizeKB</span> <span class="n">500</span> <span class="n">-PreserveLines</span>
    
    <span class="nv">$results</span> <span class="p">=</span> <span class="nb">Optimize-ParallelExecution</span> <span class="n">-Data</span> <span class="nv">$segments</span> <span class="n">-ScriptBlock</span> <span class="p">{</span>
        <span class="k">param</span><span class="p">(</span><span class="nv">$segment</span><span class="p">)</span>
        
        <span class="c"># Analyser le segment pour trouver des erreurs</span>
        <span class="nv">$errorLines</span> <span class="p">=</span> <span class="nv">$segment</span> <span class="n">-split</span> <span class="s2">&quot;</span><span class="se">`n</span><span class="s2">&quot;</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span> <span class="o">-match</span> <span class="s2">&quot;ERROR&quot;</span> <span class="p">}</span>
        
        <span class="k">return</span> <span class="nv">$errorLines</span>
    <span class="p">}</span> <span class="n">-MaxThreads</span> <span class="n">4</span>
    
    <span class="nv">$errorCount</span> <span class="p">=</span> <span class="p">(</span><span class="nv">$results</span> <span class="p">|</span> <span class="nb">Measure-Object</span><span class="p">).</span><span class="n">Count</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Nombre d&#39;erreurs trouvées: $errorCount&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="auteur">
<h2>Auteur<a class="headerlink" href="#auteur" title="Link to this heading"></a></h2>
<p>EMAIL_SENDER_1 Team</p>
</section>
<section id="version">
<h2>Version<a class="headerlink" href="#version" title="Link to this heading"></a></h2>
<p>1.0.0</p>
</section>
<section id="date-de-creation">
<h2>Date de création<a class="headerlink" href="#date-de-creation" title="Link to this heading"></a></h2>
<p>2025-04-17</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, EMAIL_SENDER_1 Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>