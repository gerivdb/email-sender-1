

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Documentation technique du module MCPClient &mdash; EMAIL_SENDER_1 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            EMAIL_SENDER_1
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contenu:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Documentation des API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EMAIL_SENDER_1</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Documentation technique du module MCPClient</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/technical/MCPClientAPI.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="documentation-technique-du-module-mcpclient">
<h1>Documentation technique du module MCPClient<a class="headerlink" href="#documentation-technique-du-module-mcpclient" title="Link to this heading"></a></h1>
<section id="vue-d-ensemble">
<h2>Vue d’ensemble<a class="headerlink" href="#vue-d-ensemble" title="Link to this heading"></a></h2>
<p>Le module <code class="docutils literal notranslate"><span class="pre">MCPClient</span></code> est un client PowerShell pour le protocole MCP (Model Context Protocol). Il permet d’interagir avec un serveur MCP pour exécuter des outils et récupérer des informations.</p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h2>
<p>Le module <code class="docutils literal notranslate"><span class="pre">MCPClient</span></code> est inclus dans le projet EMAIL_SENDER_1. Pour l’utiliser, il suffit de l’importer :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Import-Module</span> <span class="n">-Name</span> <span class="s2">&quot;.\modules\MCPClient.psm1&quot;</span>
</pre></div>
</div>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Link to this heading"></a></h2>
<section id="initialize-mcpconnection">
<h3>Initialize-MCPConnection<a class="headerlink" href="#initialize-mcpconnection" title="Link to this heading"></a></h3>
<p>Initialise la connexion à un serveur MCP.</p>
<section id="syntaxe">
<h4>Syntaxe<a class="headerlink" href="#syntaxe" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Initialize-MCPConnection</span> <span class="p">[</span><span class="n">-ServerUrl</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">&gt;</span> <span class="p">[[</span><span class="n">-Timeout</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">int</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-RetryCount</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">int</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-RetryDelay</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">int</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-LogEnabled</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">bool</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-LogLevel</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-LogPath</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">&gt;]</span> <span class="p">[&lt;</span><span class="n">CommonParameters</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="parametres">
<h4>Paramètres<a class="headerlink" href="#parametres" title="Link to this heading"></a></h4>
<table border="1" class="docutils">
<thead>
<tr>
<th>Nom</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ServerUrl</td>
<td>string</td>
<td>L'URL du serveur MCP.</td>
</tr>
<tr>
<td>Timeout</td>
<td>int</td>
<td>Le délai d'attente en secondes pour les requêtes HTTP. Par défaut : 30.</td>
</tr>
<tr>
<td>RetryCount</td>
<td>int</td>
<td>Le nombre de tentatives en cas d'échec. Par défaut : 3.</td>
</tr>
<tr>
<td>RetryDelay</td>
<td>int</td>
<td>Le délai en secondes entre les tentatives. Par défaut : 2.</td>
</tr>
<tr>
<td>LogEnabled</td>
<td>bool</td>
<td>Indique si la journalisation est activée. Par défaut : $true.</td>
</tr>
<tr>
<td>LogLevel</td>
<td>string</td>
<td>Le niveau de journalisation (DEBUG, INFO, WARNING, ERROR). Par défaut : INFO.</td>
</tr>
<tr>
<td>LogPath</td>
<td>string</td>
<td>Le chemin du fichier de log. Par défaut : %TEMP%\MCPClient.log.</td>
</tr>
</tbody>
</table></section>
</section>
<section id="set-mcpclientconfiguration">
<h3>Set-MCPClientConfiguration<a class="headerlink" href="#set-mcpclientconfiguration" title="Link to this heading"></a></h3>
<p>Configure le module MCPClient avec des options avancées de performance.</p>
<section id="id1">
<h4>Syntaxe<a class="headerlink" href="#id1" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Set-MCPClientConfiguration</span> <span class="p">[[</span><span class="n">-Timeout</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">int</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-RetryCount</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">int</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-RetryDelay</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">int</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-LogEnabled</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">bool</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-LogLevel</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-LogPath</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-CacheEnabled</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">bool</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-CacheTTL</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">int</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-MaxConcurrentRequests</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">int</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-BatchSize</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">int</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-CompressionEnabled</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">bool</span><span class="p">&gt;]</span> <span class="p">[&lt;</span><span class="n">CommonParameters</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id2">
<h4>Paramètres<a class="headerlink" href="#id2" title="Link to this heading"></a></h4>
<table border="1" class="docutils">
<thead>
<tr>
<th>Nom</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Timeout</td>
<td>int</td>
<td>Le délai d'attente en secondes pour les requêtes HTTP.</td>
</tr>
<tr>
<td>RetryCount</td>
<td>int</td>
<td>Le nombre de tentatives en cas d'échec.</td>
</tr>
<tr>
<td>RetryDelay</td>
<td>int</td>
<td>Le délai en secondes entre les tentatives.</td>
</tr>
<tr>
<td>LogEnabled</td>
<td>bool</td>
<td>Indique si la journalisation est activée.</td>
</tr>
<tr>
<td>LogLevel</td>
<td>string</td>
<td>Le niveau de journalisation (DEBUG, INFO, WARNING, ERROR).</td>
</tr>
<tr>
<td>LogPath</td>
<td>string</td>
<td>Le chemin du fichier de log.</td>
</tr>
<tr>
<td>CacheEnabled</td>
<td>bool</td>
<td>Indique si le cache est activé. Par défaut : $true.</td>
</tr>
<tr>
<td>CacheTTL</td>
<td>int</td>
<td>Durée de vie du cache en secondes. Par défaut : 300 (5 minutes).</td>
</tr>
<tr>
<td>MaxConcurrentRequests</td>
<td>int</td>
<td>Nombre maximum de requêtes simultanées. Par défaut : 5.</td>
</tr>
<tr>
<td>BatchSize</td>
<td>int</td>
<td>Taille des lots pour le traitement par lots. Par défaut : 10.</td>
</tr>
<tr>
<td>CompressionEnabled</td>
<td>bool</td>
<td>Indique si la compression des données est activée. Par défaut : $true.</td>
</tr>
</tbody>
</table></section>
<section id="valeur-de-retour">
<h4>Valeur de retour<a class="headerlink" href="#valeur-de-retour" title="Link to this heading"></a></h4>
<p>Retourne $true si la connexion est établie avec succès, $false sinon.</p>
</section>
<section id="exemples">
<h4>Exemples<a class="headerlink" href="#exemples" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Initialiser la connexion au serveur MCP local sur le port 8000</span>
<span class="nb">Initialize-MCPConnection</span> <span class="n">-ServerUrl</span> <span class="s2">&quot;http://localhost:8000&quot;</span>

<span class="c"># Initialiser la connexion avec un délai d&#39;attente de 60 secondes et 5 tentatives en cas d&#39;échec</span>
<span class="nb">Initialize-MCPConnection</span> <span class="n">-ServerUrl</span> <span class="s2">&quot;http://localhost:8000&quot;</span> <span class="n">-Timeout</span> <span class="n">60</span> <span class="n">-RetryCount</span> <span class="n">5</span>
</pre></div>
</div>
</section>
</section>
<section id="get-mcptools">
<h3>Get-MCPTools<a class="headerlink" href="#get-mcptools" title="Link to this heading"></a></h3>
<p>Récupère la liste des outils disponibles sur le serveur MCP.</p>
<section id="id3">
<h4>Syntaxe<a class="headerlink" href="#id3" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Get-MCPTools</span> <span class="p">[[</span><span class="n">-NoCache</span><span class="p">]]</span> <span class="p">[[</span><span class="n">-ForceRefresh</span><span class="p">]]</span> <span class="p">[&lt;</span><span class="n">CommonParameters</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id4">
<h4>Paramètres<a class="headerlink" href="#id4" title="Link to this heading"></a></h4>
<table border="1" class="docutils">
<thead>
<tr>
<th>Nom</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>NoCache</td>
<td>switch</td>
<td>Indique de ne pas utiliser le cache pour cette requête.</td>
</tr>
<tr>
<td>ForceRefresh</td>
<td>switch</td>
<td>Force le rafraîchissement du cache même si l'entrée n'est pas expirée.</td>
</tr>
</tbody>
</table></section>
<section id="id5">
<h4>Valeur de retour<a class="headerlink" href="#id5" title="Link to this heading"></a></h4>
<p>Retourne un tableau d’objets représentant les outils disponibles sur le serveur MCP.</p>
</section>
<section id="id6">
<h4>Exemples<a class="headerlink" href="#id6" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Récupérer la liste des outils disponibles</span>
<span class="nv">$tools</span> <span class="p">=</span> <span class="nb">Get-MCPTools</span>
<span class="nv">$tools</span> <span class="p">|</span> <span class="nb">Format-Table</span> <span class="n">-Property</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span>
</pre></div>
</div>
</section>
</section>
<section id="invoke-mcptool">
<h3>Invoke-MCPTool<a class="headerlink" href="#invoke-mcptool" title="Link to this heading"></a></h3>
<p>Exécute un outil sur le serveur MCP.</p>
<section id="id7">
<h4>Syntaxe<a class="headerlink" href="#id7" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-MCPTool</span> <span class="p">[</span><span class="n">-ToolName</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">&gt;</span> <span class="p">[[</span><span class="n">-Parameters</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">hashtable</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-NoCache</span><span class="p">]]</span> <span class="p">[[</span><span class="n">-ForceRefresh</span><span class="p">]]</span> <span class="p">[&lt;</span><span class="n">CommonParameters</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id8">
<h4>Paramètres<a class="headerlink" href="#id8" title="Link to this heading"></a></h4>
<table border="1" class="docutils">
<thead>
<tr>
<th>Nom</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ToolName</td>
<td>string</td>
<td>Le nom de l'outil à exécuter.</td>
</tr>
<tr>
<td>Parameters</td>
<td>hashtable</td>
<td>Les paramètres à passer à l'outil.</td>
</tr>
<tr>
<td>NoCache</td>
<td>switch</td>
<td>Indique de ne pas utiliser le cache pour cette requête.</td>
</tr>
<tr>
<td>ForceRefresh</td>
<td>switch</td>
<td>Force le rafraîchissement du cache même si l'entrée n'est pas expirée.</td>
</tr>
</tbody>
</table></section>
<section id="id9">
<h4>Valeur de retour<a class="headerlink" href="#id9" title="Link to this heading"></a></h4>
<p>Retourne le résultat de l’exécution de l’outil.</p>
</section>
<section id="id10">
<h4>Exemples<a class="headerlink" href="#id10" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Exécuter l&#39;outil &quot;add&quot; avec les paramètres a=2 et b=3</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="nb">Invoke-MCPTool</span> <span class="n">-ToolName</span> <span class="s2">&quot;add&quot;</span> <span class="n">-Parameters</span> <span class="p">@{</span> <span class="n">a</span> <span class="p">=</span> <span class="n">2</span><span class="p">;</span> <span class="n">b</span> <span class="p">=</span> <span class="n">3</span> <span class="p">}</span>
<span class="nv">$result</span><span class="p">.</span><span class="n">result</span> <span class="c"># Affiche 5</span>
</pre></div>
</div>
</section>
</section>
<section id="invoke-mcppowershell">
<h3>Invoke-MCPPowerShell<a class="headerlink" href="#invoke-mcppowershell" title="Link to this heading"></a></h3>
<p>Exécute une commande PowerShell via le serveur MCP.</p>
<section id="id11">
<h4>Syntaxe<a class="headerlink" href="#id11" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-MCPPowerShell</span> <span class="p">[</span><span class="n">-Command</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">&gt;</span> <span class="p">[&lt;</span><span class="n">CommonParameters</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id12">
<h4>Paramètres<a class="headerlink" href="#id12" title="Link to this heading"></a></h4>
<table border="1" class="docutils">
<thead>
<tr>
<th>Nom</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command</td>
<td>string</td>
<td>La commande PowerShell à exécuter.</td>
</tr>
</tbody>
</table></section>
<section id="id13">
<h4>Valeur de retour<a class="headerlink" href="#id13" title="Link to this heading"></a></h4>
<p>Retourne le résultat de l’exécution de la commande PowerShell.</p>
</section>
<section id="id14">
<h4>Exemples<a class="headerlink" href="#id14" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Exécuter la commande &quot;Get-Process&quot;</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="nb">Invoke-MCPPowerShell</span> <span class="n">-Command</span> <span class="s2">&quot;Get-Process&quot;</span>
<span class="nv">$result</span><span class="p">.</span><span class="n">output</span>
</pre></div>
</div>
</section>
</section>
<section id="get-mcpsysteminfo">
<h3>Get-MCPSystemInfo<a class="headerlink" href="#get-mcpsysteminfo" title="Link to this heading"></a></h3>
<p>Récupère des informations sur le système via le serveur MCP.</p>
<section id="id15">
<h4>Syntaxe<a class="headerlink" href="#id15" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Get-MCPSystemInfo</span> <span class="p">[&lt;</span><span class="n">CommonParameters</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id16">
<h4>Valeur de retour<a class="headerlink" href="#id16" title="Link to this heading"></a></h4>
<p>Retourne un objet contenant des informations sur le système.</p>
</section>
<section id="id17">
<h4>Exemples<a class="headerlink" href="#id17" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Récupérer des informations sur le système</span>
<span class="nv">$systemInfo</span> <span class="p">=</span> <span class="nb">Get-MCPSystemInfo</span>
<span class="nv">$systemInfo</span><span class="p">.</span><span class="n">os</span>
<span class="nv">$systemInfo</span><span class="p">.</span><span class="n">version</span>
<span class="nv">$systemInfo</span><span class="p">.</span><span class="n">hostname</span>
</pre></div>
</div>
</section>
</section>
<section id="find-mcpservers">
<h3>Find-MCPServers<a class="headerlink" href="#find-mcpservers" title="Link to this heading"></a></h3>
<p>Détecte les serveurs MCP disponibles.</p>
<section id="id18">
<h4>Syntaxe<a class="headerlink" href="#id18" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Find-MCPServers</span> <span class="p">[[</span><span class="n">-Scan</span><span class="p">]]</span> <span class="p">[&lt;</span><span class="n">CommonParameters</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id19">
<h4>Paramètres<a class="headerlink" href="#id19" title="Link to this heading"></a></h4>
<table border="1" class="docutils">
<thead>
<tr>
<th>Nom</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Scan</td>
<td>switch</td>
<td>Indique si un scan complet du réseau doit être effectué.</td>
</tr>
</tbody>
</table></section>
<section id="id20">
<h4>Valeur de retour<a class="headerlink" href="#id20" title="Link to this heading"></a></h4>
<p>Retourne un objet contenant la liste des serveurs MCP disponibles.</p>
</section>
<section id="id21">
<h4>Exemples<a class="headerlink" href="#id21" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Détecter les serveurs MCP disponibles</span>
<span class="nv">$servers</span> <span class="p">=</span> <span class="nb">Find-MCPServers</span>
<span class="nv">$servers</span><span class="p">.</span><span class="n">servers</span> <span class="p">|</span> <span class="nb">Format-Table</span> <span class="n">-Property</span> <span class="n">url</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">status</span>

<span class="c"># Effectuer un scan complet du réseau</span>
<span class="nv">$servers</span> <span class="p">=</span> <span class="nb">Find-MCPServers</span> <span class="n">-Scan</span>
<span class="nv">$servers</span><span class="p">.</span><span class="n">servers</span> <span class="p">|</span> <span class="nb">Format-Table</span> <span class="n">-Property</span> <span class="n">url</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">status</span>
</pre></div>
</div>
</section>
</section>
<section id="invoke-mcppython">
<h3>Invoke-MCPPython<a class="headerlink" href="#invoke-mcppython" title="Link to this heading"></a></h3>
<p>Exécute un script Python via le serveur MCP.</p>
<section id="id22">
<h4>Syntaxe<a class="headerlink" href="#id22" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-MCPPython</span> <span class="p">[</span><span class="n">-Script</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">&gt;</span> <span class="p">[[</span><span class="n">-Arguments</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">[]&gt;]</span> <span class="p">[&lt;</span><span class="n">CommonParameters</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id23">
<h4>Paramètres<a class="headerlink" href="#id23" title="Link to this heading"></a></h4>
<table border="1" class="docutils">
<thead>
<tr>
<th>Nom</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Script</td>
<td>string</td>
<td>Le script Python à exécuter.</td>
</tr>
<tr>
<td>Arguments</td>
<td>string[]</td>
<td>Les arguments à passer au script Python.</td>
</tr>
</tbody>
</table></section>
<section id="id24">
<h4>Valeur de retour<a class="headerlink" href="#id24" title="Link to this heading"></a></h4>
<p>Retourne le résultat de l’exécution du script Python.</p>
</section>
<section id="id25">
<h4>Exemples<a class="headerlink" href="#id25" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Exécuter un script Python simple</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="nb">Invoke-MCPPython</span> <span class="n">-Script</span> <span class="s2">&quot;print(&#39;Hello, World!&#39;)&quot;</span>
<span class="nv">$result</span><span class="p">.</span><span class="n">output</span>

<span class="c"># Exécuter un script Python avec des arguments</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="nb">Invoke-MCPPython</span> <span class="n">-Script</span> <span class="s2">&quot;import sys; print(sys.argv[1])&quot;</span> <span class="n">-Arguments</span> <span class="p">@(</span><span class="s2">&quot;Hello&quot;</span><span class="p">)</span>
<span class="nv">$result</span><span class="p">.</span><span class="n">output</span>
</pre></div>
</div>
</section>
</section>
<section id="invoke-mcphttprequest">
<h3>Invoke-MCPHttpRequest<a class="headerlink" href="#invoke-mcphttprequest" title="Link to this heading"></a></h3>
<p>Exécute une requête HTTP via le serveur MCP.</p>
<section id="id26">
<h4>Syntaxe<a class="headerlink" href="#id26" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-MCPHttpRequest</span> <span class="p">[</span><span class="n">-Url</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">&gt;</span> <span class="p">[[</span><span class="n">-Method</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-Headers</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">hashtable</span><span class="p">&gt;]</span> <span class="p">[[</span><span class="n">-Body</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">object</span><span class="p">&gt;]</span> <span class="p">[&lt;</span><span class="n">CommonParameters</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id27">
<h4>Paramètres<a class="headerlink" href="#id27" title="Link to this heading"></a></h4>
<table border="1" class="docutils">
<thead>
<tr>
<th>Nom</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Url</td>
<td>string</td>
<td>L'URL de la requête.</td>
</tr>
<tr>
<td>Method</td>
<td>string</td>
<td>La méthode HTTP (GET, POST, PUT, DELETE). Par défaut : GET.</td>
</tr>
<tr>
<td>Headers</td>
<td>hashtable</td>
<td>Les en-têtes HTTP.</td>
</tr>
<tr>
<td>Body</td>
<td>object</td>
<td>Le corps de la requête.</td>
</tr>
</tbody>
</table></section>
<section id="id28">
<h4>Valeur de retour<a class="headerlink" href="#id28" title="Link to this heading"></a></h4>
<p>Retourne le résultat de la requête HTTP.</p>
</section>
<section id="id29">
<h4>Exemples<a class="headerlink" href="#id29" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Exécuter une requête GET</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="nb">Invoke-MCPHttpRequest</span> <span class="n">-Url</span> <span class="s2">&quot;https://api.example.com/data&quot;</span>
<span class="nv">$result</span><span class="p">.</span><span class="n">body</span>

<span class="c"># Exécuter une requête POST avec un corps JSON</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="nb">Invoke-MCPHttpRequest</span> <span class="n">-Url</span> <span class="s2">&quot;https://api.example.com/data&quot;</span> <span class="n">-Method</span> <span class="s2">&quot;POST&quot;</span> <span class="n">-Body</span> <span class="p">@{</span> <span class="n">name</span> <span class="p">=</span> <span class="s2">&quot;John&quot;</span> <span class="p">}</span>
<span class="nv">$result</span><span class="p">.</span><span class="n">status_code</span>
</pre></div>
</div>
</section>
</section>
<section id="clear-mcpcache">
<h3>Clear-MCPCache<a class="headerlink" href="#clear-mcpcache" title="Link to this heading"></a></h3>
<p>Nettoie le cache du module MCPClient.</p>
<section id="id30">
<h4>Syntaxe<a class="headerlink" href="#id30" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Clear-MCPCache</span> <span class="p">[[</span><span class="n">-Force</span><span class="p">]]</span> <span class="p">[&lt;</span><span class="n">CommonParameters</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id31">
<h4>Paramètres<a class="headerlink" href="#id31" title="Link to this heading"></a></h4>
<table border="1" class="docutils">
<thead>
<tr>
<th>Nom</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Force</td>
<td>switch</td>
<td>Force le vidage complet du cache, même pour les entrées non expirées.</td>
</tr>
</tbody>
</table></section>
<section id="id32">
<h4>Valeur de retour<a class="headerlink" href="#id32" title="Link to this heading"></a></h4>
<p>Retourne $true si le cache a été nettoyé avec succès.</p>
</section>
<section id="id33">
<h4>Exemples<a class="headerlink" href="#id33" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Configurer le module MCPClient</span>
<span class="nb">Set-MCPClientConfiguration</span> <span class="n">-Timeout</span> <span class="n">60</span> <span class="n">-RetryCount</span> <span class="n">5</span> <span class="n">-LogLevel</span> <span class="s2">&quot;DEBUG&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="get-mcpclientconfiguration">
<h3>Get-MCPClientConfiguration<a class="headerlink" href="#get-mcpclientconfiguration" title="Link to this heading"></a></h3>
<p>Récupère la configuration actuelle du module MCPClient.</p>
<section id="id34">
<h4>Syntaxe<a class="headerlink" href="#id34" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Get-MCPClientConfiguration</span> <span class="p">[&lt;</span><span class="n">CommonParameters</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id35">
<h4>Valeur de retour<a class="headerlink" href="#id35" title="Link to this heading"></a></h4>
<p>Retourne un objet contenant la configuration actuelle du module MCPClient.</p>
</section>
<section id="id36">
<h4>Exemples<a class="headerlink" href="#id36" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Récupérer la configuration actuelle</span>
<span class="nv">$config</span> <span class="p">=</span> <span class="nb">Get-MCPClientConfiguration</span>
<span class="nv">$config</span><span class="p">.</span><span class="n">Timeout</span>
<span class="nv">$config</span><span class="p">.</span><span class="n">RetryCount</span>
<span class="nv">$config</span><span class="p">.</span><span class="n">LogLevel</span>
</pre></div>
</div>
</section>
</section>
<section id="fonctions-de-traitement-parallele">
<h3>Fonctions de traitement parallèle<a class="headerlink" href="#fonctions-de-traitement-parallele" title="Link to this heading"></a></h3>
<section id="invoke-mcptoolparallel">
<h4>Invoke-MCPToolParallel<a class="headerlink" href="#invoke-mcptoolparallel" title="Link to this heading"></a></h4>
<p>Exécute plusieurs outils MCP en parallèle.</p>
<section id="id37">
<h5>Syntaxe<a class="headerlink" href="#id37" title="Link to this heading"></a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-MCPToolParallel</span> <span class="p">[</span><span class="n">-ToolNames</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">[]&gt;</span> <span class="p">[[</span><span class="n">-ParametersList</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">hashtable</span><span class="p">[]&gt;]</span> <span class="p">[[</span><span class="n">-ThrottleLimit</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">int</span><span class="p">&gt;]</span> <span class="p">[&lt;</span><span class="n">CommonParameters</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id38">
<h5>Paramètres<a class="headerlink" href="#id38" title="Link to this heading"></a></h5>
<table border="1" class="docutils">
<thead>
<tr>
<th>Nom</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ToolNames</td>
<td>string[]</td>
<td>Les noms des outils à exécuter.</td>
</tr>
<tr>
<td>ParametersList</td>
<td>hashtable[]</td>
<td>Les listes de paramètres à passer aux outils.</td>
</tr>
<tr>
<td>ThrottleLimit</td>
<td>int</td>
<td>Le nombre maximum de requêtes simultanées. Par défaut : 5.</td>
</tr>
</tbody>
</table></section>
<section id="id39">
<h5>Valeur de retour<a class="headerlink" href="#id39" title="Link to this heading"></a></h5>
<p>Retourne un tableau des résultats de l’exécution des outils.</p>
</section>
</section>
<section id="invoke-mcppowershellparallel">
<h4>Invoke-MCPPowerShellParallel<a class="headerlink" href="#invoke-mcppowershellparallel" title="Link to this heading"></a></h4>
<p>Exécute plusieurs commandes PowerShell en parallèle via le serveur MCP.</p>
<section id="id40">
<h5>Syntaxe<a class="headerlink" href="#id40" title="Link to this heading"></a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-MCPPowerShellParallel</span> <span class="p">[</span><span class="n">-Commands</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">[]&gt;</span> <span class="p">[[</span><span class="n">-ThrottleLimit</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">int</span><span class="p">&gt;]</span> <span class="p">[&lt;</span><span class="n">CommonParameters</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id41">
<h5>Paramètres<a class="headerlink" href="#id41" title="Link to this heading"></a></h5>
<table border="1" class="docutils">
<thead>
<tr>
<th>Nom</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Commands</td>
<td>string[]</td>
<td>Les commandes PowerShell à exécuter.</td>
</tr>
<tr>
<td>ThrottleLimit</td>
<td>int</td>
<td>Le nombre maximum de requêtes simultanées. Par défaut : 5.</td>
</tr>
</tbody>
</table></section>
<section id="id42">
<h5>Valeur de retour<a class="headerlink" href="#id42" title="Link to this heading"></a></h5>
<p>Retourne un tableau des résultats de l’exécution des commandes PowerShell.</p>
</section>
</section>
<section id="invoke-mcppythonparallel">
<h4>Invoke-MCPPythonParallel<a class="headerlink" href="#invoke-mcppythonparallel" title="Link to this heading"></a></h4>
<p>Exécute plusieurs scripts Python en parallèle via le serveur MCP.</p>
<section id="id43">
<h5>Syntaxe<a class="headerlink" href="#id43" title="Link to this heading"></a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-MCPPythonParallel</span> <span class="p">[</span><span class="n">-Scripts</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">[]&gt;</span> <span class="p">[[</span><span class="n">-ArgumentsList</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">[][]&gt;]</span> <span class="p">[[</span><span class="n">-ThrottleLimit</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">int</span><span class="p">&gt;]</span> <span class="p">[&lt;</span><span class="n">CommonParameters</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id44">
<h5>Paramètres<a class="headerlink" href="#id44" title="Link to this heading"></a></h5>
<table border="1" class="docutils">
<thead>
<tr>
<th>Nom</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Scripts</td>
<td>string[]</td>
<td>Les scripts Python à exécuter.</td>
</tr>
<tr>
<td>ArgumentsList</td>
<td>string[][]</td>
<td>Les listes d'arguments à passer aux scripts Python.</td>
</tr>
<tr>
<td>ThrottleLimit</td>
<td>int</td>
<td>Le nombre maximum de requêtes simultanées. Par défaut : 5.</td>
</tr>
</tbody>
</table></section>
<section id="id45">
<h5>Valeur de retour<a class="headerlink" href="#id45" title="Link to this heading"></a></h5>
<p>Retourne un tableau des résultats de l’exécution des scripts Python.</p>
</section>
</section>
<section id="invoke-mcphttprequestparallel">
<h4>Invoke-MCPHttpRequestParallel<a class="headerlink" href="#invoke-mcphttprequestparallel" title="Link to this heading"></a></h4>
<p>Exécute plusieurs requêtes HTTP en parallèle via le serveur MCP.</p>
<section id="id46">
<h5>Syntaxe<a class="headerlink" href="#id46" title="Link to this heading"></a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-MCPHttpRequestParallel</span> <span class="p">[</span><span class="n">-Urls</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">[]&gt;</span> <span class="p">[[</span><span class="n">-Methods</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">string</span><span class="p">[]&gt;]</span> <span class="p">[[</span><span class="n">-HeadersList</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">hashtable</span><span class="p">[]&gt;]</span> <span class="p">[[</span><span class="n">-Bodies</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">object</span><span class="p">[]&gt;]</span> <span class="p">[[</span><span class="n">-ThrottleLimit</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">int</span><span class="p">&gt;]</span> <span class="p">[&lt;</span><span class="n">CommonParameters</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id47">
<h5>Paramètres<a class="headerlink" href="#id47" title="Link to this heading"></a></h5>
<table border="1" class="docutils">
<thead>
<tr>
<th>Nom</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Urls</td>
<td>string[]</td>
<td>Les URLs des requêtes.</td>
</tr>
<tr>
<td>Methods</td>
<td>string[]</td>
<td>Les méthodes HTTP (GET, POST, PUT, DELETE).</td>
</tr>
<tr>
<td>HeadersList</td>
<td>hashtable[]</td>
<td>Les listes d'en-têtes HTTP.</td>
</tr>
<tr>
<td>Bodies</td>
<td>object[]</td>
<td>Les corps des requêtes.</td>
</tr>
<tr>
<td>ThrottleLimit</td>
<td>int</td>
<td>Le nombre maximum de requêtes simultanées. Par défaut : 5.</td>
</tr>
</tbody>
</table></section>
<section id="id48">
<h5>Valeur de retour<a class="headerlink" href="#id48" title="Link to this heading"></a></h5>
<p>Retourne un tableau des résultats des requêtes HTTP.</p>
</section>
</section>
<section id="invoke-mcpbatch">
<h4>Invoke-MCPBatch<a class="headerlink" href="#invoke-mcpbatch" title="Link to this heading"></a></h4>
<p>Traite des données par lots.</p>
<section id="id49">
<h5>Syntaxe<a class="headerlink" href="#id49" title="Link to this heading"></a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-MCPBatch</span> <span class="p">[</span><span class="n">-ScriptBlock</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">scriptblock</span><span class="p">&gt;</span> <span class="p">[</span><span class="n">-InputObjects</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">object</span><span class="p">[]&gt;</span> <span class="p">[[</span><span class="n">-BatchSize</span><span class="p">]</span> <span class="p">&lt;</span><span class="n">int</span><span class="p">&gt;]</span> <span class="p">[&lt;</span><span class="n">CommonParameters</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id50">
<h5>Paramètres<a class="headerlink" href="#id50" title="Link to this heading"></a></h5>
<table border="1" class="docutils">
<thead>
<tr>
<th>Nom</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ScriptBlock</td>
<td>scriptblock</td>
<td>Le script à exécuter pour chaque lot.</td>
</tr>
<tr>
<td>InputObjects</td>
<td>object[]</td>
<td>Les objets d'entrée à traiter par lots.</td>
</tr>
<tr>
<td>BatchSize</td>
<td>int</td>
<td>La taille des lots. Par défaut : 10.</td>
</tr>
</tbody>
</table></section>
<section id="id51">
<h5>Valeur de retour<a class="headerlink" href="#id51" title="Link to this heading"></a></h5>
<p>Retourne un tableau des résultats du traitement par lots.</p>
</section>
</section>
</section>
</section>
<section id="exemples-d-utilisation">
<h2>Exemples d’utilisation<a class="headerlink" href="#exemples-d-utilisation" title="Link to this heading"></a></h2>
<section id="exemple-1-connexion-a-un-serveur-mcp-et-execution-d-un-outil">
<h3>Exemple 1 : Connexion à un serveur MCP et exécution d’un outil<a class="headerlink" href="#exemple-1-connexion-a-un-serveur-mcp-et-execution-d-un-outil" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Importer le module</span>
<span class="nb">Import-Module</span> <span class="n">-Name</span> <span class="s2">&quot;.\modules\MCPClient.psm1&quot;</span>

<span class="c"># Initialiser la connexion</span>
<span class="nb">Initialize-MCPConnection</span> <span class="n">-ServerUrl</span> <span class="s2">&quot;http://localhost:8000&quot;</span>

<span class="c"># Récupérer la liste des outils disponibles</span>
<span class="nv">$tools</span> <span class="p">=</span> <span class="nb">Get-MCPTools</span>
<span class="nv">$tools</span> <span class="p">|</span> <span class="nb">Format-Table</span> <span class="n">-Property</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span>

<span class="c"># Exécuter l&#39;outil &quot;add&quot;</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="nb">Invoke-MCPTool</span> <span class="n">-ToolName</span> <span class="s2">&quot;add&quot;</span> <span class="n">-Parameters</span> <span class="p">@{</span> <span class="n">a</span> <span class="p">=</span> <span class="n">2</span><span class="p">;</span> <span class="n">b</span> <span class="p">=</span> <span class="n">3</span> <span class="p">}</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Résultat : </span><span class="p">$(</span><span class="nv">$result</span><span class="p">.</span><span class="n">result</span><span class="p">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
<section id="exemple-2-execution-d-une-commande-powershell-via-le-serveur-mcp">
<h3>Exemple 2 : Exécution d’une commande PowerShell via le serveur MCP<a class="headerlink" href="#exemple-2-execution-d-une-commande-powershell-via-le-serveur-mcp" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Importer le module</span>
<span class="nb">Import-Module</span> <span class="n">-Name</span> <span class="s2">&quot;.\modules\MCPClient.psm1&quot;</span>

<span class="c"># Initialiser la connexion</span>
<span class="nb">Initialize-MCPConnection</span> <span class="n">-ServerUrl</span> <span class="s2">&quot;http://localhost:8000&quot;</span>

<span class="c"># Exécuter une commande PowerShell</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="nb">Invoke-MCPPowerShell</span> <span class="n">-Command</span> <span class="s2">&quot;Get-Process | Select-Object -First 5&quot;</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Résultat :&quot;</span>
<span class="nv">$result</span><span class="p">.</span><span class="n">output</span>
</pre></div>
</div>
</section>
<section id="exemple-3-utilisation-du-cache-et-de-la-compression">
<h3>Exemple 3 : Utilisation du cache et de la compression<a class="headerlink" href="#exemple-3-utilisation-du-cache-et-de-la-compression" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Importer le module</span>
<span class="nb">Import-Module</span> <span class="n">-Name</span> <span class="s2">&quot;.\modules\MCPClient.psm1&quot;</span>

<span class="c"># Initialiser la connexion</span>
<span class="nb">Initialize-MCPConnection</span> <span class="n">-ServerUrl</span> <span class="s2">&quot;http://localhost:8000&quot;</span>

<span class="c"># Configurer les options de performance</span>
<span class="nb">Set-MCPClientConfiguration</span> <span class="n">-CacheEnabled</span> <span class="nv">$true</span> <span class="n">-CacheTTL</span> <span class="n">600</span> <span class="n">-CompressionEnabled</span> <span class="nv">$true</span>

<span class="c"># Exécuter un outil avec mise en cache</span>
<span class="nv">$result1</span> <span class="p">=</span> <span class="nb">Invoke-MCPTool</span> <span class="n">-ToolName</span> <span class="s2">&quot;add&quot;</span> <span class="n">-Parameters</span> <span class="p">@{</span> <span class="n">a</span> <span class="p">=</span> <span class="n">2</span><span class="p">;</span> <span class="n">b</span> <span class="p">=</span> <span class="n">3</span> <span class="p">}</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Premier appel (sans cache) : </span><span class="p">$(</span><span class="nv">$result1</span><span class="p">.</span><span class="n">result</span><span class="p">)</span><span class="s2">&quot;</span>

<span class="c"># Exécuter le même outil (récupéré du cache)</span>
<span class="nv">$result2</span> <span class="p">=</span> <span class="nb">Invoke-MCPTool</span> <span class="n">-ToolName</span> <span class="s2">&quot;add&quot;</span> <span class="n">-Parameters</span> <span class="p">@{</span> <span class="n">a</span> <span class="p">=</span> <span class="n">2</span><span class="p">;</span> <span class="n">b</span> <span class="p">=</span> <span class="n">3</span> <span class="p">}</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Deuxième appel (avec cache) : </span><span class="p">$(</span><span class="nv">$result2</span><span class="p">.</span><span class="n">result</span><span class="p">)</span><span class="s2">&quot;</span>

<span class="c"># Forcer le rafraîchissement du cache</span>
<span class="nv">$result3</span> <span class="p">=</span> <span class="nb">Invoke-MCPTool</span> <span class="n">-ToolName</span> <span class="s2">&quot;add&quot;</span> <span class="n">-Parameters</span> <span class="p">@{</span> <span class="n">a</span> <span class="p">=</span> <span class="n">2</span><span class="p">;</span> <span class="n">b</span> <span class="p">=</span> <span class="n">3</span> <span class="p">}</span> <span class="n">-ForceRefresh</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Troisième appel (force refresh) : </span><span class="p">$(</span><span class="nv">$result3</span><span class="p">.</span><span class="n">result</span><span class="p">)</span><span class="s2">&quot;</span>

<span class="c"># Désactiver le cache pour un appel spécifique</span>
<span class="nv">$result4</span> <span class="p">=</span> <span class="nb">Invoke-MCPTool</span> <span class="n">-ToolName</span> <span class="s2">&quot;add&quot;</span> <span class="n">-Parameters</span> <span class="p">@{</span> <span class="n">a</span> <span class="p">=</span> <span class="n">2</span><span class="p">;</span> <span class="n">b</span> <span class="p">=</span> <span class="n">3</span> <span class="p">}</span> <span class="n">-NoCache</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Quatrième appel (sans cache) : </span><span class="p">$(</span><span class="nv">$result4</span><span class="p">.</span><span class="n">result</span><span class="p">)</span><span class="s2">&quot;</span>

<span class="c"># Nettoyer le cache</span>
<span class="nb">Clear-MCPCache</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Cache nettoyé&quot;</span>
</pre></div>
</div>
</section>
<section id="exemple-4-execution-parallele-d-outils-mcp">
<h3>Exemple 4 : Exécution parallèle d’outils MCP<a class="headerlink" href="#exemple-4-execution-parallele-d-outils-mcp" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Importer le module</span>
<span class="nb">Import-Module</span> <span class="n">-Name</span> <span class="s2">&quot;.\modules\MCPClient.psm1&quot;</span>

<span class="c"># Initialiser la connexion</span>
<span class="nb">Initialize-MCPConnection</span> <span class="n">-ServerUrl</span> <span class="s2">&quot;http://localhost:8000&quot;</span>

<span class="c"># Définir les outils à exécuter en parallèle</span>
<span class="nv">$toolNames</span> <span class="p">=</span> <span class="p">@(</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;subtract&quot;</span><span class="p">,</span> <span class="s2">&quot;multiply&quot;</span><span class="p">,</span> <span class="s2">&quot;divide&quot;</span><span class="p">)</span>
<span class="nv">$parametersList</span> <span class="p">=</span> <span class="p">@(</span>
    <span class="p">@{</span> <span class="n">a</span> <span class="p">=</span> <span class="n">10</span><span class="p">;</span> <span class="n">b</span> <span class="p">=</span> <span class="n">5</span> <span class="p">},</span>
    <span class="p">@{</span> <span class="n">a</span> <span class="p">=</span> <span class="n">10</span><span class="p">;</span> <span class="n">b</span> <span class="p">=</span> <span class="n">5</span> <span class="p">},</span>
    <span class="p">@{</span> <span class="n">a</span> <span class="p">=</span> <span class="n">10</span><span class="p">;</span> <span class="n">b</span> <span class="p">=</span> <span class="n">5</span> <span class="p">},</span>
    <span class="p">@{</span> <span class="n">a</span> <span class="p">=</span> <span class="n">10</span><span class="p">;</span> <span class="n">b</span> <span class="p">=</span> <span class="n">5</span> <span class="p">}</span>
<span class="p">)</span>

<span class="c"># Exécuter les outils en parallèle</span>
<span class="nv">$results</span> <span class="p">=</span> <span class="nb">Invoke-MCPToolParallel</span> <span class="n">-ToolNames</span> <span class="nv">$toolNames</span> <span class="n">-ParametersList</span> <span class="nv">$parametersList</span> <span class="n">-ThrottleLimit</span> <span class="n">4</span>

<span class="c"># Afficher les résultats</span>
<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="p">=</span> <span class="n">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">-lt</span> <span class="nv">$results</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;</span><span class="p">$(</span><span class="nv">$toolNames</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span><span class="s2"> : </span><span class="p">$(</span><span class="nv">$results</span><span class="p">[</span><span class="nv">$i</span><span class="p">].</span><span class="n">result</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="exemple-5-traitement-par-lots">
<h3>Exemple 5 : Traitement par lots<a class="headerlink" href="#exemple-5-traitement-par-lots" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Importer le module</span>
<span class="nb">Import-Module</span> <span class="n">-Name</span> <span class="s2">&quot;.\modules\MCPClient.psm1&quot;</span>

<span class="c"># Initialiser la connexion</span>
<span class="nb">Initialize-MCPConnection</span> <span class="n">-ServerUrl</span> <span class="s2">&quot;http://localhost:8000&quot;</span>

<span class="c"># Créer un grand nombre d&#39;objets à traiter</span>
<span class="nv">$inputObjects</span> <span class="p">=</span> <span class="n">1</span><span class="p">..</span><span class="n">100</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">{</span>
    <span class="no">[PSCustomObject]</span><span class="p">@{</span> <span class="n">Value</span> <span class="p">=</span> <span class="nv">$_</span> <span class="p">}</span>
<span class="p">}</span>

<span class="c"># Définir le script block pour traiter chaque lot</span>
<span class="nv">$scriptBlock</span> <span class="p">=</span> <span class="p">{</span>
    <span class="k">param</span><span class="p">(</span><span class="nv">$batch</span><span class="p">)</span>

    <span class="nv">$results</span> <span class="p">=</span> <span class="p">@()</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$item</span> <span class="k">in</span> <span class="nv">$batch</span><span class="p">)</span> <span class="p">{</span>
        <span class="c"># Traiter chaque élément du lot</span>
        <span class="nv">$result</span> <span class="p">=</span> <span class="nb">Invoke-MCPTool</span> <span class="n">-ToolName</span> <span class="s2">&quot;square&quot;</span> <span class="n">-Parameters</span> <span class="p">@{</span> <span class="n">value</span> <span class="p">=</span> <span class="nv">$item</span><span class="p">.</span><span class="n">Value</span> <span class="p">}</span>
        <span class="nv">$results</span> <span class="p">+=</span> <span class="no">[PSCustomObject]</span><span class="p">@{</span>
            <span class="n">Input</span> <span class="p">=</span> <span class="nv">$item</span><span class="p">.</span><span class="n">Value</span>
            <span class="n">Output</span> <span class="p">=</span> <span class="nv">$result</span><span class="p">.</span><span class="n">result</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$results</span>
<span class="p">}</span>

<span class="c"># Traiter les objets par lots</span>
<span class="nv">$results</span> <span class="p">=</span> <span class="nb">Invoke-MCPBatch</span> <span class="n">-ScriptBlock</span> <span class="nv">$scriptBlock</span> <span class="n">-InputObjects</span> <span class="nv">$inputObjects</span> <span class="n">-BatchSize</span> <span class="n">10</span>

<span class="c"># Afficher les résultats</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre total de résultats : </span><span class="p">$(</span><span class="nv">$results</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Premiers résultats :&quot;</span>
<span class="nv">$results</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-First</span> <span class="n">5</span> <span class="p">|</span> <span class="nb">Format-Table</span>
</pre></div>
</div>
</section>
<section id="exemple-6-execution-d-un-script-python-via-le-serveur-mcp">
<h3>Exemple 6 : Exécution d’un script Python via le serveur MCP<a class="headerlink" href="#exemple-6-execution-d-un-script-python-via-le-serveur-mcp" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Importer le module</span>
<span class="nb">Import-Module</span> <span class="n">-Name</span> <span class="s2">&quot;.\modules\MCPClient.psm1&quot;</span>

<span class="c"># Initialiser la connexion</span>
<span class="nb">Initialize-MCPConnection</span> <span class="n">-ServerUrl</span> <span class="s2">&quot;http://localhost:8000&quot;</span>

<span class="c"># Exécuter un script Python</span>
<span class="nv">$script</span> <span class="p">=</span> <span class="sh">@&quot;</span>
<span class="sh">import sys</span>
<span class="sh">import os</span>
<span class="sh">import platform</span>

<span class="sh">print(f&quot;Python version: {platform.python_version()}&quot;)</span>
<span class="sh">print(f&quot;Platform: {platform.platform()}&quot;)</span>
<span class="sh">print(f&quot;Arguments: {sys.argv[1:]}&quot;)</span>
<span class="sh">&quot;@</span>

<span class="nv">$result</span> <span class="p">=</span> <span class="nb">Invoke-MCPPython</span> <span class="n">-Script</span> <span class="nv">$script</span> <span class="n">-Arguments</span> <span class="p">@(</span><span class="s2">&quot;arg1&quot;</span><span class="p">,</span> <span class="s2">&quot;arg2&quot;</span><span class="p">)</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Résultat :&quot;</span>
<span class="nv">$result</span><span class="p">.</span><span class="n">output</span>
</pre></div>
</div>
</section>
</section>
<section id="depannage">
<h2>Dépannage<a class="headerlink" href="#depannage" title="Link to this heading"></a></h2>
<section id="problemes-de-connexion">
<h3>Problèmes de connexion<a class="headerlink" href="#problemes-de-connexion" title="Link to this heading"></a></h3>
<p>Si vous rencontrez des problèmes de connexion au serveur MCP, vérifiez les points suivants :</p>
<ol class="simple">
<li><p>Assurez-vous que le serveur MCP est en cours d’exécution.</p></li>
<li><p>Vérifiez que l’URL du serveur est correcte.</p></li>
<li><p>Vérifiez que le port est accessible (pas bloqué par un pare-feu).</p></li>
<li><p>Augmentez le délai d’attente et le nombre de tentatives :</p></li>
</ol>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Initialize-MCPConnection</span> <span class="n">-ServerUrl</span> <span class="s2">&quot;http://localhost:8000&quot;</span> <span class="n">-Timeout</span> <span class="n">60</span> <span class="n">-RetryCount</span> <span class="n">5</span>
</pre></div>
</div>
</section>
<section id="problemes-d-execution-d-outils">
<h3>Problèmes d’exécution d’outils<a class="headerlink" href="#problemes-d-execution-d-outils" title="Link to this heading"></a></h3>
<p>Si vous rencontrez des problèmes lors de l’exécution d’outils, vérifiez les points suivants :</p>
<ol class="simple">
<li><p>Assurez-vous que l’outil existe sur le serveur MCP :</p></li>
</ol>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$tools</span> <span class="p">=</span> <span class="nb">Get-MCPTools</span>
<span class="nv">$tools</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">name</span> <span class="o">-eq</span> <span class="s2">&quot;nom_de_l_outil&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Vérifiez que les paramètres sont corrects :</p></li>
</ol>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$tool</span> <span class="p">=</span> <span class="nv">$tools</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">name</span> <span class="o">-eq</span> <span class="s2">&quot;nom_de_l_outil&quot;</span> <span class="p">}</span>
<span class="nv">$tool</span><span class="p">.</span><span class="n">parameters</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Activez la journalisation détaillée :</p></li>
</ol>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Set-MCPClientConfiguration</span> <span class="n">-LogLevel</span> <span class="s2">&quot;DEBUG&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="voir-aussi">
<h2>Voir aussi<a class="headerlink" href="#voir-aussi" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/modelcontextprotocol/mcp">Documentation du protocole MCP</a></p></li>
<li><p><a class="reference external" href="./MCPManagerAPI">Documentation du module MCPManager</a></p></li>
<li><p><a class="reference internal" href="../guides/MCPClient_UserGuide.html"><span class="doc">Guide d’utilisation du module MCPClient</span></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, EMAIL_SENDER_1 Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>