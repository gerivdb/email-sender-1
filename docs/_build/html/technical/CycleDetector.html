

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Module de détection de cycles &mdash; EMAIL_SENDER_1 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            EMAIL_SENDER_1
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contenu:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Documentation des API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EMAIL_SENDER_1</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Module de détection de cycles</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/technical/CycleDetector.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-de-detection-de-cycles">
<h1>Module de détection de cycles<a class="headerlink" href="#module-de-detection-de-cycles" title="Link to this heading"></a></h1>
<section id="vue-d-ensemble">
<h2>Vue d’ensemble<a class="headerlink" href="#vue-d-ensemble" title="Link to this heading"></a></h2>
<p>Le module <code class="docutils literal notranslate"><span class="pre">CycleDetector</span></code> fournit des fonctionnalités pour détecter et corriger les cycles dans différents types de graphes, notamment les dépendances de scripts et les workflows n8n. Ce module est essentiel pour prévenir les boucles infinies et les dépendances circulaires qui peuvent causer des problèmes dans les systèmes complexes.</p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h2>
<p>Le module est disponible dans le dossier <code class="docutils literal notranslate"><span class="pre">modules</span></code> du projet. Pour l’importer :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$modulePath</span> <span class="p">=</span> <span class="nb">Join-Path</span> <span class="n">-Path</span> <span class="nv">$PSScriptRoot</span> <span class="n">-ChildPath</span> <span class="s2">&quot;modules\CycleDetector.psm1&quot;</span>
<span class="nb">Import-Module</span> <span class="nv">$modulePath</span> <span class="n">-Force</span>
</pre></div>
</div>
</section>
<section id="fonctions-principales">
<h2>Fonctions principales<a class="headerlink" href="#fonctions-principales" title="Link to this heading"></a></h2>
<section id="detect-cycle">
<h3>Detect-Cycle<a class="headerlink" href="#detect-cycle" title="Link to this heading"></a></h3>
<p>Détecte les cycles dans un graphe générique.</p>
<section id="syntaxe">
<h4>Syntaxe<a class="headerlink" href="#syntaxe" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">Detect-Cycle</span> <span class="n">-Graph</span> <span class="p">&lt;</span><span class="n">Hashtable</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="parametres">
<h4>Paramètres<a class="headerlink" href="#parametres" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Graph</strong> : Une table de hachage représentant le graphe. Les clés sont les nœuds et les valeurs sont des tableaux de nœuds adjacents.</p></li>
</ul>
</section>
<section id="valeur-de-retour">
<h4>Valeur de retour<a class="headerlink" href="#valeur-de-retour" title="Link to this heading"></a></h4>
<p>Un objet avec les propriétés suivantes :</p>
<ul class="simple">
<li><p><strong>HasCycle</strong> : Booléen indiquant si un cycle a été détecté.</p></li>
<li><p><strong>CyclePath</strong> : Tableau des nœuds formant le cycle (si un cycle a été détecté).</p></li>
</ul>
</section>
<section id="exemple">
<h4>Exemple<a class="headerlink" href="#exemple" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$graph</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="s2">&quot;A&quot;</span> <span class="p">=</span> <span class="p">@(</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">)</span>
    <span class="s2">&quot;B&quot;</span> <span class="p">=</span> <span class="p">@(</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
    <span class="s2">&quot;C&quot;</span> <span class="p">=</span> <span class="p">@(</span><span class="s2">&quot;E&quot;</span><span class="p">)</span>
    <span class="s2">&quot;D&quot;</span> <span class="p">=</span> <span class="p">@(</span><span class="s2">&quot;F&quot;</span><span class="p">)</span>
    <span class="s2">&quot;E&quot;</span> <span class="p">=</span> <span class="p">@(</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
    <span class="s2">&quot;F&quot;</span> <span class="p">=</span> <span class="p">@()</span>
<span class="p">}</span>

<span class="nv">$result</span> <span class="p">=</span> <span class="n">Detect-Cycle</span> <span class="n">-Graph</span> <span class="nv">$graph</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="p">.</span><span class="n">HasCycle</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Cycle détecté: </span><span class="p">$(</span><span class="nv">$result</span><span class="p">.</span><span class="n">CyclePath</span> <span class="n">-join</span> <span class="s1">&#39; -&gt; &#39;</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="find-dependencycycles">
<h3>Find-DependencyCycles<a class="headerlink" href="#find-dependencycycles" title="Link to this heading"></a></h3>
<p>Analyse les dépendances entre les scripts PowerShell pour détecter les cycles.</p>
<section id="id1">
<h4>Syntaxe<a class="headerlink" href="#id1" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Find-DependencyCycles</span> <span class="n">-Path</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;</span> <span class="p">[</span><span class="n">-Recursive</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id2">
<h4>Paramètres<a class="headerlink" href="#id2" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Path</strong> : Chemin du dossier ou fichier à analyser.</p></li>
<li><p><strong>Recursive</strong> : Analyse récursivement les sous-dossiers.</p></li>
</ul>
</section>
<section id="id3">
<h4>Valeur de retour<a class="headerlink" href="#id3" title="Link to this heading"></a></h4>
<p>Un objet avec les propriétés suivantes :</p>
<ul class="simple">
<li><p><strong>HasCycles</strong> : Booléen indiquant si des cycles ont été détectés.</p></li>
<li><p><strong>Cycles</strong> : Tableau des cycles détectés.</p></li>
<li><p><strong>DependencyGraph</strong> : Graphe de dépendances complet.</p></li>
<li><p><strong>NonCyclicScripts</strong> : Scripts sans dépendances cycliques.</p></li>
</ul>
</section>
<section id="id4">
<h4>Exemple<a class="headerlink" href="#id4" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$result</span> <span class="p">=</span> <span class="nb">Find-DependencyCycles</span> <span class="n">-Path</span> <span class="s2">&quot;.\scripts&quot;</span> <span class="n">-Recursive</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="p">.</span><span class="n">HasCycles</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$cycle</span> <span class="k">in</span> <span class="nv">$result</span><span class="p">.</span><span class="n">Cycles</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;Cycle de dépendance détecté: </span><span class="p">$(</span><span class="nv">$cycle</span> <span class="n">-join</span> <span class="s1">&#39; -&gt; &#39;</span><span class="p">)</span><span class="s2">&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="test-workflowcycles">
<h3>Test-WorkflowCycles<a class="headerlink" href="#test-workflowcycles" title="Link to this heading"></a></h3>
<p>Analyse les workflows n8n pour détecter les cycles.</p>
<section id="id5">
<h4>Syntaxe<a class="headerlink" href="#id5" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Test-WorkflowCycles</span> <span class="n">-WorkflowPath</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="id6">
<h4>Paramètres<a class="headerlink" href="#id6" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>WorkflowPath</strong> : Chemin du fichier de workflow n8n à analyser.</p></li>
</ul>
</section>
<section id="id7">
<h4>Valeur de retour<a class="headerlink" href="#id7" title="Link to this heading"></a></h4>
<p>Un objet avec les propriétés suivantes :</p>
<ul class="simple">
<li><p><strong>HasCycles</strong> : Booléen indiquant si des cycles ont été détectés.</p></li>
<li><p><strong>Cycles</strong> : Tableau des cycles détectés.</p></li>
<li><p><strong>WorkflowName</strong> : Nom du workflow analysé.</p></li>
</ul>
</section>
<section id="id8">
<h4>Exemple<a class="headerlink" href="#id8" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$result</span> <span class="p">=</span> <span class="nb">Test-WorkflowCycles</span> <span class="n">-WorkflowPath</span> <span class="s2">&quot;.\workflows\my_workflow.json&quot;</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="p">.</span><span class="n">HasCycles</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$cycle</span> <span class="k">in</span> <span class="nv">$result</span><span class="p">.</span><span class="n">Cycles</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;Cycle de workflow détecté: </span><span class="p">$(</span><span class="nv">$cycle</span> <span class="n">-join</span> <span class="s1">&#39; -&gt; &#39;</span><span class="p">)</span><span class="s2">&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="remove-cycle">
<h3>Remove-Cycle<a class="headerlink" href="#remove-cycle" title="Link to this heading"></a></h3>
<p>Supprime un cycle d’un graphe en retirant une arête.</p>
<section id="id9">
<h4>Syntaxe<a class="headerlink" href="#id9" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Remove-Cycle</span> <span class="n">-Graph</span> <span class="p">&lt;</span><span class="n">Hashtable</span><span class="p">&gt;</span> <span class="n">-Cycle</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">[]&gt;</span>
</pre></div>
</div>
</section>
<section id="id10">
<h4>Paramètres<a class="headerlink" href="#id10" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Graph</strong> : Une table de hachage représentant le graphe.</p></li>
<li><p><strong>Cycle</strong> : Tableau des nœuds formant le cycle à supprimer.</p></li>
</ul>
</section>
<section id="id11">
<h4>Valeur de retour<a class="headerlink" href="#id11" title="Link to this heading"></a></h4>
<p>Une table de hachage représentant le graphe modifié sans le cycle.</p>
</section>
<section id="id12">
<h4>Exemple<a class="headerlink" href="#id12" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$graph</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="s2">&quot;A&quot;</span> <span class="p">=</span> <span class="p">@(</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>
    <span class="s2">&quot;B&quot;</span> <span class="p">=</span> <span class="p">@(</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
    <span class="s2">&quot;C&quot;</span> <span class="p">=</span> <span class="p">@(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="nv">$cycle</span> <span class="p">=</span> <span class="p">@(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">)</span>
<span class="nv">$modifiedGraph</span> <span class="p">=</span> <span class="nb">Remove-Cycle</span> <span class="n">-Graph</span> <span class="nv">$graph</span> <span class="n">-Cycle</span> <span class="nv">$cycle</span>

<span class="c"># Vérifier que le cycle a été supprimé</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="n">Detect-Cycle</span> <span class="n">-Graph</span> <span class="nv">$modifiedGraph</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="nv">$result</span><span class="p">.</span><span class="n">HasCycle</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Le cycle a été supprimé avec succès.&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="integration-avec-n8n">
<h2>Intégration avec n8n<a class="headerlink" href="#integration-avec-n8n" title="Link to this heading"></a></h2>
<p>Le module <code class="docutils literal notranslate"><span class="pre">CycleDetector</span></code> s’intègre avec n8n via le script <code class="docutils literal notranslate"><span class="pre">Validate-WorkflowCycles.ps1</span></code> qui permet de valider et corriger automatiquement les cycles dans les workflows n8n.</p>
<section id="exemple-d-utilisation-avec-n8n">
<h3>Exemple d’utilisation avec n8n<a class="headerlink" href="#exemple-d-utilisation-avec-n8n" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Valider un workflow n8n</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="p">&amp;</span> <span class="s2">&quot;.\scripts\n8n\workflow-validation\Validate-WorkflowCycles.ps1&quot;</span> <span class="n">-WorkflowsPath</span> <span class="s2">&quot;.\workflows\my_workflow.json&quot;</span>

<span class="c"># Valider et corriger automatiquement les cycles</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="p">&amp;</span> <span class="s2">&quot;.\scripts\n8n\workflow-validation\Validate-WorkflowCycles.ps1&quot;</span> <span class="n">-WorkflowsPath</span> <span class="s2">&quot;.\workflows\my_workflow.json&quot;</span> <span class="n">-FixCycles</span>
</pre></div>
</div>
</section>
</section>
<section id="algorithmes-utilises">
<h2>Algorithmes utilisés<a class="headerlink" href="#algorithmes-utilises" title="Link to this heading"></a></h2>
<p>Le module utilise l’algorithme de recherche en profondeur (DFS) pour détecter les cycles dans les graphes. Cet algorithme est efficace pour les graphes de taille moyenne à grande.</p>
</section>
<section id="performance">
<h2>Performance<a class="headerlink" href="#performance" title="Link to this heading"></a></h2>
<p>Les performances du module dépendent de la taille et de la complexité des graphes analysés :</p>
<ul class="simple">
<li><p><strong>Petits graphes</strong> (&lt; 100 nœuds) : Temps d’exécution négligeable.</p></li>
<li><p><strong>Graphes moyens</strong> (100-1000 nœuds) : Temps d’exécution de quelques secondes.</p></li>
<li><p><strong>Grands graphes</strong> (&gt; 1000 nœuds) : Temps d’exécution pouvant atteindre plusieurs minutes.</p></li>
</ul>
</section>
<section id="compatibilite">
<h2>Compatibilité<a class="headerlink" href="#compatibilite" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>PowerShell 5.1 et versions ultérieures.</p></li>
<li><p>Compatible avec PowerShell 7.</p></li>
</ul>
</section>
<section id="limitations-connues">
<h2>Limitations connues<a class="headerlink" href="#limitations-connues" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Les graphes très volumineux (&gt; 10 000 nœuds) peuvent entraîner des problèmes de mémoire.</p></li>
<li><p>L’analyse des dépendances de scripts ne détecte que les dépendances explicites (via dot-sourcing).</p></li>
</ul>
</section>
<section id="exemples-avances">
<h2>Exemples avancés<a class="headerlink" href="#exemples-avances" title="Link to this heading"></a></h2>
<section id="analyse-complete-d-un-projet">
<h3>Analyse complète d’un projet<a class="headerlink" href="#analyse-complete-d-un-projet" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Analyser tous les scripts d&#39;un projet</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="nb">Find-DependencyCycles</span> <span class="n">-Path</span> <span class="s2">&quot;.\scripts&quot;</span> <span class="n">-Recursive</span>

<span class="c"># Générer un rapport</span>
<span class="nv">$report</span> <span class="p">=</span> <span class="no">[PSCustomObject]</span><span class="p">@{</span>
    <span class="n">HasCycles</span> <span class="p">=</span> <span class="nv">$result</span><span class="p">.</span><span class="n">HasCycles</span>
    <span class="n">CyclesCount</span> <span class="p">=</span> <span class="nv">$result</span><span class="p">.</span><span class="n">Cycles</span><span class="p">.</span><span class="n">Count</span>
    <span class="n">ScriptsCount</span> <span class="p">=</span> <span class="nv">$result</span><span class="p">.</span><span class="n">DependencyGraph</span><span class="p">.</span><span class="n">Keys</span><span class="p">.</span><span class="n">Count</span>
    <span class="n">NonCyclicScriptsCount</span> <span class="p">=</span> <span class="nv">$result</span><span class="p">.</span><span class="n">NonCyclicScripts</span><span class="p">.</span><span class="n">Count</span>
    <span class="n">Cycles</span> <span class="p">=</span> <span class="nv">$result</span><span class="p">.</span><span class="n">Cycles</span>
<span class="p">}</span>

<span class="nv">$report</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="n">10</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="n">-FilePath</span> <span class="s2">&quot;.\reports\dependency_cycles.json&quot;</span> <span class="n">-Encoding</span> <span class="n">utf8</span>
</pre></div>
</div>
</section>
<section id="validation-de-tous-les-workflows-n8n">
<h3>Validation de tous les workflows n8n<a class="headerlink" href="#validation-de-tous-les-workflows-n8n" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Obtenir tous les workflows n8n</span>
<span class="nv">$workflows</span> <span class="p">=</span> <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="s2">&quot;.\workflows&quot;</span> <span class="n">-Filter</span> <span class="s2">&quot;*.json&quot;</span> <span class="n">-Recurse</span>

<span class="c"># Valider chaque workflow</span>
<span class="nv">$results</span> <span class="p">=</span> <span class="p">@()</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$workflow</span> <span class="k">in</span> <span class="nv">$workflows</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$result</span> <span class="p">=</span> <span class="nb">Test-WorkflowCycles</span> <span class="n">-WorkflowPath</span> <span class="nv">$workflow</span><span class="p">.</span><span class="n">FullName</span>
    <span class="nv">$results</span> <span class="p">+=</span> <span class="no">[PSCustomObject]</span><span class="p">@{</span>
        <span class="n">Path</span> <span class="p">=</span> <span class="nv">$workflow</span><span class="p">.</span><span class="n">FullName</span>
        <span class="n">Name</span> <span class="p">=</span> <span class="nv">$workflow</span><span class="p">.</span><span class="n">BaseName</span>
        <span class="n">HasCycles</span> <span class="p">=</span> <span class="nv">$result</span><span class="p">.</span><span class="n">HasCycles</span>
        <span class="n">CyclesCount</span> <span class="p">=</span> <span class="nv">$result</span><span class="p">.</span><span class="n">Cycles</span><span class="p">.</span><span class="n">Count</span>
        <span class="n">Cycles</span> <span class="p">=</span> <span class="nv">$result</span><span class="p">.</span><span class="n">Cycles</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c"># Générer un rapport</span>
<span class="nv">$report</span> <span class="p">=</span> <span class="no">[PSCustomObject]</span><span class="p">@{</span>
    <span class="n">TotalWorkflows</span> <span class="p">=</span> <span class="nv">$workflows</span><span class="p">.</span><span class="n">Count</span>
    <span class="n">WorkflowsWithCycles</span> <span class="p">=</span> <span class="p">(</span><span class="nv">$results</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">HasCycles</span> <span class="p">}).</span><span class="n">Count</span>
    <span class="n">Results</span> <span class="p">=</span> <span class="nv">$results</span>
<span class="p">}</span>

<span class="nv">$report</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="n">10</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="n">-FilePath</span> <span class="s2">&quot;.\reports\workflow_cycles.json&quot;</span> <span class="n">-Encoding</span> <span class="n">utf8</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, EMAIL_SENDER_1 Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>