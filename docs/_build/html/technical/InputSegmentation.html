

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Module de segmentation d’entrées &mdash; EMAIL_SENDER_1 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            EMAIL_SENDER_1
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contenu:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Documentation des API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EMAIL_SENDER_1</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Module de segmentation d’entrées</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/technical/InputSegmentation.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-de-segmentation-d-entrees">
<h1>Module de segmentation d’entrées<a class="headerlink" href="#module-de-segmentation-d-entrees" title="Link to this heading"></a></h1>
<section id="vue-d-ensemble">
<h2>Vue d’ensemble<a class="headerlink" href="#vue-d-ensemble" title="Link to this heading"></a></h2>
<p>Le module <code class="docutils literal notranslate"><span class="pre">InputSegmentation</span></code> fournit des fonctionnalités pour segmenter automatiquement les entrées volumineuses en morceaux plus petits, évitant ainsi les interruptions dues aux limites de taille d’entrée. Ce module est particulièrement utile pour les interactions avec Agent Auto et d’autres systèmes ayant des contraintes de taille d’entrée.</p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h2>
<p>Le module est disponible dans le dossier <code class="docutils literal notranslate"><span class="pre">modules</span></code> du projet. Pour l’importer :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$modulePath</span> <span class="p">=</span> <span class="nb">Join-Path</span> <span class="n">-Path</span> <span class="nv">$PSScriptRoot</span> <span class="n">-ChildPath</span> <span class="s2">&quot;modules\InputSegmentation.psm1&quot;</span>
<span class="nb">Import-Module</span> <span class="nv">$modulePath</span> <span class="n">-Force</span>
</pre></div>
</div>
</section>
<section id="initialisation">
<h2>Initialisation<a class="headerlink" href="#initialisation" title="Link to this heading"></a></h2>
<p>Avant d’utiliser le module, il est recommandé de l’initialiser avec les paramètres souhaités :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Initialize-InputSegmentation</span> <span class="n">-MaxInputSizeKB</span> <span class="n">15</span> <span class="n">-DefaultChunkSizeKB</span> <span class="n">7</span>
</pre></div>
</div>
</section>
<section id="fonctions-principales">
<h2>Fonctions principales<a class="headerlink" href="#fonctions-principales" title="Link to this heading"></a></h2>
<section id="measure-inputsize">
<h3>Measure-InputSize<a class="headerlink" href="#measure-inputsize" title="Link to this heading"></a></h3>
<p>Mesure la taille d’une entrée en kilooctets.</p>
<section id="syntaxe">
<h4>Syntaxe<a class="headerlink" href="#syntaxe" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Measure-InputSize</span> <span class="n">-Input</span> <span class="p">&lt;</span><span class="n">Object</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="parametres">
<h4>Paramètres<a class="headerlink" href="#parametres" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Input</strong> : L’entrée à mesurer (texte, JSON ou chemin de fichier).</p></li>
</ul>
</section>
<section id="valeur-de-retour">
<h4>Valeur de retour<a class="headerlink" href="#valeur-de-retour" title="Link to this heading"></a></h4>
<p>La taille de l’entrée en kilooctets (KB).</p>
</section>
<section id="exemple">
<h4>Exemple<a class="headerlink" href="#exemple" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$text</span> <span class="p">=</span> <span class="s2">&quot;A&quot;</span> <span class="p">*</span> <span class="n">10KB</span>
<span class="nv">$size</span> <span class="p">=</span> <span class="nb">Measure-InputSize</span> <span class="n">-Input</span> <span class="nv">$text</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Taille de l&#39;entrée: $size KB&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="split-textinput">
<h3>Split-TextInput<a class="headerlink" href="#split-textinput" title="Link to this heading"></a></h3>
<p>Segmente une chaîne de texte en morceaux plus petits.</p>
<section id="id1">
<h4>Syntaxe<a class="headerlink" href="#id1" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Split-TextInput</span> <span class="n">-Text</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;</span> <span class="p">[</span><span class="n">-ChunkSizeKB</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-PreserveLines</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id2">
<h4>Paramètres<a class="headerlink" href="#id2" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Text</strong> : Le texte à segmenter.</p></li>
<li><p><strong>ChunkSizeKB</strong> : Taille maximale de chaque segment en kilooctets.</p></li>
<li><p><strong>PreserveLines</strong> : Préserve les sauts de ligne lors de la segmentation.</p></li>
</ul>
</section>
<section id="id3">
<h4>Valeur de retour<a class="headerlink" href="#id3" title="Link to this heading"></a></h4>
<p>Un tableau de chaînes de texte représentant les segments.</p>
</section>
<section id="id4">
<h4>Exemple<a class="headerlink" href="#id4" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$text</span> <span class="p">=</span> <span class="s2">&quot;A&quot;</span> <span class="p">*</span> <span class="n">20KB</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-TextInput</span> <span class="n">-Text</span> <span class="nv">$text</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span> <span class="n">-PreserveLines</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de segments: </span><span class="p">$(</span><span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="split-jsoninput">
<h3>Split-JsonInput<a class="headerlink" href="#split-jsoninput" title="Link to this heading"></a></h3>
<p>Segmente un objet JSON en morceaux plus petits.</p>
<section id="id5">
<h4>Syntaxe<a class="headerlink" href="#id5" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Split-JsonInput</span> <span class="n">-JsonObject</span> <span class="p">&lt;</span><span class="n">Object</span><span class="p">&gt;</span> <span class="p">[</span><span class="n">-ChunkSizeKB</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span>
</pre></div>
</div>
</section>
<section id="id6">
<h4>Paramètres<a class="headerlink" href="#id6" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>JsonObject</strong> : L’objet JSON à segmenter.</p></li>
<li><p><strong>ChunkSizeKB</strong> : Taille maximale de chaque segment en kilooctets.</p></li>
</ul>
</section>
<section id="id7">
<h4>Valeur de retour<a class="headerlink" href="#id7" title="Link to this heading"></a></h4>
<p>Un tableau d’objets JSON représentant les segments.</p>
</section>
<section id="id8">
<h4>Exemple<a class="headerlink" href="#id8" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$json</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="n">items</span> <span class="p">=</span> <span class="p">@()</span>
<span class="p">}</span>

<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="p">=</span> <span class="n">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">-lt</span> <span class="n">500</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++)</span> <span class="p">{</span>
    <span class="nv">$json</span><span class="p">.</span><span class="n">items</span> <span class="p">+=</span> <span class="p">@{</span>
        <span class="n">id</span> <span class="p">=</span> <span class="nv">$i</span>
        <span class="n">name</span> <span class="p">=</span> <span class="s2">&quot;Item $i&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-JsonInput</span> <span class="n">-JsonObject</span> <span class="nv">$json</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de segments: </span><span class="p">$(</span><span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="split-fileinput">
<h3>Split-FileInput<a class="headerlink" href="#split-fileinput" title="Link to this heading"></a></h3>
<p>Segmente un fichier en morceaux plus petits.</p>
<section id="id9">
<h4>Syntaxe<a class="headerlink" href="#id9" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Split-FileInput</span> <span class="n">-FilePath</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;</span> <span class="p">[</span><span class="n">-ChunkSizeKB</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-PreserveLines</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id10">
<h4>Paramètres<a class="headerlink" href="#id10" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>FilePath</strong> : Chemin du fichier à segmenter.</p></li>
<li><p><strong>ChunkSizeKB</strong> : Taille maximale de chaque segment en kilooctets.</p></li>
<li><p><strong>PreserveLines</strong> : Préserve les sauts de ligne lors de la segmentation.</p></li>
</ul>
</section>
<section id="id11">
<h4>Valeur de retour<a class="headerlink" href="#id11" title="Link to this heading"></a></h4>
<p>Un tableau de chaînes de texte représentant les segments.</p>
</section>
<section id="id12">
<h4>Exemple<a class="headerlink" href="#id12" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-FileInput</span> <span class="n">-FilePath</span> <span class="s2">&quot;.\data\large_file.txt&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span> <span class="n">-PreserveLines</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de segments: </span><span class="p">$(</span><span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="split-input">
<h3>Split-Input<a class="headerlink" href="#split-input" title="Link to this heading"></a></h3>
<p>Fonction générique pour segmenter différents types d’entrées.</p>
<section id="id13">
<h4>Syntaxe<a class="headerlink" href="#id13" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Split-Input</span> <span class="n">-Input</span> <span class="p">&lt;</span><span class="n">Object</span><span class="p">&gt;</span> <span class="p">[</span><span class="n">-ChunkSizeKB</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-PreserveLines</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id14">
<h4>Paramètres<a class="headerlink" href="#id14" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Input</strong> : L’entrée à segmenter (texte, JSON ou chemin de fichier).</p></li>
<li><p><strong>ChunkSizeKB</strong> : Taille maximale de chaque segment en kilooctets.</p></li>
<li><p><strong>PreserveLines</strong> : Préserve les sauts de ligne lors de la segmentation de texte.</p></li>
</ul>
</section>
<section id="id15">
<h4>Valeur de retour<a class="headerlink" href="#id15" title="Link to this heading"></a></h4>
<p>Un tableau d’objets représentant les segments.</p>
</section>
<section id="id16">
<h4>Exemple<a class="headerlink" href="#id16" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$input</span> <span class="p">=</span> <span class="nb">Get-Content</span> <span class="n">-Path</span> <span class="s2">&quot;.\data\large_file.txt&quot;</span> <span class="n">-Raw</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-Input</span> <span class="n">-Input</span> <span class="nv">$input</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de segments: </span><span class="p">$(</span><span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="save-segmentationstate-et-get-segmentationstate">
<h3>Save-SegmentationState et Get-SegmentationState<a class="headerlink" href="#save-segmentationstate-et-get-segmentationstate" title="Link to this heading"></a></h3>
<p>Fonctions pour sauvegarder et récupérer l’état de segmentation, permettant de reprendre le traitement.</p>
<section id="id17">
<h4>Syntaxe<a class="headerlink" href="#id17" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Save-SegmentationState</span> <span class="n">-Id</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;</span> <span class="n">-Segments</span> <span class="p">&lt;</span><span class="n">Array</span><span class="p">&gt;</span> <span class="n">-CurrentIndex</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;</span>
<span class="nv">$state</span> <span class="p">=</span> <span class="nb">Get-SegmentationState</span> <span class="n">-Id</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="id18">
<h4>Paramètres<a class="headerlink" href="#id18" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Id</strong> : Identifiant unique pour l’état de segmentation.</p></li>
<li><p><strong>Segments</strong> : Tableau des segments.</p></li>
<li><p><strong>CurrentIndex</strong> : Index du segment actuel.</p></li>
</ul>
</section>
<section id="id19">
<h4>Exemple<a class="headerlink" href="#id19" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$id</span> <span class="p">=</span> <span class="s2">&quot;my-segmentation-task&quot;</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-Input</span> <span class="n">-Input</span> <span class="nv">$largeInput</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>
<span class="nb">Save-SegmentationState</span> <span class="n">-Id</span> <span class="nv">$id</span> <span class="n">-Segments</span> <span class="nv">$segments</span> <span class="n">-CurrentIndex</span> <span class="n">0</span>

<span class="c"># Plus tard, récupérer l&#39;état</span>
<span class="nv">$state</span> <span class="p">=</span> <span class="nb">Get-SegmentationState</span> <span class="n">-Id</span> <span class="nv">$id</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$state</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$currentIndex</span> <span class="p">=</span> <span class="nv">$state</span><span class="p">.</span><span class="n">CurrentIndex</span>
    <span class="nv">$segments</span> <span class="p">=</span> <span class="nv">$state</span><span class="p">.</span><span class="n">Segments</span>
    
    <span class="c"># Continuer le traitement à partir de l&#39;index actuel</span>
    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="p">=</span> <span class="nv">$currentIndex</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">-lt</span> <span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++)</span> <span class="p">{</span>
        <span class="c"># Traiter le segment</span>
        <span class="k">Process</span><span class="n">-Segment</span> <span class="n">-Segment</span> <span class="nv">$segments</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span>
        
        <span class="c"># Mettre à jour l&#39;état</span>
        <span class="nb">Save-SegmentationState</span> <span class="n">-Id</span> <span class="nv">$id</span> <span class="n">-Segments</span> <span class="nv">$segments</span> <span class="n">-CurrentIndex</span> <span class="p">(</span><span class="nv">$i</span> <span class="p">+</span> <span class="n">1</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="invoke-withsegmentation">
<h3>Invoke-WithSegmentation<a class="headerlink" href="#invoke-withsegmentation" title="Link to this heading"></a></h3>
<p>Exécute un script avec segmentation automatique.</p>
<section id="id20">
<h4>Syntaxe<a class="headerlink" href="#id20" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-WithSegmentation</span> <span class="n">-Input</span> <span class="p">&lt;</span><span class="n">Object</span><span class="p">&gt;</span> <span class="n">-ScriptBlock</span> <span class="p">&lt;</span><span class="n">ScriptBlock</span><span class="p">&gt;</span> <span class="p">[</span><span class="n">-Id</span> <span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-ChunkSizeKB</span> <span class="p">&lt;</span><span class="n">Int32</span><span class="p">&gt;]</span> <span class="p">[</span><span class="n">-PreserveLines</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id21">
<h4>Paramètres<a class="headerlink" href="#id21" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Input</strong> : L’entrée à segmenter.</p></li>
<li><p><strong>ScriptBlock</strong> : Le script à exécuter pour chaque segment.</p></li>
<li><p><strong>Id</strong> : Identifiant unique pour l’état de segmentation.</p></li>
<li><p><strong>ChunkSizeKB</strong> : Taille maximale de chaque segment en kilooctets.</p></li>
<li><p><strong>PreserveLines</strong> : Préserve les sauts de ligne lors de la segmentation de texte.</p></li>
</ul>
</section>
<section id="id22">
<h4>Valeur de retour<a class="headerlink" href="#id22" title="Link to this heading"></a></h4>
<p>Un tableau des résultats de l’exécution du script pour chaque segment.</p>
</section>
<section id="id23">
<h4>Exemple<a class="headerlink" href="#id23" title="Link to this heading"></a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$input</span> <span class="p">=</span> <span class="s2">&quot;A&quot;</span> <span class="p">*</span> <span class="n">20KB</span>
<span class="nv">$results</span> <span class="p">=</span> <span class="nb">Invoke-WithSegmentation</span> <span class="n">-Input</span> <span class="nv">$input</span> <span class="n">-ScriptBlock</span> <span class="p">{</span>
    <span class="k">param</span><span class="p">(</span><span class="nv">$segment</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;Processed: </span><span class="p">$(</span><span class="nv">$segment</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span><span class="s2"> bytes&quot;</span>
<span class="p">}</span> <span class="n">-Id</span> <span class="s2">&quot;my-task&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="integration-avec-agent-auto">
<h2>Intégration avec Agent Auto<a class="headerlink" href="#integration-avec-agent-auto" title="Link to this heading"></a></h2>
<p>Le module <code class="docutils literal notranslate"><span class="pre">InputSegmentation</span></code> s’intègre avec Agent Auto via le script <code class="docutils literal notranslate"><span class="pre">Initialize-AgentAutoSegmentation.ps1</span></code> qui configure la segmentation automatique pour Agent Auto.</p>
<section id="exemple-d-utilisation-avec-agent-auto">
<h3>Exemple d’utilisation avec Agent Auto<a class="headerlink" href="#exemple-d-utilisation-avec-agent-auto" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Initialiser la segmentation pour Agent Auto</span>
<span class="p">&amp;</span> <span class="s2">&quot;.\scripts\agent-auto\Initialize-AgentAutoSegmentation.ps1&quot;</span> <span class="n">-Enable</span> <span class="n">-MaxInputSizeKB</span> <span class="n">15</span> <span class="n">-ChunkSizeKB</span> <span class="n">7</span> <span class="n">-PreserveLines</span>

<span class="c"># Utiliser la segmentation avec Agent Auto</span>
<span class="nv">$largeInput</span> <span class="p">=</span> <span class="nb">Get-Content</span> <span class="n">-Path</span> <span class="s2">&quot;.\data\large_file.txt&quot;</span> <span class="n">-Raw</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="p">&amp;</span> <span class="s2">&quot;.\scripts\agent-auto\Example-AgentAutoSegmentation.ps1&quot;</span> <span class="n">-Input</span> <span class="nv">$largeInput</span> <span class="n">-InputType</span> <span class="s2">&quot;Text&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="performance">
<h2>Performance<a class="headerlink" href="#performance" title="Link to this heading"></a></h2>
<p>Les performances du module dépendent de la taille et du type des entrées :</p>
<ul class="simple">
<li><p><strong>Texte</strong> : Segmentation rapide, même pour de grandes entrées.</p></li>
<li><p><strong>JSON</strong> : La segmentation peut être plus lente pour les objets JSON complexes.</p></li>
<li><p><strong>Fichiers</strong> : La performance dépend de la taille du fichier et des opérations d’E/S.</p></li>
</ul>
</section>
<section id="compatibilite">
<h2>Compatibilité<a class="headerlink" href="#compatibilite" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>PowerShell 5.1 et versions ultérieures.</p></li>
<li><p>Compatible avec PowerShell 7.</p></li>
</ul>
</section>
<section id="limitations-connues">
<h2>Limitations connues<a class="headerlink" href="#limitations-connues" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>La segmentation d’objets JSON complexes peut ne pas préserver toutes les relations entre les objets.</p></li>
<li><p>Les fichiers très volumineux (&gt; 1 GB) peuvent entraîner des problèmes de mémoire.</p></li>
</ul>
</section>
<section id="exemples-avances">
<h2>Exemples avancés<a class="headerlink" href="#exemples-avances" title="Link to this heading"></a></h2>
<section id="traitement-parallele-des-segments">
<h3>Traitement parallèle des segments<a class="headerlink" href="#traitement-parallele-des-segments" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$input</span> <span class="p">=</span> <span class="nb">Get-Content</span> <span class="n">-Path</span> <span class="s2">&quot;.\data\large_file.txt&quot;</span> <span class="n">-Raw</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-Input</span> <span class="n">-Input</span> <span class="nv">$input</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>

<span class="c"># Créer un runspace pool</span>
<span class="nv">$sessionState</span> <span class="p">=</span> <span class="no">[System.Management.Automation.Runspaces.InitialSessionState]</span><span class="p">::</span><span class="n">CreateDefault</span><span class="p">()</span>
<span class="nv">$runspacePool</span> <span class="p">=</span> <span class="no">[runspacefactory]</span><span class="p">::</span><span class="n">CreateRunspacePool</span><span class="p">(</span><span class="n">1</span><span class="p">,</span> <span class="n">4</span><span class="p">,</span> <span class="nv">$sessionState</span><span class="p">,</span> <span class="nv">$Host</span><span class="p">)</span>
<span class="nv">$runspacePool</span><span class="p">.</span><span class="n">Open</span><span class="p">()</span>

<span class="c"># Créer les runspaces</span>
<span class="nv">$runspaces</span> <span class="p">=</span> <span class="p">@()</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$segment</span> <span class="k">in</span> <span class="nv">$segments</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$powershell</span> <span class="p">=</span> <span class="no">[powershell]</span><span class="p">::</span><span class="n">Create</span><span class="p">().</span><span class="n">AddScript</span><span class="p">({</span>
        <span class="k">param</span><span class="p">(</span><span class="nv">$segment</span><span class="p">)</span>
        <span class="c"># Traiter le segment</span>
        <span class="k">return</span> <span class="s2">&quot;Processed: </span><span class="p">$(</span><span class="nv">$segment</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span><span class="s2"> bytes&quot;</span>
    <span class="p">}).</span><span class="n">AddArgument</span><span class="p">(</span><span class="nv">$segment</span><span class="p">)</span>
    
    <span class="nv">$powershell</span><span class="p">.</span><span class="n">RunspacePool</span> <span class="p">=</span> <span class="nv">$runspacePool</span>
    
    <span class="nv">$runspaces</span> <span class="p">+=</span> <span class="no">[PSCustomObject]</span><span class="p">@{</span>
        <span class="n">PowerShell</span> <span class="p">=</span> <span class="nv">$powershell</span>
        <span class="n">Handle</span> <span class="p">=</span> <span class="nv">$powershell</span><span class="p">.</span><span class="n">BeginInvoke</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c"># Récupérer les résultats</span>
<span class="nv">$results</span> <span class="p">=</span> <span class="p">@()</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$runspace</span> <span class="k">in</span> <span class="nv">$runspaces</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$results</span> <span class="p">+=</span> <span class="nv">$runspace</span><span class="p">.</span><span class="n">PowerShell</span><span class="p">.</span><span class="n">EndInvoke</span><span class="p">(</span><span class="nv">$runspace</span><span class="p">.</span><span class="n">Handle</span><span class="p">)</span>
    <span class="nv">$runspace</span><span class="p">.</span><span class="n">PowerShell</span><span class="p">.</span><span class="n">Dispose</span><span class="p">()</span>
<span class="p">}</span>

<span class="c"># Fermer le runspace pool</span>
<span class="nv">$runspacePool</span><span class="p">.</span><span class="n">Close</span><span class="p">()</span>
<span class="nv">$runspacePool</span><span class="p">.</span><span class="n">Dispose</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="segmentation-avec-preservation-du-contexte">
<h3>Segmentation avec préservation du contexte<a class="headerlink" href="#segmentation-avec-preservation-du-contexte" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$json</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="n">metadata</span> <span class="p">=</span> <span class="p">@{</span>
        <span class="n">title</span> <span class="p">=</span> <span class="s2">&quot;Test&quot;</span>
        <span class="n">description</span> <span class="p">=</span> <span class="s2">&quot;Description de test&quot;</span>
    <span class="p">}</span>
    <span class="n">items</span> <span class="p">=</span> <span class="p">@()</span>
<span class="p">}</span>

<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="p">=</span> <span class="n">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">-lt</span> <span class="n">500</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++)</span> <span class="p">{</span>
    <span class="nv">$json</span><span class="p">.</span><span class="n">items</span> <span class="p">+=</span> <span class="p">@{</span>
        <span class="n">id</span> <span class="p">=</span> <span class="nv">$i</span>
        <span class="n">name</span> <span class="p">=</span> <span class="s2">&quot;Item $i&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c"># Segmenter l&#39;objet JSON en préservant les métadonnées</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-JsonInput</span> <span class="n">-JsonObject</span> <span class="nv">$json</span> <span class="n">-ChunkSizeKB</span> <span class="n">5</span>

<span class="c"># Vérifier que chaque segment contient les métadonnées</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$segment</span> <span class="k">in</span> <span class="nv">$segments</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$segment</span><span class="p">.</span><span class="n">metadata</span><span class="p">.</span><span class="n">title</span> <span class="o">-ne</span> <span class="s2">&quot;Test&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Error</span> <span class="s2">&quot;Les métadonnées n&#39;ont pas été préservées correctement.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, EMAIL_SENDER_1 Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>