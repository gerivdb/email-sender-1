

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Support des formats CSV et YAML dans UnifiedSegmenter &mdash; EMAIL_SENDER_1 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8d563738"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            EMAIL_SENDER_1
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contenu:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">Documentation des API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EMAIL_SENDER_1</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Support des formats CSV et YAML dans UnifiedSegmenter</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/CSV_YAML_Support.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="support-des-formats-csv-et-yaml-dans-unifiedsegmenter">
<h1>Support des formats CSV et YAML dans UnifiedSegmenter<a class="headerlink" href="#support-des-formats-csv-et-yaml-dans-unifiedsegmenter" title="Link to this heading"></a></h1>
<p>Ce document décrit les fonctionnalités de support des formats CSV et YAML ajoutées au module UnifiedSegmenter.</p>
<section id="table-des-matieres">
<h2>Table des matières<a class="headerlink" href="#table-des-matieres" title="Link to this heading"></a></h2>
<ol class="simple">
<li><p><a class="reference external" href="#introduction">Introduction</a></p></li>
<li><p><a class="reference external" href="#d%C3%A9tection-de-format">Détection de format</a></p></li>
<li><p><a class="reference external" href="#validation-de-fichier">Validation de fichier</a></p></li>
<li><p><a class="reference external" href="#conversion-entre-formats">Conversion entre formats</a></p></li>
<li><p><a class="reference external" href="#analyse-de-fichier">Analyse de fichier</a></p></li>
<li><p><a class="reference external" href="#segmentation-de-fichier">Segmentation de fichier</a></p></li>
<li><p><a class="reference external" href="#d%C3%A9tection-dencodage">Détection d’encodage</a></p></li>
<li><p><a class="reference external" href="#exemples-dutilisation">Exemples d’utilisation</a></p></li>
</ol>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>Le module UnifiedSegmenter a été étendu pour prendre en charge les formats CSV et YAML, en plus des formats JSON, XML et TEXT déjà supportés. Cette extension permet de :</p>
<ul class="simple">
<li><p>Détecter automatiquement les formats CSV et YAML</p></li>
<li><p>Valider les fichiers CSV et YAML</p></li>
<li><p>Convertir entre tous les formats (JSON, XML, TEXT, CSV, YAML)</p></li>
<li><p>Analyser les fichiers CSV et YAML pour obtenir des informations détaillées</p></li>
<li><p>Segmenter les fichiers CSV et YAML en morceaux plus petits</p></li>
<li><p>Détecter l’encodage des fichiers</p></li>
</ul>
</section>
<section id="detection-de-format">
<h2>Détection de format<a class="headerlink" href="#detection-de-format" title="Link to this heading"></a></h2>
<p>La fonction <code class="docutils literal notranslate"><span class="pre">Get-FileFormat</span></code> a été mise à jour pour détecter les formats CSV et YAML :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Détecter le format d&#39;un fichier</span>
<span class="nv">$format</span> <span class="p">=</span> <span class="nb">Get-FileFormat</span> <span class="n">-FilePath</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Format détecté: $format&quot;</span>  <span class="c"># Affiche &quot;Format détecté: CSV&quot;</span>

<span class="c"># Détecter le format avec détection d&#39;encodage</span>
<span class="nv">$format</span> <span class="p">=</span> <span class="nb">Get-FileFormat</span> <span class="n">-FilePath</span> <span class="s2">&quot;C:\temp\data.yaml&quot;</span> <span class="n">-UseEncodingDetector</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Format détecté: $format&quot;</span>  <span class="c"># Affiche &quot;Format détecté: YAML&quot;</span>
</pre></div>
</div>
</section>
<section id="validation-de-fichier">
<h2>Validation de fichier<a class="headerlink" href="#validation-de-fichier" title="Link to this heading"></a></h2>
<p>La fonction <code class="docutils literal notranslate"><span class="pre">Test-FileValidity</span></code> a été mise à jour pour valider les fichiers CSV et YAML :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Valider un fichier CSV</span>
<span class="nv">$isValid</span> <span class="p">=</span> <span class="nb">Test-FileValidity</span> <span class="n">-FilePath</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;CSV&quot;</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$isValid</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Le fichier CSV est valide&quot;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Le fichier CSV n&#39;est pas valide&quot;</span>
<span class="p">}</span>

<span class="c"># Valider un fichier YAML</span>
<span class="nv">$isValid</span> <span class="p">=</span> <span class="nb">Test-FileValidity</span> <span class="n">-FilePath</span> <span class="s2">&quot;C:\temp\data.yaml&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;YAML&quot;</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$isValid</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Le fichier YAML est valide&quot;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Le fichier YAML n&#39;est pas valide&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="conversion-entre-formats">
<h2>Conversion entre formats<a class="headerlink" href="#conversion-entre-formats" title="Link to this heading"></a></h2>
<p>La fonction <code class="docutils literal notranslate"><span class="pre">Convert-FileFormat</span></code> a été mise à jour pour prendre en charge les conversions entre tous les formats (JSON, XML, TEXT, CSV, YAML) :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Convertir JSON en CSV</span>
<span class="nb">Convert-FileFormat</span> <span class="n">-InputFile</span> <span class="s2">&quot;C:\temp\data.json&quot;</span> <span class="n">-OutputFile</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span> <span class="n">-InputFormat</span> <span class="s2">&quot;JSON&quot;</span> <span class="n">-OutputFormat</span> <span class="s2">&quot;CSV&quot;</span>

<span class="c"># Convertir CSV en JSON</span>
<span class="nb">Convert-FileFormat</span> <span class="n">-InputFile</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span> <span class="n">-OutputFile</span> <span class="s2">&quot;C:\temp\data.json&quot;</span> <span class="n">-InputFormat</span> <span class="s2">&quot;CSV&quot;</span> <span class="n">-OutputFormat</span> <span class="s2">&quot;JSON&quot;</span>

<span class="c"># Convertir YAML en JSON</span>
<span class="nb">Convert-FileFormat</span> <span class="n">-InputFile</span> <span class="s2">&quot;C:\temp\data.yaml&quot;</span> <span class="n">-OutputFile</span> <span class="s2">&quot;C:\temp\data.json&quot;</span> <span class="n">-InputFormat</span> <span class="s2">&quot;YAML&quot;</span> <span class="n">-OutputFormat</span> <span class="s2">&quot;JSON&quot;</span>

<span class="c"># Convertir JSON en YAML</span>
<span class="nb">Convert-FileFormat</span> <span class="n">-InputFile</span> <span class="s2">&quot;C:\temp\data.json&quot;</span> <span class="n">-OutputFile</span> <span class="s2">&quot;C:\temp\data.yaml&quot;</span> <span class="n">-InputFormat</span> <span class="s2">&quot;JSON&quot;</span> <span class="n">-OutputFormat</span> <span class="s2">&quot;YAML&quot;</span>

<span class="c"># Convertir CSV en YAML</span>
<span class="nb">Convert-FileFormat</span> <span class="n">-InputFile</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span> <span class="n">-OutputFile</span> <span class="s2">&quot;C:\temp\data.yaml&quot;</span> <span class="n">-InputFormat</span> <span class="s2">&quot;CSV&quot;</span> <span class="n">-OutputFormat</span> <span class="s2">&quot;YAML&quot;</span>

<span class="c"># Convertir YAML en CSV</span>
<span class="nb">Convert-FileFormat</span> <span class="n">-InputFile</span> <span class="s2">&quot;C:\temp\data.yaml&quot;</span> <span class="n">-OutputFile</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span> <span class="n">-InputFormat</span> <span class="s2">&quot;YAML&quot;</span> <span class="n">-OutputFormat</span> <span class="s2">&quot;CSV&quot;</span>
</pre></div>
</div>
<section id="traitement-des-objets-imbriques">
<h3>Traitement des objets imbriqués<a class="headerlink" href="#traitement-des-objets-imbriques" title="Link to this heading"></a></h3>
<p>La fonction <code class="docutils literal notranslate"><span class="pre">Convert-FileFormat</span></code> a été améliorée pour prendre en charge le traitement des objets imbriqués lors de la conversion vers CSV :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Convertir JSON en CSV avec aplatissement des objets imbriqués</span>
<span class="nb">Convert-FileFormat</span> <span class="n">-InputFile</span> <span class="s2">&quot;C:\temp\data.json&quot;</span> <span class="n">-OutputFile</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span> <span class="n">-InputFormat</span> <span class="s2">&quot;JSON&quot;</span> <span class="n">-OutputFormat</span> <span class="s2">&quot;CSV&quot;</span> <span class="n">-FlattenNestedObjects</span> <span class="nv">$true</span> <span class="n">-NestedSeparator</span> <span class="s2">&quot;.&quot;</span>

<span class="c"># Convertir JSON en CSV sans aplatissement des objets imbriqués</span>
<span class="nb">Convert-FileFormat</span> <span class="n">-InputFile</span> <span class="s2">&quot;C:\temp\data.json&quot;</span> <span class="n">-OutputFile</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span> <span class="n">-InputFormat</span> <span class="s2">&quot;JSON&quot;</span> <span class="n">-OutputFormat</span> <span class="s2">&quot;CSV&quot;</span> <span class="n">-FlattenNestedObjects</span> <span class="nv">$false</span>
</pre></div>
</div>
<section id="exemple-d-aplatissement-d-objets-imbriques">
<h4>Exemple d’aplatissement d’objets imbriqués<a class="headerlink" href="#exemple-d-aplatissement-d-objets-imbriques" title="Link to this heading"></a></h4>
<p>Avec un fichier JSON comme celui-ci :</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;street&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123 Main St&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;city&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;New York&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;country&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;USA&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;phones&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;123-456-7890&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;098-765-4321&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Avec <code class="docutils literal notranslate"><span class="pre">FlattenNestedObjects</span> <span class="pre">=</span> <span class="pre">$true</span></code> et <code class="docutils literal notranslate"><span class="pre">NestedSeparator</span> <span class="pre">=</span> <span class="pre">&quot;.&quot;</span></code>, le CSV résultant sera :</p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>name,age,address.street,address.city,address.country,phones
&quot;John Doe&quot;,30,&quot;123 Main St&quot;,&quot;New York&quot;,&quot;USA&quot;,&quot;123-456-7890, 098-765-4321&quot;
</pre></div>
</div>
<p>Avec <code class="docutils literal notranslate"><span class="pre">FlattenNestedObjects</span> <span class="pre">=</span> <span class="pre">$false</span></code>, le CSV résultant sera :</p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>name,age,address,phones
&quot;John Doe&quot;,30,&quot;{&quot;&quot;street&quot;&quot;: &quot;&quot;123 Main St&quot;&quot;, &quot;&quot;city&quot;&quot;: &quot;&quot;New York&quot;&quot;, &quot;&quot;country&quot;&quot;: &quot;&quot;USA&quot;&quot;}&quot;,&quot;[&quot;&quot;123-456-7890&quot;&quot;, &quot;&quot;098-765-4321&quot;&quot;]&quot;
</pre></div>
</div>
</section>
</section>
</section>
<section id="analyse-de-fichier">
<h2>Analyse de fichier<a class="headerlink" href="#analyse-de-fichier" title="Link to this heading"></a></h2>
<p>La fonction <code class="docutils literal notranslate"><span class="pre">Get-FileAnalysis</span></code> a été mise à jour pour analyser les fichiers CSV et YAML :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Analyser un fichier CSV</span>
<span class="nv">$analysis</span> <span class="p">=</span> <span class="nb">Get-FileAnalysis</span> <span class="n">-FilePath</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;CSV&quot;</span>
<span class="nv">$analysis</span><span class="p">.</span><span class="n">structure</span><span class="p">.</span><span class="n">total_rows</span>  <span class="c"># Nombre total de lignes</span>
<span class="nv">$analysis</span><span class="p">.</span><span class="n">structure</span><span class="p">.</span><span class="n">total_columns</span>  <span class="c"># Nombre total de colonnes</span>
<span class="nv">$analysis</span><span class="p">.</span><span class="n">structure</span><span class="p">.</span><span class="n">header</span>  <span class="c"># En-tête du CSV</span>
<span class="nv">$analysis</span><span class="p">.</span><span class="n">statistics</span><span class="p">.</span><span class="n">fill_rate</span>  <span class="c"># Taux de remplissage</span>

<span class="c"># Analyser un fichier YAML</span>
<span class="nv">$analysis</span> <span class="p">=</span> <span class="nb">Get-FileAnalysis</span> <span class="n">-FilePath</span> <span class="s2">&quot;C:\temp\data.yaml&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;YAML&quot;</span>
<span class="nv">$analysis</span><span class="p">.</span><span class="n">structure</span><span class="p">.</span><span class="nb">type </span> <span class="c"># Type de la structure (dict, list, etc.)</span>
<span class="nv">$analysis</span><span class="p">.</span><span class="n">structure</span><span class="p">.</span><span class="n">keys</span>  <span class="c"># Clés de la structure (si c&#39;est un dictionnaire)</span>
</pre></div>
</div>
<section id="informations-d-analyse-csv">
<h3>Informations d’analyse CSV<a class="headerlink" href="#informations-d-analyse-csv" title="Link to this heading"></a></h3>
<p>L’analyse CSV fournit les informations suivantes :</p>
<ul class="simple">
<li><p><strong>file_info</strong> : Informations sur le fichier (chemin, taille, encodage)</p></li>
<li><p><strong>structure</strong> : Informations sur la structure du CSV (nombre de lignes, nombre de colonnes, en-tête)</p></li>
<li><p><strong>statistics</strong> : Statistiques générales (nombre total de cellules, nombre de cellules vides, taux de remplissage)</p></li>
<li><p><strong>columns</strong> : Informations détaillées sur chaque colonne (type détecté, nombre de valeurs vides, valeurs uniques, statistiques)</p></li>
</ul>
</section>
<section id="informations-d-analyse-yaml">
<h3>Informations d’analyse YAML<a class="headerlink" href="#informations-d-analyse-yaml" title="Link to this heading"></a></h3>
<p>L’analyse YAML fournit les informations suivantes :</p>
<ul class="simple">
<li><p><strong>file_info</strong> : Informations sur le fichier (chemin, taille, encodage)</p></li>
<li><p><strong>structure</strong> : Informations sur la structure du YAML (type, chemin, clés, éléments imbriqués)</p></li>
</ul>
</section>
</section>
<section id="segmentation-de-fichier">
<h2>Segmentation de fichier<a class="headerlink" href="#segmentation-de-fichier" title="Link to this heading"></a></h2>
<p>La fonction <code class="docutils literal notranslate"><span class="pre">Split-File</span></code> a été mise à jour pour segmenter les fichiers CSV et YAML :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Segmenter un fichier CSV</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-File</span> <span class="n">-FilePath</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;CSV&quot;</span> <span class="n">-OutputDir</span> <span class="s2">&quot;C:\temp\segments&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="n">10</span>

<span class="c"># Segmenter un fichier YAML</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-File</span> <span class="n">-FilePath</span> <span class="s2">&quot;C:\temp\data.yaml&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;YAML&quot;</span> <span class="n">-OutputDir</span> <span class="s2">&quot;C:\temp\segments&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="n">10</span>
</pre></div>
</div>
</section>
<section id="detection-d-encodage">
<h2>Détection d’encodage<a class="headerlink" href="#detection-d-encodage" title="Link to this heading"></a></h2>
<p>Une nouvelle fonction <code class="docutils literal notranslate"><span class="pre">Get-FileEncoding</span></code> a été ajoutée pour détecter l’encodage des fichiers :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Détecter l&#39;encodage d&#39;un fichier</span>
<span class="nv">$encodingInfo</span> <span class="p">=</span> <span class="nb">Get-FileEncoding</span> <span class="n">-FilePath</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span>
<span class="nv">$encodingInfo</span><span class="p">.</span><span class="n">encoding</span>  <span class="c"># Encodage détecté</span>
<span class="nv">$encodingInfo</span><span class="p">.</span><span class="n">has_bom</span>  <span class="c"># Indique si le fichier a un BOM</span>
<span class="nv">$encodingInfo</span><span class="p">.</span><span class="n">file_type</span>  <span class="c"># Type de fichier détecté (JSON, XML, TEXT, BINARY)</span>
</pre></div>
</div>
</section>
<section id="exemples-d-utilisation">
<h2>Exemples d’utilisation<a class="headerlink" href="#exemples-d-utilisation" title="Link to this heading"></a></h2>
<section id="exemple-1-conversion-d-un-fichier-csv-en-json">
<h3>Exemple 1 : Conversion d’un fichier CSV en JSON<a class="headerlink" href="#exemple-1-conversion-d-un-fichier-csv-en-json" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Détecter le format du fichier</span>
<span class="nv">$format</span> <span class="p">=</span> <span class="nb">Get-FileFormat</span> <span class="n">-FilePath</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Format détecté: $format&quot;</span>

<span class="c"># Valider le fichier CSV</span>
<span class="nv">$isValid</span> <span class="p">=</span> <span class="nb">Test-FileValidity</span> <span class="n">-FilePath</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;CSV&quot;</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="nv">$isValid</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Error</span> <span class="s2">&quot;Le fichier CSV n&#39;est pas valide&quot;</span>
    <span class="k">return</span>
<span class="p">}</span>

<span class="c"># Analyser le fichier CSV</span>
<span class="nv">$analysis</span> <span class="p">=</span> <span class="nb">Get-FileAnalysis</span> <span class="n">-FilePath</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;CSV&quot;</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de lignes: </span><span class="p">$(</span><span class="nv">$analysis</span><span class="p">.</span><span class="n">structure</span><span class="p">.</span><span class="n">total_rows</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de colonnes: </span><span class="p">$(</span><span class="nv">$analysis</span><span class="p">.</span><span class="n">structure</span><span class="p">.</span><span class="n">total_columns</span><span class="p">)</span><span class="s2">&quot;</span>

<span class="c"># Convertir le fichier CSV en JSON</span>
<span class="nb">Convert-FileFormat</span> <span class="n">-InputFile</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span> <span class="n">-OutputFile</span> <span class="s2">&quot;C:\temp\data.json&quot;</span> <span class="n">-InputFormat</span> <span class="s2">&quot;CSV&quot;</span> <span class="n">-OutputFormat</span> <span class="s2">&quot;JSON&quot;</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Conversion terminée&quot;</span>
</pre></div>
</div>
</section>
<section id="exemple-2-conversion-d-un-fichier-json-en-csv-avec-aplatissement-des-objets-imbriques">
<h3>Exemple 2 : Conversion d’un fichier JSON en CSV avec aplatissement des objets imbriqués<a class="headerlink" href="#exemple-2-conversion-d-un-fichier-json-en-csv-avec-aplatissement-des-objets-imbriques" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Convertir le fichier JSON en CSV avec aplatissement des objets imbriqués</span>
<span class="nb">Convert-FileFormat</span> <span class="n">-InputFile</span> <span class="s2">&quot;C:\temp\data.json&quot;</span> <span class="n">-OutputFile</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span> <span class="n">-InputFormat</span> <span class="s2">&quot;JSON&quot;</span> <span class="n">-OutputFormat</span> <span class="s2">&quot;CSV&quot;</span> <span class="n">-FlattenNestedObjects</span> <span class="nv">$true</span> <span class="n">-NestedSeparator</span> <span class="s2">&quot;_&quot;</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Conversion terminée&quot;</span>

<span class="c"># Valider le fichier CSV généré</span>
<span class="nv">$isValid</span> <span class="p">=</span> <span class="nb">Test-FileValidity</span> <span class="n">-FilePath</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;CSV&quot;</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$isValid</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Le fichier CSV généré est valide&quot;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Le fichier CSV généré n&#39;est pas valide&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="exemple-3-segmentation-d-un-fichier-csv-volumineux">
<h3>Exemple 3 : Segmentation d’un fichier CSV volumineux<a class="headerlink" href="#exemple-3-segmentation-d-un-fichier-csv-volumineux" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Segmenter un fichier CSV volumineux</span>
<span class="nv">$segments</span> <span class="p">=</span> <span class="nb">Split-File</span> <span class="n">-FilePath</span> <span class="s2">&quot;C:\temp\data.csv&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;CSV&quot;</span> <span class="n">-OutputDir</span> <span class="s2">&quot;C:\temp\segments&quot;</span> <span class="n">-ChunkSizeKB</span> <span class="n">100</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Nombre de segments créés: </span><span class="p">$(</span><span class="nv">$segments</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span><span class="s2">&quot;</span>

<span class="c"># Traiter chaque segment</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$segment</span> <span class="k">in</span> <span class="nv">$segments</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Traitement du segment: $segment&quot;</span>
    <span class="c"># Traitement du segment...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="exemple-4-analyse-d-un-fichier-yaml">
<h3>Exemple 4 : Analyse d’un fichier YAML<a class="headerlink" href="#exemple-4-analyse-d-un-fichier-yaml" title="Link to this heading"></a></h3>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Analyser un fichier YAML</span>
<span class="nv">$analysis</span> <span class="p">=</span> <span class="nb">Get-FileAnalysis</span> <span class="n">-FilePath</span> <span class="s2">&quot;C:\temp\data.yaml&quot;</span> <span class="n">-Format</span> <span class="s2">&quot;YAML&quot;</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;Type de structure: </span><span class="p">$(</span><span class="nv">$analysis</span><span class="p">.</span><span class="n">structure</span><span class="p">.</span><span class="n">type</span><span class="p">)</span><span class="s2">&quot;</span>

<span class="c"># Si c&#39;est un dictionnaire, afficher les clés</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$analysis</span><span class="p">.</span><span class="n">structure</span><span class="p">.</span><span class="nb">type </span><span class="o">-eq</span> <span class="s2">&quot;dict&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Clés: </span><span class="p">$(</span><span class="nv">$analysis</span><span class="p">.</span><span class="n">structure</span><span class="p">.</span><span class="n">keys</span> <span class="n">-join</span> <span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="p">}</span>

<span class="c"># Si c&#39;est une liste, afficher le nombre d&#39;éléments</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$analysis</span><span class="p">.</span><span class="n">structure</span><span class="p">.</span><span class="nb">type </span><span class="o">-eq</span> <span class="s2">&quot;list&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Nombre d&#39;éléments: </span><span class="p">$(</span><span class="nv">$analysis</span><span class="p">.</span><span class="n">structure</span><span class="p">.</span><span class="n">item_count</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, EMAIL_SENDER_1 Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>